{
  "$schema": "https://schema.management.azure.com/schemas/2018-05-01/subscriptionDeploymentTemplate.json#",
  "contentVersion": "1.0.0.0",
  "parameters": {},
  "resources": [
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "apiVersion": "2019-09-01",
      "name": "82B283F1C22CE03E0ED3BF024A2CE947",
      "properties": {
        "displayName": "Apply Diagnostic Settings for Microsoft.Network/networkInterfaces to a Regional Event Hub",
        "mode": "Indexed",
        "description": "This policy automatically deploys diagnostic settings to Apply Diagnostic Settings for Microsoft.Network/networkInterfaces to a Regional Event Hub.",
        "metadata": {
          "category": "Monitoring"
        },
        "parameters": {
          "profileName": {
            "type": "String",
            "metadata": {
              "displayName": "Profile Name for Config",
              "description": "The profile name Azure Diagnostics"
            }
          },
          "eventHubName": {
            "type": "String",
            "metadata": {
              "displayName": "EventHub Name",
              "description": "The event hub for Azure Diagnostics",
              "strongType": "Microsoft.EventHub/Namespaces/EventHubs",
              "assignPermissions": true
            }
          },
          "eventHubRuleId": {
            "type": "String",
            "metadata": {
              "displayName": "EventHubRuleID",
              "description": "The event hub RuleID for Azure Diagnostics",
              "strongType": "Microsoft.EventHub/Namespaces/AuthorizationRules",
              "assignPermissions": true
            }
          },
          "azureRegions": {
            "type": "Array",
            "metadata": {
              "displayName": "Allowed Locations",
              "description": "The list of locations that can be specified when deploying resources",
              "strongType": "location"
            }
          },
          "metricsEnabled": {
            "type": "String",
            "metadata": {
              "displayName": "Enable Metrics",
              "description": "Enable Metrics - True or False"
            },
            "allowedValues": [
              "True",
              "False"
            ],
            "defaultValue": "True"
          },
          "logsEnabled": {
            "type": "String",
            "metadata": {
              "displayName": "Enable Logs",
              "description": "Enable Logs - True or False"
            },
            "allowedValues": [
              "True",
              "False"
            ],
            "defaultValue": "True"
          }
        },
        "policyRule": {
          "if": {
            "allOf": [
              {
                "field": "type",
                "equals": "Microsoft.Network/networkInterfaces"
              },
              {
                "field": "location",
                "in": "[[parameters('azureRegions')]"
              }
            ]
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "existenceCondition": {
                "allOf": [
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/logs.enabled",
                    "equals": "[[parameters('logsEnabled')]"
                  },
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/metrics.enabled",
                    "equals": "[[parameters('metricsEnabled')]"
                  },
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/eventHubName",
                    "equals": "[[last(split(parameters('eventHubName'), '/'))]"
                  }
                ]
              },
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "name": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      },
                      "eventHubName": {
                        "type": "string"
                      },
                      "eventHubRuleId": {
                        "type": "string"
                      },
                      "metricsEnabled": {
                        "type": "string"
                      },
                      "logsEnabled": {
                        "type": "string"
                      },
                      "profileName": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.Network/networkInterfaces/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[[concat(parameters('name'), '/', 'Microsoft.Insights/', parameters('profileName'))]",
                        "location": "[[parameters('location')]",
                        "dependsOn": [],
                        "properties": {
                          "eventHubName": "[[last(split(parameters('eventHubName'), '/'))]",
                          "eventHubAuthorizationRuleId": "[[parameters('eventHubRuleId')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": "[[parameters('metricsEnabled')]",
                              "retentionPolicy": {
                                "enabled": false,
                                "days": 0
                              }
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {
                      "policy": {
                        "type": "string",
                        "value": "[[concat(parameters('eventHubName'), 'configured for diagnostic logs for ', ': ', parameters('name'))]"
                      }
                    }
                  },
                  "parameters": {
                    "eventHubName": {
                      "value": "[[parameters('eventHubName')]"
                    },
                    "location": {
                      "value": "[[field('location')]"
                    },
                    "name": {
                      "value": "[[field('name')]"
                    },
                    "eventHubRuleId": {
                      "value": "[[parameters('eventHubRuleId')]"
                    },
                    "metricsEnabled": {
                      "value": "[[parameters('metricsEnabled')]"
                    },
                    "logsEnabled": {
                      "value": "[[parameters('logsEnabled')]"
                    },
                    "profileName": {
                      "value": "[[parameters('profileName')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "apiVersion": "2019-09-01",
      "name": "A08C4E65AC3520BF59E8CEC50B5021ED",
      "properties": {
        "displayName": "Apply Diagnostic Settings for Microsoft.Network/networkSecurityGroups to a Regional Event Hub",
        "mode": "Indexed",
        "description": "This policy automatically deploys diagnostic settings to Apply Diagnostic Settings for Microsoft.Network/networkSecurityGroups to a Regional Event Hub.",
        "metadata": {
          "category": "Monitoring"
        },
        "parameters": {
          "profileName": {
            "type": "String",
            "metadata": {
              "displayName": "Profile Name for Config",
              "description": "The profile name Azure Diagnostics"
            }
          },
          "eventHubName": {
            "type": "String",
            "metadata": {
              "displayName": "EventHub Name",
              "description": "The event hub for Azure Diagnostics",
              "strongType": "Microsoft.EventHub/Namespaces/EventHubs",
              "assignPermissions": true
            }
          },
          "eventHubRuleId": {
            "type": "String",
            "metadata": {
              "displayName": "EventHubRuleID",
              "description": "The event hub RuleID for Azure Diagnostics",
              "strongType": "Microsoft.EventHub/Namespaces/AuthorizationRules",
              "assignPermissions": true
            }
          },
          "azureRegions": {
            "type": "Array",
            "metadata": {
              "displayName": "Allowed Locations",
              "description": "The list of locations that can be specified when deploying resources",
              "strongType": "location"
            }
          },
          "metricsEnabled": {
            "type": "String",
            "metadata": {
              "displayName": "Enable Metrics",
              "description": "Enable Metrics - True or False"
            },
            "allowedValues": [
              "True",
              "False"
            ],
            "defaultValue": "False"
          },
          "logsEnabled": {
            "type": "String",
            "metadata": {
              "displayName": "Enable Logs",
              "description": "Enable Logs - True or False"
            },
            "allowedValues": [
              "True",
              "False"
            ],
            "defaultValue": "True"
          }
        },
        "policyRule": {
          "if": {
            "allOf": [
              {
                "field": "type",
                "equals": "Microsoft.Network/networkSecurityGroups"
              },
              {
                "field": "location",
                "in": "[[parameters('azureRegions')]"
              }
            ]
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "existenceCondition": {
                "allOf": [
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/logs.enabled",
                    "equals": "[[parameters('logsEnabled')]"
                  },
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/metrics.enabled",
                    "equals": "[[parameters('metricsEnabled')]"
                  },
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/eventHubName",
                    "equals": "[[last(split(parameters('eventHubName'), '/'))]"
                  }
                ]
              },
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "name": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      },
                      "eventHubName": {
                        "type": "string"
                      },
                      "eventHubRuleId": {
                        "type": "string"
                      },
                      "metricsEnabled": {
                        "type": "string"
                      },
                      "logsEnabled": {
                        "type": "string"
                      },
                      "profileName": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.Network/networkSecurityGroups/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[[concat(parameters('name'), '/', 'Microsoft.Insights/', parameters('profileName'))]",
                        "location": "[[parameters('location')]",
                        "dependsOn": [],
                        "properties": {
                          "eventHubName": "[[last(split(parameters('eventHubName'), '/'))]",
                          "eventHubAuthorizationRuleId": "[[parameters('eventHubRuleId')]",
                          "logs": [
                            {
                              "category": "NetworkSecurityGroupEvent",
                              "enabled": "[[parameters('logsEnabled')]"
                            },
                            {
                              "category": "NetworkSecurityGroupRuleCounter",
                              "enabled": "[[parameters('logsEnabled')]"
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {
                      "policy": {
                        "type": "string",
                        "value": "[[concat(parameters('eventHubName'), 'configured for diagnostic logs for ', ': ', parameters('name'))]"
                      }
                    }
                  },
                  "parameters": {
                    "eventHubName": {
                      "value": "[[parameters('eventHubName')]"
                    },
                    "location": {
                      "value": "[[field('location')]"
                    },
                    "name": {
                      "value": "[[field('name')]"
                    },
                    "eventHubRuleId": {
                      "value": "[[parameters('eventHubRuleId')]"
                    },
                    "metricsEnabled": {
                      "value": "[[parameters('metricsEnabled')]"
                    },
                    "logsEnabled": {
                      "value": "[[parameters('logsEnabled')]"
                    },
                    "profileName": {
                      "value": "[[parameters('profileName')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "apiVersion": "2019-09-01",
      "name": "DD13AD31C7D6A8416312B40E06EBEA3B",
      "properties": {
        "displayName": "Apply Diagnostic Settings for Microsoft.Network/publicIPAddresses to a Regional Event Hub",
        "mode": "Indexed",
        "description": "This policy automatically deploys diagnostic settings to Apply Diagnostic Settings for Microsoft.Network/publicIPAddresses to a Regional Event Hub.",
        "metadata": {
          "category": "Monitoring"
        },
        "parameters": {
          "profileName": {
            "type": "String",
            "metadata": {
              "displayName": "Profile Name for Config",
              "description": "The profile name Azure Diagnostics"
            }
          },
          "eventHubName": {
            "type": "String",
            "metadata": {
              "displayName": "EventHub Name",
              "description": "The event hub for Azure Diagnostics",
              "strongType": "Microsoft.EventHub/Namespaces/EventHubs",
              "assignPermissions": true
            }
          },
          "eventHubRuleId": {
            "type": "String",
            "metadata": {
              "displayName": "EventHubRuleID",
              "description": "The event hub RuleID for Azure Diagnostics",
              "strongType": "Microsoft.EventHub/Namespaces/AuthorizationRules",
              "assignPermissions": true
            }
          },
          "azureRegions": {
            "type": "Array",
            "metadata": {
              "displayName": "Allowed Locations",
              "description": "The list of locations that can be specified when deploying resources",
              "strongType": "location"
            }
          },
          "metricsEnabled": {
            "type": "String",
            "metadata": {
              "displayName": "Enable Metrics",
              "description": "Enable Metrics - True or False"
            },
            "allowedValues": [
              "True",
              "False"
            ],
            "defaultValue": "True"
          },
          "logsEnabled": {
            "type": "String",
            "metadata": {
              "displayName": "Enable Logs",
              "description": "Enable Logs - True or False"
            },
            "allowedValues": [
              "True",
              "False"
            ],
            "defaultValue": "True"
          }
        },
        "policyRule": {
          "if": {
            "allOf": [
              {
                "field": "type",
                "equals": "Microsoft.Network/publicIPAddresses"
              },
              {
                "field": "location",
                "in": "[[parameters('azureRegions')]"
              }
            ]
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "existenceCondition": {
                "allOf": [
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/logs.enabled",
                    "equals": "[[parameters('logsEnabled')]"
                  },
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/metrics.enabled",
                    "equals": "[[parameters('metricsEnabled')]"
                  },
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/eventHubName",
                    "equals": "[[last(split(parameters('eventHubName'), '/'))]"
                  }
                ]
              },
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "name": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      },
                      "eventHubName": {
                        "type": "string"
                      },
                      "eventHubRuleId": {
                        "type": "string"
                      },
                      "metricsEnabled": {
                        "type": "string"
                      },
                      "logsEnabled": {
                        "type": "string"
                      },
                      "profileName": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.Network/publicIPAddresses/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[[concat(parameters('name'), '/', 'Microsoft.Insights/', parameters('profileName'))]",
                        "location": "[[parameters('location')]",
                        "dependsOn": [],
                        "properties": {
                          "eventHubName": "[[last(split(parameters('eventHubName'), '/'))]",
                          "eventHubAuthorizationRuleId": "[[parameters('eventHubRuleId')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": "[[parameters('metricsEnabled')]",
                              "retentionPolicy": {
                                "enabled": false,
                                "days": 0
                              }
                            }
                          ],
                          "logs": [
                            {
                              "category": "DDoSProtectionNotifications",
                              "enabled": "[[parameters('logsEnabled')]"
                            },
                            {
                              "category": "DDoSMitigationFlowLogs",
                              "enabled": "[[parameters('logsEnabled')]"
                            },
                            {
                              "category": "DDoSMitigationReports",
                              "enabled": "[[parameters('logsEnabled')]"
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {
                      "policy": {
                        "type": "string",
                        "value": "[[concat(parameters('eventHubName'), 'configured for diagnostic logs for ', ': ', parameters('name'))]"
                      }
                    }
                  },
                  "parameters": {
                    "eventHubName": {
                      "value": "[[parameters('eventHubName')]"
                    },
                    "location": {
                      "value": "[[field('location')]"
                    },
                    "name": {
                      "value": "[[field('name')]"
                    },
                    "eventHubRuleId": {
                      "value": "[[parameters('eventHubRuleId')]"
                    },
                    "metricsEnabled": {
                      "value": "[[parameters('metricsEnabled')]"
                    },
                    "logsEnabled": {
                      "value": "[[parameters('logsEnabled')]"
                    },
                    "profileName": {
                      "value": "[[parameters('profileName')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "apiVersion": "2019-09-01",
      "name": "9E299A3D6BE683D5871FCDAC9139A26B",
      "properties": {
        "displayName": "Apply Diagnostic Settings for Microsoft.Network/virtualNetworks to a Regional Event Hub",
        "mode": "Indexed",
        "description": "This policy automatically deploys diagnostic settings to Apply Diagnostic Settings for Microsoft.Network/virtualNetworks to a Regional Event Hub.",
        "metadata": {
          "category": "Monitoring"
        },
        "parameters": {
          "profileName": {
            "type": "String",
            "metadata": {
              "displayName": "Profile Name for Config",
              "description": "The profile name Azure Diagnostics"
            }
          },
          "eventHubName": {
            "type": "String",
            "metadata": {
              "displayName": "EventHub Name",
              "description": "The event hub for Azure Diagnostics",
              "strongType": "Microsoft.EventHub/Namespaces/EventHubs",
              "assignPermissions": true
            }
          },
          "eventHubRuleId": {
            "type": "String",
            "metadata": {
              "displayName": "EventHubRuleID",
              "description": "The event hub RuleID for Azure Diagnostics",
              "strongType": "Microsoft.EventHub/Namespaces/AuthorizationRules",
              "assignPermissions": true
            }
          },
          "azureRegions": {
            "type": "Array",
            "metadata": {
              "displayName": "Allowed Locations",
              "description": "The list of locations that can be specified when deploying resources",
              "strongType": "location"
            }
          },
          "metricsEnabled": {
            "type": "String",
            "metadata": {
              "displayName": "Enable Metrics",
              "description": "Enable Metrics - True or False"
            },
            "allowedValues": [
              "True",
              "False"
            ],
            "defaultValue": "False"
          },
          "logsEnabled": {
            "type": "String",
            "metadata": {
              "displayName": "Enable Logs",
              "description": "Enable Logs - True or False"
            },
            "allowedValues": [
              "True",
              "False"
            ],
            "defaultValue": "True"
          }
        },
        "policyRule": {
          "if": {
            "allOf": [
              {
                "field": "type",
                "equals": "Microsoft.Network/virtualNetworks"
              },
              {
                "field": "location",
                "in": "[[parameters('azureRegions')]"
              }
            ]
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "existenceCondition": {
                "allOf": [
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/logs.enabled",
                    "equals": "[[parameters('logsEnabled')]"
                  },
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/metrics.enabled",
                    "equals": "[[parameters('metricsEnabled')]"
                  },
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/eventHubName",
                    "equals": "[[last(split(parameters('eventHubName'), '/'))]"
                  }
                ]
              },
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "name": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      },
                      "eventHubName": {
                        "type": "string"
                      },
                      "eventHubRuleId": {
                        "type": "string"
                      },
                      "metricsEnabled": {
                        "type": "string"
                      },
                      "logsEnabled": {
                        "type": "string"
                      },
                      "profileName": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.Network/virtualNetworks/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[[concat(parameters('name'), '/', 'Microsoft.Insights/', parameters('profileName'))]",
                        "location": "[[parameters('location')]",
                        "dependsOn": [],
                        "properties": {
                          "eventHubName": "[[last(split(parameters('eventHubName'), '/'))]",
                          "eventHubAuthorizationRuleId": "[[parameters('eventHubRuleId')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": "[[parameters('metricsEnabled')]",
                              "retentionPolicy": {
                                "enabled": false,
                                "days": 0
                              }
                            }
                          ],
                          "logs": [
                            {
                              "category": "VMProtectionAlerts",
                              "enabled": "[[parameters('logsEnabled')]"
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {
                      "policy": {
                        "type": "string",
                        "value": "[[concat(parameters('eventHubName'), 'configured for diagnostic logs for ', ': ', parameters('name'))]"
                      }
                    }
                  },
                  "parameters": {
                    "eventHubName": {
                      "value": "[[parameters('eventHubName')]"
                    },
                    "location": {
                      "value": "[[field('location')]"
                    },
                    "name": {
                      "value": "[[field('name')]"
                    },
                    "eventHubRuleId": {
                      "value": "[[parameters('eventHubRuleId')]"
                    },
                    "metricsEnabled": {
                      "value": "[[parameters('metricsEnabled')]"
                    },
                    "logsEnabled": {
                      "value": "[[parameters('logsEnabled')]"
                    },
                    "profileName": {
                      "value": "[[parameters('profileName')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "apiVersion": "2019-09-01",
      "name": "99C792FE1BF4398643D4F8E0B05FB134",
      "properties": {
        "displayName": "Apply Diagnostic Settings for Microsoft.RecoveryServices/vaults to a Regional Event Hub",
        "mode": "Indexed",
        "description": "This policy automatically deploys diagnostic settings to Apply Diagnostic Settings for Microsoft.RecoveryServices/vaults to a Regional Event Hub.",
        "metadata": {
          "category": "Monitoring"
        },
        "parameters": {
          "profileName": {
            "type": "String",
            "metadata": {
              "displayName": "Profile Name for Config",
              "description": "The profile name Azure Diagnostics"
            }
          },
          "eventHubName": {
            "type": "String",
            "metadata": {
              "displayName": "EventHub Name",
              "description": "The event hub for Azure Diagnostics",
              "strongType": "Microsoft.EventHub/Namespaces/EventHubs",
              "assignPermissions": true
            }
          },
          "eventHubRuleId": {
            "type": "String",
            "metadata": {
              "displayName": "EventHubRuleID",
              "description": "The event hub RuleID for Azure Diagnostics",
              "strongType": "Microsoft.EventHub/Namespaces/AuthorizationRules",
              "assignPermissions": true
            }
          },
          "azureRegions": {
            "type": "Array",
            "metadata": {
              "displayName": "Allowed Locations",
              "description": "The list of locations that can be specified when deploying resources",
              "strongType": "location"
            }
          },
          "metricsEnabled": {
            "type": "String",
            "metadata": {
              "displayName": "Enable Metrics",
              "description": "Enable Metrics - True or False"
            },
            "allowedValues": [
              "True",
              "False"
            ],
            "defaultValue": "False"
          },
          "logsEnabled": {
            "type": "String",
            "metadata": {
              "displayName": "Enable Logs",
              "description": "Enable Logs - True or False"
            },
            "allowedValues": [
              "True",
              "False"
            ],
            "defaultValue": "True"
          }
        },
        "policyRule": {
          "if": {
            "allOf": [
              {
                "field": "type",
                "equals": "Microsoft.RecoveryServices/vaults"
              },
              {
                "field": "location",
                "in": "[[parameters('azureRegions')]"
              }
            ]
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "existenceCondition": {
                "allOf": [
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/logs.enabled",
                    "equals": "[[parameters('logsEnabled')]"
                  },
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/metrics.enabled",
                    "equals": "[[parameters('metricsEnabled')]"
                  },
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/eventHubName",
                    "equals": "[[last(split(parameters('eventHubName'), '/'))]"
                  }
                ]
              },
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "name": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      },
                      "eventHubName": {
                        "type": "string"
                      },
                      "eventHubRuleId": {
                        "type": "string"
                      },
                      "metricsEnabled": {
                        "type": "string"
                      },
                      "logsEnabled": {
                        "type": "string"
                      },
                      "profileName": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.RecoveryServices/vaults/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[[concat(parameters('name'), '/', 'Microsoft.Insights/', parameters('profileName'))]",
                        "location": "[[parameters('location')]",
                        "dependsOn": [],
                        "properties": {
                          "eventHubName": "[[last(split(parameters('eventHubName'), '/'))]",
                          "eventHubAuthorizationRuleId": "[[parameters('eventHubRuleId')]",
                          "logs": [
                            {
                              "category": "AzureBackupReport",
                              "enabled": "[[parameters('logsEnabled')]"
                            },
                            {
                              "category": "CoreAzureBackup",
                              "enabled": "[[parameters('logsEnabled')]"
                            },
                            {
                              "category": "AddonAzureBackupJobs",
                              "enabled": "[[parameters('logsEnabled')]"
                            },
                            {
                              "category": "AddonAzureBackupAlerts",
                              "enabled": "[[parameters('logsEnabled')]"
                            },
                            {
                              "category": "AddonAzureBackupPolicy",
                              "enabled": "[[parameters('logsEnabled')]"
                            },
                            {
                              "category": "AddonAzureBackupStorage",
                              "enabled": "[[parameters('logsEnabled')]"
                            },
                            {
                              "category": "AddonAzureBackupProtectedInstance",
                              "enabled": "[[parameters('logsEnabled')]"
                            },
                            {
                              "category": "AzureSiteRecoveryJobs",
                              "enabled": "[[parameters('logsEnabled')]"
                            },
                            {
                              "category": "AzureSiteRecoveryEvents",
                              "enabled": "[[parameters('logsEnabled')]"
                            },
                            {
                              "category": "AzureSiteRecoveryReplicatedItems",
                              "enabled": "[[parameters('logsEnabled')]"
                            },
                            {
                              "category": "AzureSiteRecoveryReplicationStats",
                              "enabled": "[[parameters('logsEnabled')]"
                            },
                            {
                              "category": "AzureSiteRecoveryRecoveryPoints",
                              "enabled": "[[parameters('logsEnabled')]"
                            },
                            {
                              "category": "AzureSiteRecoveryReplicationDataUploadRate",
                              "enabled": "[[parameters('logsEnabled')]"
                            },
                            {
                              "category": "AzureSiteRecoveryProtectedDiskDataChurn",
                              "enabled": "[[parameters('logsEnabled')]"
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {
                      "policy": {
                        "type": "string",
                        "value": "[[concat(parameters('eventHubName'), 'configured for diagnostic logs for ', ': ', parameters('name'))]"
                      }
                    }
                  },
                  "parameters": {
                    "eventHubName": {
                      "value": "[[parameters('eventHubName')]"
                    },
                    "location": {
                      "value": "[[field('location')]"
                    },
                    "name": {
                      "value": "[[field('name')]"
                    },
                    "eventHubRuleId": {
                      "value": "[[parameters('eventHubRuleId')]"
                    },
                    "metricsEnabled": {
                      "value": "[[parameters('metricsEnabled')]"
                    },
                    "logsEnabled": {
                      "value": "[[parameters('logsEnabled')]"
                    },
                    "profileName": {
                      "value": "[[parameters('profileName')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "apiVersion": "2019-09-01",
      "name": "59895B4EE7386CEF5C3CD1CBF94C03BC",
      "properties": {
        "displayName": "Apply Diagnostic Settings for Microsoft.Compute/virtualMachines to a Regional Event Hub",
        "mode": "Indexed",
        "description": "This policy automatically deploys diagnostic settings to Apply Diagnostic Settings for Microsoft.Compute/virtualMachines to a Regional Event Hub.",
        "metadata": {
          "category": "Monitoring"
        },
        "parameters": {
          "profileName": {
            "type": "String",
            "metadata": {
              "displayName": "Profile Name for Config",
              "description": "The profile name Azure Diagnostics"
            }
          },
          "eventHubName": {
            "type": "String",
            "metadata": {
              "displayName": "EventHub Name",
              "description": "The event hub for Azure Diagnostics",
              "strongType": "Microsoft.EventHub/Namespaces/EventHubs",
              "assignPermissions": true
            }
          },
          "eventHubRuleId": {
            "type": "String",
            "metadata": {
              "displayName": "EventHubRuleID",
              "description": "The event hub RuleID for Azure Diagnostics",
              "strongType": "Microsoft.EventHub/Namespaces/AuthorizationRules",
              "assignPermissions": true
            }
          },
          "azureRegions": {
            "type": "Array",
            "metadata": {
              "displayName": "Allowed Locations",
              "description": "The list of locations that can be specified when deploying resources",
              "strongType": "location"
            }
          },
          "metricsEnabled": {
            "type": "String",
            "metadata": {
              "displayName": "Enable Metrics",
              "description": "Enable Metrics - True or False"
            },
            "allowedValues": [
              "True",
              "False"
            ],
            "defaultValue": "False"
          },
          "logsEnabled": {
            "type": "String",
            "metadata": {
              "displayName": "Enable Logs",
              "description": "Enable Logs - True or False"
            },
            "allowedValues": [
              "True",
              "False"
            ],
            "defaultValue": "True"
          }
        },
        "policyRule": {
          "if": {
            "allOf": [
              {
                "field": "type",
                "equals": "Microsoft.Compute/virtualMachines"
              },
              {
                "field": "location",
                "in": "[[parameters('azureRegions')]"
              }
            ]
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "existenceCondition": {
                "allOf": [
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/logs.enabled",
                    "equals": "[[parameters('logsEnabled')]"
                  },
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/metrics.enabled",
                    "equals": "[[parameters('metricsEnabled')]"
                  },
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/eventHubName",
                    "equals": "[[last(split(parameters('eventHubName'), '/'))]"
                  }
                ]
              },
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "name": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      },
                      "eventHubName": {
                        "type": "string"
                      },
                      "eventHubRuleId": {
                        "type": "string"
                      },
                      "metricsEnabled": {
                        "type": "string"
                      },
                      "logsEnabled": {
                        "type": "string"
                      },
                      "profileName": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.Compute/virtualMachines/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[[concat(parameters('name'), '/', 'Microsoft.Insights/', parameters('profileName'))]",
                        "location": "[[parameters('location')]",
                        "dependsOn": [],
                        "properties": {
                          "eventHubName": "[[last(split(parameters('eventHubName'), '/'))]",
                          "eventHubAuthorizationRuleId": "[[parameters('eventHubRuleId')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": "[[parameters('metricsEnabled')]",
                              "retentionPolicy": {
                                "enabled": false,
                                "days": 0
                              }
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {
                      "policy": {
                        "type": "string",
                        "value": "[[concat(parameters('eventHubName'), 'configured for diagnostic logs for ', ': ', parameters('name'))]"
                      }
                    }
                  },
                  "parameters": {
                    "eventHubName": {
                      "value": "[[parameters('eventHubName')]"
                    },
                    "location": {
                      "value": "[[field('location')]"
                    },
                    "name": {
                      "value": "[[field('name')]"
                    },
                    "eventHubRuleId": {
                      "value": "[[parameters('eventHubRuleId')]"
                    },
                    "metricsEnabled": {
                      "value": "[[parameters('metricsEnabled')]"
                    },
                    "logsEnabled": {
                      "value": "[[parameters('logsEnabled')]"
                    },
                    "profileName": {
                      "value": "[[parameters('profileName')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "apiVersion": "2019-09-01",
      "name": "33357A14C3F088DF4D70155B6ABC27F3",
      "properties": {
        "displayName": "Apply Diagnostic Settings for Microsoft.Storage/storageAccounts (Storage) to a Regional Event Hub",
        "mode": "Indexed",
        "description": "This policy automatically deploys diagnostic settings to Apply Diagnostic Settings for Microsoft.Storage/storageAccounts (Storage) to a Regional Event Hub.",
        "metadata": {
          "category": "Monitoring"
        },
        "parameters": {
          "profileName": {
            "type": "String",
            "metadata": {
              "displayName": "Profile Name for Config",
              "description": "The profile name Azure Diagnostics"
            }
          },
          "eventHubName": {
            "type": "String",
            "metadata": {
              "displayName": "EventHub Name",
              "description": "The event hub for Azure Diagnostics",
              "strongType": "Microsoft.EventHub/Namespaces/EventHubs",
              "assignPermissions": true
            }
          },
          "eventHubRuleId": {
            "type": "String",
            "metadata": {
              "displayName": "EventHubRuleID",
              "description": "The event hub RuleID for Azure Diagnostics",
              "strongType": "Microsoft.EventHub/Namespaces/AuthorizationRules",
              "assignPermissions": true
            }
          },
          "azureRegions": {
            "type": "Array",
            "metadata": {
              "displayName": "Allowed Locations",
              "description": "The list of locations that can be specified when deploying resources",
              "strongType": "location"
            }
          },
          "metricsEnabled": {
            "type": "String",
            "metadata": {
              "displayName": "Enable Metrics",
              "description": "Enable Metrics - True or False"
            },
            "allowedValues": [
              "True",
              "False"
            ],
            "defaultValue": "False"
          },
          "logsEnabled": {
            "type": "String",
            "metadata": {
              "displayName": "Enable Logs",
              "description": "Enable Logs - True or False"
            },
            "allowedValues": [
              "True",
              "False"
            ],
            "defaultValue": "True"
          }
        },
        "policyRule": {
          "if": {
            "allOf": [
              {
                "field": "type",
                "equals": "Microsoft.Storage/storageAccounts"
              },
              {
                "field": "location",
                "in": "[[parameters('azureRegions')]"
              }
            ]
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "existenceCondition": {
                "allOf": [
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/logs.enabled",
                    "equals": "[[parameters('logsEnabled')]"
                  },
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/metrics.enabled",
                    "equals": "[[parameters('metricsEnabled')]"
                  },
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/eventHubName",
                    "equals": "[[last(split(parameters('eventHubName'), '/'))]"
                  }
                ]
              },
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "name": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      },
                      "eventHubName": {
                        "type": "string"
                      },
                      "eventHubRuleId": {
                        "type": "string"
                      },
                      "metricsEnabled": {
                        "type": "string"
                      },
                      "logsEnabled": {
                        "type": "string"
                      },
                      "profileName": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.Storage/storageAccounts/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[[concat(parameters('name'), '/', 'Microsoft.Insights/', parameters('profileName'))]",
                        "location": "[[parameters('location')]",
                        "dependsOn": [],
                        "properties": {
                          "eventHubName": "[[last(split(parameters('eventHubName'), '/'))]",
                          "eventHubAuthorizationRuleId": "[[parameters('eventHubRuleId')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": "[[parameters('metricsEnabled')]",
                              "retentionPolicy": {
                                "enabled": false,
                                "days": 0
                              }
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {
                      "policy": {
                        "type": "string",
                        "value": "[[concat(parameters('eventHubName'), 'configured for diagnostic logs for ', ': ', parameters('name'))]"
                      }
                    }
                  },
                  "parameters": {
                    "eventHubName": {
                      "value": "[[parameters('eventHubName')]"
                    },
                    "location": {
                      "value": "[[field('location')]"
                    },
                    "name": {
                      "value": "[[field('name')]"
                    },
                    "eventHubRuleId": {
                      "value": "[[parameters('eventHubRuleId')]"
                    },
                    "metricsEnabled": {
                      "value": "[[parameters('metricsEnabled')]"
                    },
                    "logsEnabled": {
                      "value": "[[parameters('logsEnabled')]"
                    },
                    "profileName": {
                      "value": "[[parameters('profileName')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "apiVersion": "2019-09-01",
      "name": "DE8BF220042039E3F2D6C37711DFA076",
      "properties": {
        "displayName": "Apply Diagnostic Settings for microsoft.insights/components (web) to a Regional Event Hub",
        "mode": "Indexed",
        "description": "This policy automatically deploys diagnostic settings to Apply Diagnostic Settings for microsoft.insights/components (web) to a Regional Event Hub.",
        "metadata": {
          "category": "Monitoring"
        },
        "parameters": {
          "profileName": {
            "type": "String",
            "metadata": {
              "displayName": "Profile Name for Config",
              "description": "The profile name Azure Diagnostics"
            }
          },
          "eventHubName": {
            "type": "String",
            "metadata": {
              "displayName": "EventHub Name",
              "description": "The event hub for Azure Diagnostics",
              "strongType": "Microsoft.EventHub/Namespaces/EventHubs",
              "assignPermissions": true
            }
          },
          "eventHubRuleId": {
            "type": "String",
            "metadata": {
              "displayName": "EventHubRuleID",
              "description": "The event hub RuleID for Azure Diagnostics",
              "strongType": "Microsoft.EventHub/Namespaces/AuthorizationRules",
              "assignPermissions": true
            }
          },
          "azureRegions": {
            "type": "Array",
            "metadata": {
              "displayName": "Allowed Locations",
              "description": "The list of locations that can be specified when deploying resources",
              "strongType": "location"
            }
          },
          "metricsEnabled": {
            "type": "String",
            "metadata": {
              "displayName": "Enable Metrics",
              "description": "Enable Metrics - True or False"
            },
            "allowedValues": [
              "True",
              "False"
            ],
            "defaultValue": "False"
          },
          "logsEnabled": {
            "type": "String",
            "metadata": {
              "displayName": "Enable Logs",
              "description": "Enable Logs - True or False"
            },
            "allowedValues": [
              "True",
              "False"
            ],
            "defaultValue": "True"
          }
        },
        "policyRule": {
          "if": {
            "allOf": [
              {
                "field": "type",
                "equals": "microsoft.insights/components"
              },
              {
                "field": "location",
                "in": "[[parameters('azureRegions')]"
              }
            ]
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "existenceCondition": {
                "allOf": [
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/logs.enabled",
                    "equals": "[[parameters('logsEnabled')]"
                  },
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/metrics.enabled",
                    "equals": "[[parameters('metricsEnabled')]"
                  },
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/eventHubName",
                    "equals": "[[last(split(parameters('eventHubName'), '/'))]"
                  }
                ]
              },
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "name": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      },
                      "eventHubName": {
                        "type": "string"
                      },
                      "eventHubRuleId": {
                        "type": "string"
                      },
                      "metricsEnabled": {
                        "type": "string"
                      },
                      "logsEnabled": {
                        "type": "string"
                      },
                      "profileName": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "microsoft.insights/components/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[[concat(parameters('name'), '/', 'Microsoft.Insights/', parameters('profileName'))]",
                        "location": "[[parameters('location')]",
                        "dependsOn": [],
                        "properties": {
                          "eventHubName": "[[last(split(parameters('eventHubName'), '/'))]",
                          "eventHubAuthorizationRuleId": "[[parameters('eventHubRuleId')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": "[[parameters('metricsEnabled')]",
                              "retentionPolicy": {
                                "enabled": false,
                                "days": 0
                              }
                            }
                          ],
                          "logs": [
                            {
                              "category": "AppAvailabilityResults",
                              "enabled": "[[parameters('logsEnabled')]"
                            },
                            {
                              "category": "AppBrowserTimings",
                              "enabled": "[[parameters('logsEnabled')]"
                            },
                            {
                              "category": "AppEvents",
                              "enabled": "[[parameters('logsEnabled')]"
                            },
                            {
                              "category": "AppMetrics",
                              "enabled": "[[parameters('logsEnabled')]"
                            },
                            {
                              "category": "AppDependencies",
                              "enabled": "[[parameters('logsEnabled')]"
                            },
                            {
                              "category": "AppExceptions",
                              "enabled": "[[parameters('logsEnabled')]"
                            },
                            {
                              "category": "AppPageViews",
                              "enabled": "[[parameters('logsEnabled')]"
                            },
                            {
                              "category": "AppPerformanceCounters",
                              "enabled": "[[parameters('logsEnabled')]"
                            },
                            {
                              "category": "AppRequests",
                              "enabled": "[[parameters('logsEnabled')]"
                            },
                            {
                              "category": "AppSystemEvents",
                              "enabled": "[[parameters('logsEnabled')]"
                            },
                            {
                              "category": "AppTraces",
                              "enabled": "[[parameters('logsEnabled')]"
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {
                      "policy": {
                        "type": "string",
                        "value": "[[concat(parameters('eventHubName'), 'configured for diagnostic logs for ', ': ', parameters('name'))]"
                      }
                    }
                  },
                  "parameters": {
                    "eventHubName": {
                      "value": "[[parameters('eventHubName')]"
                    },
                    "location": {
                      "value": "[[field('location')]"
                    },
                    "name": {
                      "value": "[[field('name')]"
                    },
                    "eventHubRuleId": {
                      "value": "[[parameters('eventHubRuleId')]"
                    },
                    "metricsEnabled": {
                      "value": "[[parameters('metricsEnabled')]"
                    },
                    "logsEnabled": {
                      "value": "[[parameters('logsEnabled')]"
                    },
                    "profileName": {
                      "value": "[[parameters('profileName')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "apiVersion": "2019-09-01",
      "name": "05A72FA2831F9B660C2C9EAA421CC083",
      "properties": {
        "displayName": "Apply Diagnostic Settings for Microsoft.Sql/servers (v12.0) to a Regional Event Hub",
        "mode": "Indexed",
        "description": "This policy automatically deploys diagnostic settings to Apply Diagnostic Settings for Microsoft.Sql/servers (v12.0) to a Regional Event Hub.",
        "metadata": {
          "category": "Monitoring"
        },
        "parameters": {
          "profileName": {
            "type": "String",
            "metadata": {
              "displayName": "Profile Name for Config",
              "description": "The profile name Azure Diagnostics"
            }
          },
          "eventHubName": {
            "type": "String",
            "metadata": {
              "displayName": "EventHub Name",
              "description": "The event hub for Azure Diagnostics",
              "strongType": "Microsoft.EventHub/Namespaces/EventHubs",
              "assignPermissions": true
            }
          },
          "eventHubRuleId": {
            "type": "String",
            "metadata": {
              "displayName": "EventHubRuleID",
              "description": "The event hub RuleID for Azure Diagnostics",
              "strongType": "Microsoft.EventHub/Namespaces/AuthorizationRules",
              "assignPermissions": true
            }
          },
          "azureRegions": {
            "type": "Array",
            "metadata": {
              "displayName": "Allowed Locations",
              "description": "The list of locations that can be specified when deploying resources",
              "strongType": "location"
            }
          },
          "metricsEnabled": {
            "type": "String",
            "metadata": {
              "displayName": "Enable Metrics",
              "description": "Enable Metrics - True or False"
            },
            "allowedValues": [
              "True",
              "False"
            ],
            "defaultValue": "False"
          },
          "logsEnabled": {
            "type": "String",
            "metadata": {
              "displayName": "Enable Logs",
              "description": "Enable Logs - True or False"
            },
            "allowedValues": [
              "True",
              "False"
            ],
            "defaultValue": "True"
          }
        },
        "policyRule": {
          "if": {
            "allOf": [
              {
                "field": "type",
                "equals": "Microsoft.Sql/servers"
              },
              {
                "field": "location",
                "in": "[[parameters('azureRegions')]"
              }
            ]
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "existenceCondition": {
                "allOf": [
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/logs.enabled",
                    "equals": "[[parameters('logsEnabled')]"
                  },
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/metrics.enabled",
                    "equals": "[[parameters('metricsEnabled')]"
                  },
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/eventHubName",
                    "equals": "[[last(split(parameters('eventHubName'), '/'))]"
                  }
                ]
              },
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "name": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      },
                      "eventHubName": {
                        "type": "string"
                      },
                      "eventHubRuleId": {
                        "type": "string"
                      },
                      "metricsEnabled": {
                        "type": "string"
                      },
                      "logsEnabled": {
                        "type": "string"
                      },
                      "profileName": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.Sql/servers/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[[concat(parameters('name'), '/', 'Microsoft.Insights/', parameters('profileName'))]",
                        "location": "[[parameters('location')]",
                        "dependsOn": [],
                        "properties": {
                          "eventHubName": "[[last(split(parameters('eventHubName'), '/'))]",
                          "eventHubAuthorizationRuleId": "[[parameters('eventHubRuleId')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": "[[parameters('metricsEnabled')]",
                              "retentionPolicy": {
                                "enabled": false,
                                "days": 0
                              }
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {
                      "policy": {
                        "type": "string",
                        "value": "[[concat(parameters('eventHubName'), 'configured for diagnostic logs for ', ': ', parameters('name'))]"
                      }
                    }
                  },
                  "parameters": {
                    "eventHubName": {
                      "value": "[[parameters('eventHubName')]"
                    },
                    "location": {
                      "value": "[[field('location')]"
                    },
                    "name": {
                      "value": "[[field('name')]"
                    },
                    "eventHubRuleId": {
                      "value": "[[parameters('eventHubRuleId')]"
                    },
                    "metricsEnabled": {
                      "value": "[[parameters('metricsEnabled')]"
                    },
                    "logsEnabled": {
                      "value": "[[parameters('logsEnabled')]"
                    },
                    "profileName": {
                      "value": "[[parameters('profileName')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "apiVersion": "2019-09-01",
      "name": "DCF778F39F2F9F201095B20EDF4A8095",
      "properties": {
        "displayName": "Apply Diagnostic Settings for Microsoft.Sql/servers/databases (v12.0,system) to a Regional Event Hub",
        "mode": "Indexed",
        "description": "This policy automatically deploys diagnostic settings to Apply Diagnostic Settings for Microsoft.Sql/servers/databases (v12.0,system) to a Regional Event Hub.",
        "metadata": {
          "category": "Monitoring"
        },
        "parameters": {
          "profileName": {
            "type": "String",
            "metadata": {
              "displayName": "Profile Name for Config",
              "description": "The profile name Azure Diagnostics"
            }
          },
          "eventHubName": {
            "type": "String",
            "metadata": {
              "displayName": "EventHub Name",
              "description": "The event hub for Azure Diagnostics",
              "strongType": "Microsoft.EventHub/Namespaces/EventHubs",
              "assignPermissions": true
            }
          },
          "eventHubRuleId": {
            "type": "String",
            "metadata": {
              "displayName": "EventHubRuleID",
              "description": "The event hub RuleID for Azure Diagnostics",
              "strongType": "Microsoft.EventHub/Namespaces/AuthorizationRules",
              "assignPermissions": true
            }
          },
          "azureRegions": {
            "type": "Array",
            "metadata": {
              "displayName": "Allowed Locations",
              "description": "The list of locations that can be specified when deploying resources",
              "strongType": "location"
            }
          },
          "metricsEnabled": {
            "type": "String",
            "metadata": {
              "displayName": "Enable Metrics",
              "description": "Enable Metrics - True or False"
            },
            "allowedValues": [
              "True",
              "False"
            ],
            "defaultValue": "False"
          },
          "logsEnabled": {
            "type": "String",
            "metadata": {
              "displayName": "Enable Logs",
              "description": "Enable Logs - True or False"
            },
            "allowedValues": [
              "True",
              "False"
            ],
            "defaultValue": "True"
          }
        },
        "policyRule": {
          "if": {
            "allOf": [
              {
                "field": "type",
                "equals": "Microsoft.Sql/servers/databases"
              },
              {
                "field": "location",
                "in": "[[parameters('azureRegions')]"
              },
              {
                "field": "kind",
                "equals": "v12.0,system"
              }
            ]
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "existenceCondition": {
                "allOf": [
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/logs.enabled",
                    "equals": "[[parameters('logsEnabled')]"
                  },
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/metrics.enabled",
                    "equals": "[[parameters('metricsEnabled')]"
                  },
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/eventHubName",
                    "equals": "[[last(split(parameters('eventHubName'), '/'))]"
                  }
                ]
              },
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "name": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      },
                      "eventHubName": {
                        "type": "string"
                      },
                      "eventHubRuleId": {
                        "type": "string"
                      },
                      "metricsEnabled": {
                        "type": "string"
                      },
                      "logsEnabled": {
                        "type": "string"
                      },
                      "profileName": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.Sql/servers/databases/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[[concat(parameters('name'), '/', 'Microsoft.Insights/', parameters('profileName'))]",
                        "location": "[[parameters('location')]",
                        "dependsOn": [],
                        "properties": {
                          "eventHubName": "[[last(split(parameters('eventHubName'), '/'))]",
                          "eventHubAuthorizationRuleId": "[[parameters('eventHubRuleId')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": "[[parameters('metricsEnabled')]",
                              "retentionPolicy": {
                                "enabled": false,
                                "days": 0
                              }
                            }
                          ],
                          "logs": [
                            {
                              "category": "SQLInsights",
                              "enabled": "[[parameters('logsEnabled')]"
                            },
                            {
                              "category": "AutomaticTuning",
                              "enabled": "[[parameters('logsEnabled')]"
                            },
                            {
                              "category": "QueryStoreRuntimeStatistics",
                              "enabled": "[[parameters('logsEnabled')]"
                            },
                            {
                              "category": "QueryStoreWaitStatistics",
                              "enabled": "[[parameters('logsEnabled')]"
                            },
                            {
                              "category": "Errors",
                              "enabled": "[[parameters('logsEnabled')]"
                            },
                            {
                              "category": "DatabaseWaitStatistics",
                              "enabled": "[[parameters('logsEnabled')]"
                            },
                            {
                              "category": "Timeouts",
                              "enabled": "[[parameters('logsEnabled')]"
                            },
                            {
                              "category": "Blocks",
                              "enabled": "[[parameters('logsEnabled')]"
                            },
                            {
                              "category": "Deadlocks",
                              "enabled": "[[parameters('logsEnabled')]"
                            },
                            {
                              "category": "DevOpsOperationsAudit",
                              "enabled": "[[parameters('logsEnabled')]"
                            },
                            {
                              "category": "SQLSecurityAuditEvents",
                              "enabled": "[[parameters('logsEnabled')]"
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {
                      "policy": {
                        "type": "string",
                        "value": "[[concat(parameters('eventHubName'), 'configured for diagnostic logs for ', ': ', parameters('name'))]"
                      }
                    }
                  },
                  "parameters": {
                    "eventHubName": {
                      "value": "[[parameters('eventHubName')]"
                    },
                    "location": {
                      "value": "[[field('location')]"
                    },
                    "name": {
                      "value": "[[field('fullName')]"
                    },
                    "eventHubRuleId": {
                      "value": "[[parameters('eventHubRuleId')]"
                    },
                    "metricsEnabled": {
                      "value": "[[parameters('metricsEnabled')]"
                    },
                    "logsEnabled": {
                      "value": "[[parameters('logsEnabled')]"
                    },
                    "profileName": {
                      "value": "[[parameters('profileName')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "apiVersion": "2019-09-01",
      "name": "CB76F6D874BFEA0FBC59F76E13AABC2E",
      "properties": {
        "displayName": "Apply Diagnostic Settings for Microsoft.Storage/storageAccounts (StorageV2) to a Regional Event Hub",
        "mode": "Indexed",
        "description": "This policy automatically deploys diagnostic settings to Apply Diagnostic Settings for Microsoft.Storage/storageAccounts (StorageV2) to a Regional Event Hub.",
        "metadata": {
          "category": "Monitoring"
        },
        "parameters": {
          "profileName": {
            "type": "String",
            "metadata": {
              "displayName": "Profile Name for Config",
              "description": "The profile name Azure Diagnostics"
            }
          },
          "eventHubName": {
            "type": "String",
            "metadata": {
              "displayName": "EventHub Name",
              "description": "The event hub for Azure Diagnostics",
              "strongType": "Microsoft.EventHub/Namespaces/EventHubs",
              "assignPermissions": true
            }
          },
          "eventHubRuleId": {
            "type": "String",
            "metadata": {
              "displayName": "EventHubRuleID",
              "description": "The event hub RuleID for Azure Diagnostics",
              "strongType": "Microsoft.EventHub/Namespaces/AuthorizationRules",
              "assignPermissions": true
            }
          },
          "azureRegions": {
            "type": "Array",
            "metadata": {
              "displayName": "Allowed Locations",
              "description": "The list of locations that can be specified when deploying resources",
              "strongType": "location"
            }
          },
          "metricsEnabled": {
            "type": "String",
            "metadata": {
              "displayName": "Enable Metrics",
              "description": "Enable Metrics - True or False"
            },
            "allowedValues": [
              "True",
              "False"
            ],
            "defaultValue": "False"
          },
          "logsEnabled": {
            "type": "String",
            "metadata": {
              "displayName": "Enable Logs",
              "description": "Enable Logs - True or False"
            },
            "allowedValues": [
              "True",
              "False"
            ],
            "defaultValue": "True"
          }
        },
        "policyRule": {
          "if": {
            "allOf": [
              {
                "field": "type",
                "equals": "Microsoft.Storage/storageAccounts"
              },
              {
                "field": "location",
                "in": "[[parameters('azureRegions')]"
              },
              {
                "field": "kind",
                "equals": "StorageV2"
              }
            ]
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "existenceCondition": {
                "allOf": [
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/logs.enabled",
                    "equals": "[[parameters('logsEnabled')]"
                  },
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/metrics.enabled",
                    "equals": "[[parameters('metricsEnabled')]"
                  },
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/eventHubName",
                    "equals": "[[last(split(parameters('eventHubName'), '/'))]"
                  }
                ]
              },
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "name": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      },
                      "eventHubName": {
                        "type": "string"
                      },
                      "eventHubRuleId": {
                        "type": "string"
                      },
                      "metricsEnabled": {
                        "type": "string"
                      },
                      "logsEnabled": {
                        "type": "string"
                      },
                      "profileName": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.Storage/storageAccounts/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[[concat(parameters('name'), '/', 'Microsoft.Insights/', parameters('profileName'))]",
                        "location": "[[parameters('location')]",
                        "dependsOn": [],
                        "properties": {
                          "eventHubName": "[[last(split(parameters('eventHubName'), '/'))]",
                          "eventHubAuthorizationRuleId": "[[parameters('eventHubRuleId')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": "[[parameters('metricsEnabled')]",
                              "retentionPolicy": {
                                "enabled": false,
                                "days": 0
                              }
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {
                      "policy": {
                        "type": "string",
                        "value": "[[concat(parameters('eventHubName'), 'configured for diagnostic logs for ', ': ', parameters('name'))]"
                      }
                    }
                  },
                  "parameters": {
                    "eventHubName": {
                      "value": "[[parameters('eventHubName')]"
                    },
                    "location": {
                      "value": "[[field('location')]"
                    },
                    "name": {
                      "value": "[[field('name')]"
                    },
                    "eventHubRuleId": {
                      "value": "[[parameters('eventHubRuleId')]"
                    },
                    "metricsEnabled": {
                      "value": "[[parameters('metricsEnabled')]"
                    },
                    "logsEnabled": {
                      "value": "[[parameters('logsEnabled')]"
                    },
                    "profileName": {
                      "value": "[[parameters('profileName')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "apiVersion": "2019-09-01",
      "name": "855EF5B024C4E3C75E81D4850CBB181E",
      "properties": {
        "displayName": "Apply Diagnostic Settings for Microsoft.Web/sites (app,linux) to a Regional Event Hub",
        "mode": "Indexed",
        "description": "This policy automatically deploys diagnostic settings to Apply Diagnostic Settings for Microsoft.Web/sites (app,linux) to a Regional Event Hub.",
        "metadata": {
          "category": "Monitoring"
        },
        "parameters": {
          "profileName": {
            "type": "String",
            "metadata": {
              "displayName": "Profile Name for Config",
              "description": "The profile name Azure Diagnostics"
            }
          },
          "eventHubName": {
            "type": "String",
            "metadata": {
              "displayName": "EventHub Name",
              "description": "The event hub for Azure Diagnostics",
              "strongType": "Microsoft.EventHub/Namespaces/EventHubs",
              "assignPermissions": true
            }
          },
          "eventHubRuleId": {
            "type": "String",
            "metadata": {
              "displayName": "EventHubRuleID",
              "description": "The event hub RuleID for Azure Diagnostics",
              "strongType": "Microsoft.EventHub/Namespaces/AuthorizationRules",
              "assignPermissions": true
            }
          },
          "azureRegions": {
            "type": "Array",
            "metadata": {
              "displayName": "Allowed Locations",
              "description": "The list of locations that can be specified when deploying resources",
              "strongType": "location"
            }
          },
          "metricsEnabled": {
            "type": "String",
            "metadata": {
              "displayName": "Enable Metrics",
              "description": "Enable Metrics - True or False"
            },
            "allowedValues": [
              "True",
              "False"
            ],
            "defaultValue": "False"
          },
          "logsEnabled": {
            "type": "String",
            "metadata": {
              "displayName": "Enable Logs",
              "description": "Enable Logs - True or False"
            },
            "allowedValues": [
              "True",
              "False"
            ],
            "defaultValue": "True"
          }
        },
        "policyRule": {
          "if": {
            "allOf": [
              {
                "field": "type",
                "equals": "Microsoft.Web/sites"
              },
              {
                "field": "location",
                "in": "[[parameters('azureRegions')]"
              },
              {
                "field": "kind",
                "equals": "app,linux"
              }
            ]
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "existenceCondition": {
                "allOf": [
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/logs.enabled",
                    "equals": "[[parameters('logsEnabled')]"
                  },
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/metrics.enabled",
                    "equals": "[[parameters('metricsEnabled')]"
                  },
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/eventHubName",
                    "equals": "[[last(split(parameters('eventHubName'), '/'))]"
                  }
                ]
              },
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "name": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      },
                      "eventHubName": {
                        "type": "string"
                      },
                      "eventHubRuleId": {
                        "type": "string"
                      },
                      "metricsEnabled": {
                        "type": "string"
                      },
                      "logsEnabled": {
                        "type": "string"
                      },
                      "profileName": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.Web/sites/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[[concat(parameters('name'), '/', 'Microsoft.Insights/', parameters('profileName'))]",
                        "location": "[[parameters('location')]",
                        "dependsOn": [],
                        "properties": {
                          "eventHubName": "[[last(split(parameters('eventHubName'), '/'))]",
                          "eventHubAuthorizationRuleId": "[[parameters('eventHubRuleId')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": "[[parameters('metricsEnabled')]",
                              "retentionPolicy": {
                                "enabled": false,
                                "days": 0
                              }
                            }
                          ],
                          "logs": [
                            {
                              "category": "AppServiceAntivirusScanAuditLogs",
                              "enabled": "[[parameters('logsEnabled')]"
                            },
                            {
                              "category": "AppServiceHTTPLogs",
                              "enabled": "[[parameters('logsEnabled')]"
                            },
                            {
                              "category": "AppServiceConsoleLogs",
                              "enabled": "[[parameters('logsEnabled')]"
                            },
                            {
                              "category": "AppServiceAppLogs",
                              "enabled": "[[parameters('logsEnabled')]"
                            },
                            {
                              "category": "AppServiceFileAuditLogs",
                              "enabled": "[[parameters('logsEnabled')]"
                            },
                            {
                              "category": "AppServiceAuditLogs",
                              "enabled": "[[parameters('logsEnabled')]"
                            },
                            {
                              "category": "AppServiceIPSecAuditLogs",
                              "enabled": "[[parameters('logsEnabled')]"
                            },
                            {
                              "category": "AppServicePlatformLogs",
                              "enabled": "[[parameters('logsEnabled')]"
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {
                      "policy": {
                        "type": "string",
                        "value": "[[concat(parameters('eventHubName'), 'configured for diagnostic logs for ', ': ', parameters('name'))]"
                      }
                    }
                  },
                  "parameters": {
                    "eventHubName": {
                      "value": "[[parameters('eventHubName')]"
                    },
                    "location": {
                      "value": "[[field('location')]"
                    },
                    "name": {
                      "value": "[[field('name')]"
                    },
                    "eventHubRuleId": {
                      "value": "[[parameters('eventHubRuleId')]"
                    },
                    "metricsEnabled": {
                      "value": "[[parameters('metricsEnabled')]"
                    },
                    "logsEnabled": {
                      "value": "[[parameters('logsEnabled')]"
                    },
                    "profileName": {
                      "value": "[[parameters('profileName')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "apiVersion": "2019-09-01",
      "name": "A7F84303540A7D5588A3C13AEE85C324",
      "properties": {
        "displayName": "Apply Diagnostic Settings for Microsoft.ApiManagement/service to a Regional Event Hub",
        "mode": "Indexed",
        "description": "This policy automatically deploys diagnostic settings to Apply Diagnostic Settings for Microsoft.ApiManagement/service to a Regional Event Hub.",
        "metadata": {
          "category": "Monitoring"
        },
        "parameters": {
          "profileName": {
            "type": "String",
            "metadata": {
              "displayName": "Profile Name for Config",
              "description": "The profile name Azure Diagnostics"
            }
          },
          "eventHubName": {
            "type": "String",
            "metadata": {
              "displayName": "EventHub Name",
              "description": "The event hub for Azure Diagnostics",
              "strongType": "Microsoft.EventHub/Namespaces/EventHubs",
              "assignPermissions": true
            }
          },
          "eventHubRuleId": {
            "type": "String",
            "metadata": {
              "displayName": "EventHubRuleID",
              "description": "The event hub RuleID for Azure Diagnostics",
              "strongType": "Microsoft.EventHub/Namespaces/AuthorizationRules",
              "assignPermissions": true
            }
          },
          "azureRegions": {
            "type": "Array",
            "metadata": {
              "displayName": "Allowed Locations",
              "description": "The list of locations that can be specified when deploying resources",
              "strongType": "location"
            }
          },
          "metricsEnabled": {
            "type": "String",
            "metadata": {
              "displayName": "Enable Metrics",
              "description": "Enable Metrics - True or False"
            },
            "allowedValues": [
              "True",
              "False"
            ],
            "defaultValue": "False"
          },
          "logsEnabled": {
            "type": "String",
            "metadata": {
              "displayName": "Enable Logs",
              "description": "Enable Logs - True or False"
            },
            "allowedValues": [
              "True",
              "False"
            ],
            "defaultValue": "True"
          }
        },
        "policyRule": {
          "if": {
            "allOf": [
              {
                "field": "type",
                "equals": "Microsoft.ApiManagement/service"
              },
              {
                "field": "location",
                "in": "[[parameters('azureRegions')]"
              }
            ]
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "existenceCondition": {
                "allOf": [
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/logs.enabled",
                    "equals": "[[parameters('logsEnabled')]"
                  },
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/metrics.enabled",
                    "equals": "[[parameters('metricsEnabled')]"
                  },
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/eventHubName",
                    "equals": "[[last(split(parameters('eventHubName'), '/'))]"
                  }
                ]
              },
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "name": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      },
                      "eventHubName": {
                        "type": "string"
                      },
                      "eventHubRuleId": {
                        "type": "string"
                      },
                      "metricsEnabled": {
                        "type": "string"
                      },
                      "logsEnabled": {
                        "type": "string"
                      },
                      "profileName": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.ApiManagement/service/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[[concat(parameters('name'), '/', 'Microsoft.Insights/', parameters('profileName'))]",
                        "location": "[[parameters('location')]",
                        "dependsOn": [],
                        "properties": {
                          "eventHubName": "[[last(split(parameters('eventHubName'), '/'))]",
                          "eventHubAuthorizationRuleId": "[[parameters('eventHubRuleId')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": "[[parameters('metricsEnabled')]",
                              "retentionPolicy": {
                                "enabled": false,
                                "days": 0
                              }
                            }
                          ],
                          "logs": [
                            {
                              "category": "GatewayLogs",
                              "enabled": "[[parameters('logsEnabled')]"
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {
                      "policy": {
                        "type": "string",
                        "value": "[[concat(parameters('eventHubName'), 'configured for diagnostic logs for ', ': ', parameters('name'))]"
                      }
                    }
                  },
                  "parameters": {
                    "eventHubName": {
                      "value": "[[parameters('eventHubName')]"
                    },
                    "location": {
                      "value": "[[field('location')]"
                    },
                    "name": {
                      "value": "[[field('name')]"
                    },
                    "eventHubRuleId": {
                      "value": "[[parameters('eventHubRuleId')]"
                    },
                    "metricsEnabled": {
                      "value": "[[parameters('metricsEnabled')]"
                    },
                    "logsEnabled": {
                      "value": "[[parameters('logsEnabled')]"
                    },
                    "profileName": {
                      "value": "[[parameters('profileName')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "apiVersion": "2019-09-01",
      "name": "E0CC0DB1153DA5E2CCE75FC2900A0439",
      "properties": {
        "displayName": "Apply Diagnostic Settings for Microsoft.Web/serverFarms (functionapp) to a Regional Event Hub",
        "mode": "Indexed",
        "description": "This policy automatically deploys diagnostic settings to Apply Diagnostic Settings for Microsoft.Web/serverFarms (functionapp) to a Regional Event Hub.",
        "metadata": {
          "category": "Monitoring"
        },
        "parameters": {
          "profileName": {
            "type": "String",
            "metadata": {
              "displayName": "Profile Name for Config",
              "description": "The profile name Azure Diagnostics"
            }
          },
          "eventHubName": {
            "type": "String",
            "metadata": {
              "displayName": "EventHub Name",
              "description": "The event hub for Azure Diagnostics",
              "strongType": "Microsoft.EventHub/Namespaces/EventHubs",
              "assignPermissions": true
            }
          },
          "eventHubRuleId": {
            "type": "String",
            "metadata": {
              "displayName": "EventHubRuleID",
              "description": "The event hub RuleID for Azure Diagnostics",
              "strongType": "Microsoft.EventHub/Namespaces/AuthorizationRules",
              "assignPermissions": true
            }
          },
          "azureRegions": {
            "type": "Array",
            "metadata": {
              "displayName": "Allowed Locations",
              "description": "The list of locations that can be specified when deploying resources",
              "strongType": "location"
            }
          },
          "metricsEnabled": {
            "type": "String",
            "metadata": {
              "displayName": "Enable Metrics",
              "description": "Enable Metrics - True or False"
            },
            "allowedValues": [
              "True",
              "False"
            ],
            "defaultValue": "False"
          },
          "logsEnabled": {
            "type": "String",
            "metadata": {
              "displayName": "Enable Logs",
              "description": "Enable Logs - True or False"
            },
            "allowedValues": [
              "True",
              "False"
            ],
            "defaultValue": "True"
          }
        },
        "policyRule": {
          "if": {
            "allOf": [
              {
                "field": "type",
                "equals": "Microsoft.Web/serverFarms"
              },
              {
                "field": "location",
                "in": "[[parameters('azureRegions')]"
              },
              {
                "field": "kind",
                "equals": "functionapp"
              }
            ]
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "existenceCondition": {
                "allOf": [
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/logs.enabled",
                    "equals": "[[parameters('logsEnabled')]"
                  },
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/metrics.enabled",
                    "equals": "[[parameters('metricsEnabled')]"
                  },
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/eventHubName",
                    "equals": "[[last(split(parameters('eventHubName'), '/'))]"
                  }
                ]
              },
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "name": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      },
                      "eventHubName": {
                        "type": "string"
                      },
                      "eventHubRuleId": {
                        "type": "string"
                      },
                      "metricsEnabled": {
                        "type": "string"
                      },
                      "logsEnabled": {
                        "type": "string"
                      },
                      "profileName": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.Web/serverFarms/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[[concat(parameters('name'), '/', 'Microsoft.Insights/', parameters('profileName'))]",
                        "location": "[[parameters('location')]",
                        "dependsOn": [],
                        "properties": {
                          "eventHubName": "[[last(split(parameters('eventHubName'), '/'))]",
                          "eventHubAuthorizationRuleId": "[[parameters('eventHubRuleId')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": "[[parameters('metricsEnabled')]",
                              "retentionPolicy": {
                                "enabled": false,
                                "days": 0
                              }
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {
                      "policy": {
                        "type": "string",
                        "value": "[[concat(parameters('eventHubName'), 'configured for diagnostic logs for ', ': ', parameters('name'))]"
                      }
                    }
                  },
                  "parameters": {
                    "eventHubName": {
                      "value": "[[parameters('eventHubName')]"
                    },
                    "location": {
                      "value": "[[field('location')]"
                    },
                    "name": {
                      "value": "[[field('name')]"
                    },
                    "eventHubRuleId": {
                      "value": "[[parameters('eventHubRuleId')]"
                    },
                    "metricsEnabled": {
                      "value": "[[parameters('metricsEnabled')]"
                    },
                    "logsEnabled": {
                      "value": "[[parameters('logsEnabled')]"
                    },
                    "profileName": {
                      "value": "[[parameters('profileName')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "apiVersion": "2019-09-01",
      "name": "7BA6741429811894D30B7F69560AE62D",
      "properties": {
        "displayName": "Apply Diagnostic Settings for Microsoft.Web/serverFarms (linux) to a Regional Event Hub",
        "mode": "Indexed",
        "description": "This policy automatically deploys diagnostic settings to Apply Diagnostic Settings for Microsoft.Web/serverFarms (linux) to a Regional Event Hub.",
        "metadata": {
          "category": "Monitoring"
        },
        "parameters": {
          "profileName": {
            "type": "String",
            "metadata": {
              "displayName": "Profile Name for Config",
              "description": "The profile name Azure Diagnostics"
            }
          },
          "eventHubName": {
            "type": "String",
            "metadata": {
              "displayName": "EventHub Name",
              "description": "The event hub for Azure Diagnostics",
              "strongType": "Microsoft.EventHub/Namespaces/EventHubs",
              "assignPermissions": true
            }
          },
          "eventHubRuleId": {
            "type": "String",
            "metadata": {
              "displayName": "EventHubRuleID",
              "description": "The event hub RuleID for Azure Diagnostics",
              "strongType": "Microsoft.EventHub/Namespaces/AuthorizationRules",
              "assignPermissions": true
            }
          },
          "azureRegions": {
            "type": "Array",
            "metadata": {
              "displayName": "Allowed Locations",
              "description": "The list of locations that can be specified when deploying resources",
              "strongType": "location"
            }
          },
          "metricsEnabled": {
            "type": "String",
            "metadata": {
              "displayName": "Enable Metrics",
              "description": "Enable Metrics - True or False"
            },
            "allowedValues": [
              "True",
              "False"
            ],
            "defaultValue": "False"
          },
          "logsEnabled": {
            "type": "String",
            "metadata": {
              "displayName": "Enable Logs",
              "description": "Enable Logs - True or False"
            },
            "allowedValues": [
              "True",
              "False"
            ],
            "defaultValue": "True"
          }
        },
        "policyRule": {
          "if": {
            "allOf": [
              {
                "field": "type",
                "equals": "Microsoft.Web/serverFarms"
              },
              {
                "field": "location",
                "in": "[[parameters('azureRegions')]"
              },
              {
                "field": "kind",
                "equals": "linux"
              }
            ]
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "existenceCondition": {
                "allOf": [
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/logs.enabled",
                    "equals": "[[parameters('logsEnabled')]"
                  },
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/metrics.enabled",
                    "equals": "[[parameters('metricsEnabled')]"
                  },
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/eventHubName",
                    "equals": "[[last(split(parameters('eventHubName'), '/'))]"
                  }
                ]
              },
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "name": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      },
                      "eventHubName": {
                        "type": "string"
                      },
                      "eventHubRuleId": {
                        "type": "string"
                      },
                      "metricsEnabled": {
                        "type": "string"
                      },
                      "logsEnabled": {
                        "type": "string"
                      },
                      "profileName": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.Web/serverFarms/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[[concat(parameters('name'), '/', 'Microsoft.Insights/', parameters('profileName'))]",
                        "location": "[[parameters('location')]",
                        "dependsOn": [],
                        "properties": {
                          "eventHubName": "[[last(split(parameters('eventHubName'), '/'))]",
                          "eventHubAuthorizationRuleId": "[[parameters('eventHubRuleId')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": "[[parameters('metricsEnabled')]",
                              "retentionPolicy": {
                                "enabled": false,
                                "days": 0
                              }
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {
                      "policy": {
                        "type": "string",
                        "value": "[[concat(parameters('eventHubName'), 'configured for diagnostic logs for ', ': ', parameters('name'))]"
                      }
                    }
                  },
                  "parameters": {
                    "eventHubName": {
                      "value": "[[parameters('eventHubName')]"
                    },
                    "location": {
                      "value": "[[field('location')]"
                    },
                    "name": {
                      "value": "[[field('name')]"
                    },
                    "eventHubRuleId": {
                      "value": "[[parameters('eventHubRuleId')]"
                    },
                    "metricsEnabled": {
                      "value": "[[parameters('metricsEnabled')]"
                    },
                    "logsEnabled": {
                      "value": "[[parameters('logsEnabled')]"
                    },
                    "profileName": {
                      "value": "[[parameters('profileName')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "apiVersion": "2019-09-01",
      "name": "4A4326E787B2301C880908962F6BE4A2",
      "properties": {
        "displayName": "Apply Diagnostic Settings for Microsoft.Web/serverFarms (app) to a Regional Event Hub",
        "mode": "Indexed",
        "description": "This policy automatically deploys diagnostic settings to Apply Diagnostic Settings for Microsoft.Web/serverFarms (app) to a Regional Event Hub.",
        "metadata": {
          "category": "Monitoring"
        },
        "parameters": {
          "profileName": {
            "type": "String",
            "metadata": {
              "displayName": "Profile Name for Config",
              "description": "The profile name Azure Diagnostics"
            }
          },
          "eventHubName": {
            "type": "String",
            "metadata": {
              "displayName": "EventHub Name",
              "description": "The event hub for Azure Diagnostics",
              "strongType": "Microsoft.EventHub/Namespaces/EventHubs",
              "assignPermissions": true
            }
          },
          "eventHubRuleId": {
            "type": "String",
            "metadata": {
              "displayName": "EventHubRuleID",
              "description": "The event hub RuleID for Azure Diagnostics",
              "strongType": "Microsoft.EventHub/Namespaces/AuthorizationRules",
              "assignPermissions": true
            }
          },
          "azureRegions": {
            "type": "Array",
            "metadata": {
              "displayName": "Allowed Locations",
              "description": "The list of locations that can be specified when deploying resources",
              "strongType": "location"
            }
          },
          "metricsEnabled": {
            "type": "String",
            "metadata": {
              "displayName": "Enable Metrics",
              "description": "Enable Metrics - True or False"
            },
            "allowedValues": [
              "True",
              "False"
            ],
            "defaultValue": "False"
          },
          "logsEnabled": {
            "type": "String",
            "metadata": {
              "displayName": "Enable Logs",
              "description": "Enable Logs - True or False"
            },
            "allowedValues": [
              "True",
              "False"
            ],
            "defaultValue": "True"
          }
        },
        "policyRule": {
          "if": {
            "allOf": [
              {
                "field": "type",
                "equals": "Microsoft.Web/serverFarms"
              },
              {
                "field": "location",
                "in": "[[parameters('azureRegions')]"
              }
            ]
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "existenceCondition": {
                "allOf": [
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/logs.enabled",
                    "equals": "[[parameters('logsEnabled')]"
                  },
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/metrics.enabled",
                    "equals": "[[parameters('metricsEnabled')]"
                  },
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/eventHubName",
                    "equals": "[[last(split(parameters('eventHubName'), '/'))]"
                  }
                ]
              },
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "name": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      },
                      "eventHubName": {
                        "type": "string"
                      },
                      "eventHubRuleId": {
                        "type": "string"
                      },
                      "metricsEnabled": {
                        "type": "string"
                      },
                      "logsEnabled": {
                        "type": "string"
                      },
                      "profileName": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.Web/serverFarms/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[[concat(parameters('name'), '/', 'Microsoft.Insights/', parameters('profileName'))]",
                        "location": "[[parameters('location')]",
                        "dependsOn": [],
                        "properties": {
                          "eventHubName": "[[last(split(parameters('eventHubName'), '/'))]",
                          "eventHubAuthorizationRuleId": "[[parameters('eventHubRuleId')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": "[[parameters('metricsEnabled')]",
                              "retentionPolicy": {
                                "enabled": false,
                                "days": 0
                              }
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {
                      "policy": {
                        "type": "string",
                        "value": "[[concat(parameters('eventHubName'), 'configured for diagnostic logs for ', ': ', parameters('name'))]"
                      }
                    }
                  },
                  "parameters": {
                    "eventHubName": {
                      "value": "[[parameters('eventHubName')]"
                    },
                    "location": {
                      "value": "[[field('location')]"
                    },
                    "name": {
                      "value": "[[field('name')]"
                    },
                    "eventHubRuleId": {
                      "value": "[[parameters('eventHubRuleId')]"
                    },
                    "metricsEnabled": {
                      "value": "[[parameters('metricsEnabled')]"
                    },
                    "logsEnabled": {
                      "value": "[[parameters('logsEnabled')]"
                    },
                    "profileName": {
                      "value": "[[parameters('profileName')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "apiVersion": "2019-09-01",
      "name": "646F62950D2FC86CB224C9DE9C22B3E8",
      "properties": {
        "displayName": "Apply Diagnostic Settings for Microsoft.KeyVault/vaults to a Regional Event Hub",
        "mode": "Indexed",
        "description": "This policy automatically deploys diagnostic settings to Apply Diagnostic Settings for Microsoft.KeyVault/vaults to a Regional Event Hub.",
        "metadata": {
          "category": "Monitoring"
        },
        "parameters": {
          "profileName": {
            "type": "String",
            "metadata": {
              "displayName": "Profile Name for Config",
              "description": "The profile name Azure Diagnostics"
            }
          },
          "eventHubName": {
            "type": "String",
            "metadata": {
              "displayName": "EventHub Name",
              "description": "The event hub for Azure Diagnostics",
              "strongType": "Microsoft.EventHub/Namespaces/EventHubs",
              "assignPermissions": true
            }
          },
          "eventHubRuleId": {
            "type": "String",
            "metadata": {
              "displayName": "EventHubRuleID",
              "description": "The event hub RuleID for Azure Diagnostics",
              "strongType": "Microsoft.EventHub/Namespaces/AuthorizationRules",
              "assignPermissions": true
            }
          },
          "azureRegions": {
            "type": "Array",
            "metadata": {
              "displayName": "Allowed Locations",
              "description": "The list of locations that can be specified when deploying resources",
              "strongType": "location"
            }
          },
          "metricsEnabled": {
            "type": "String",
            "metadata": {
              "displayName": "Enable Metrics",
              "description": "Enable Metrics - True or False"
            },
            "allowedValues": [
              "True",
              "False"
            ],
            "defaultValue": "False"
          },
          "logsEnabled": {
            "type": "String",
            "metadata": {
              "displayName": "Enable Logs",
              "description": "Enable Logs - True or False"
            },
            "allowedValues": [
              "True",
              "False"
            ],
            "defaultValue": "True"
          }
        },
        "policyRule": {
          "if": {
            "allOf": [
              {
                "field": "type",
                "equals": "Microsoft.KeyVault/vaults"
              },
              {
                "field": "location",
                "in": "[[parameters('azureRegions')]"
              }
            ]
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "existenceCondition": {
                "allOf": [
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/logs.enabled",
                    "equals": "[[parameters('logsEnabled')]"
                  },
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/metrics.enabled",
                    "equals": "[[parameters('metricsEnabled')]"
                  },
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/eventHubName",
                    "equals": "[[last(split(parameters('eventHubName'), '/'))]"
                  }
                ]
              },
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "name": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      },
                      "eventHubName": {
                        "type": "string"
                      },
                      "eventHubRuleId": {
                        "type": "string"
                      },
                      "metricsEnabled": {
                        "type": "string"
                      },
                      "logsEnabled": {
                        "type": "string"
                      },
                      "profileName": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.KeyVault/vaults/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[[concat(parameters('name'), '/', 'Microsoft.Insights/', parameters('profileName'))]",
                        "location": "[[parameters('location')]",
                        "dependsOn": [],
                        "properties": {
                          "eventHubName": "[[last(split(parameters('eventHubName'), '/'))]",
                          "eventHubAuthorizationRuleId": "[[parameters('eventHubRuleId')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": "[[parameters('metricsEnabled')]",
                              "retentionPolicy": {
                                "enabled": false,
                                "days": 0
                              }
                            }
                          ],
                          "logs": [
                            {
                              "category": "AuditEvent",
                              "enabled": "[[parameters('logsEnabled')]"
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {
                      "policy": {
                        "type": "string",
                        "value": "[[concat(parameters('eventHubName'), 'configured for diagnostic logs for ', ': ', parameters('name'))]"
                      }
                    }
                  },
                  "parameters": {
                    "eventHubName": {
                      "value": "[[parameters('eventHubName')]"
                    },
                    "location": {
                      "value": "[[field('location')]"
                    },
                    "name": {
                      "value": "[[field('name')]"
                    },
                    "eventHubRuleId": {
                      "value": "[[parameters('eventHubRuleId')]"
                    },
                    "metricsEnabled": {
                      "value": "[[parameters('metricsEnabled')]"
                    },
                    "logsEnabled": {
                      "value": "[[parameters('logsEnabled')]"
                    },
                    "profileName": {
                      "value": "[[parameters('profileName')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "apiVersion": "2019-09-01",
      "name": "EAF8CE5F106CB4EC81537E76A11B3C31",
      "properties": {
        "displayName": "Apply Diagnostic Settings for Microsoft.Automation/automationAccounts to a Regional Event Hub",
        "mode": "Indexed",
        "description": "This policy automatically deploys diagnostic settings to Apply Diagnostic Settings for Microsoft.Automation/automationAccounts to a Regional Event Hub.",
        "metadata": {
          "category": "Monitoring"
        },
        "parameters": {
          "profileName": {
            "type": "String",
            "metadata": {
              "displayName": "Profile Name for Config",
              "description": "The profile name Azure Diagnostics"
            }
          },
          "eventHubName": {
            "type": "String",
            "metadata": {
              "displayName": "EventHub Name",
              "description": "The event hub for Azure Diagnostics",
              "strongType": "Microsoft.EventHub/Namespaces/EventHubs",
              "assignPermissions": true
            }
          },
          "eventHubRuleId": {
            "type": "String",
            "metadata": {
              "displayName": "EventHubRuleID",
              "description": "The event hub RuleID for Azure Diagnostics",
              "strongType": "Microsoft.EventHub/Namespaces/AuthorizationRules",
              "assignPermissions": true
            }
          },
          "azureRegions": {
            "type": "Array",
            "metadata": {
              "displayName": "Allowed Locations",
              "description": "The list of locations that can be specified when deploying resources",
              "strongType": "location"
            }
          },
          "metricsEnabled": {
            "type": "String",
            "metadata": {
              "displayName": "Enable Metrics",
              "description": "Enable Metrics - True or False"
            },
            "allowedValues": [
              "True",
              "False"
            ],
            "defaultValue": "False"
          },
          "logsEnabled": {
            "type": "String",
            "metadata": {
              "displayName": "Enable Logs",
              "description": "Enable Logs - True or False"
            },
            "allowedValues": [
              "True",
              "False"
            ],
            "defaultValue": "True"
          }
        },
        "policyRule": {
          "if": {
            "allOf": [
              {
                "field": "type",
                "equals": "Microsoft.Automation/automationAccounts"
              },
              {
                "field": "location",
                "in": "[[parameters('azureRegions')]"
              }
            ]
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "existenceCondition": {
                "allOf": [
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/logs.enabled",
                    "equals": "[[parameters('logsEnabled')]"
                  },
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/metrics.enabled",
                    "equals": "[[parameters('metricsEnabled')]"
                  },
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/eventHubName",
                    "equals": "[[last(split(parameters('eventHubName'), '/'))]"
                  }
                ]
              },
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "name": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      },
                      "eventHubName": {
                        "type": "string"
                      },
                      "eventHubRuleId": {
                        "type": "string"
                      },
                      "metricsEnabled": {
                        "type": "string"
                      },
                      "logsEnabled": {
                        "type": "string"
                      },
                      "profileName": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.Automation/automationAccounts/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[[concat(parameters('name'), '/', 'Microsoft.Insights/', parameters('profileName'))]",
                        "location": "[[parameters('location')]",
                        "dependsOn": [],
                        "properties": {
                          "eventHubName": "[[last(split(parameters('eventHubName'), '/'))]",
                          "eventHubAuthorizationRuleId": "[[parameters('eventHubRuleId')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": "[[parameters('metricsEnabled')]",
                              "retentionPolicy": {
                                "enabled": false,
                                "days": 0
                              }
                            }
                          ],
                          "logs": [
                            {
                              "category": "JobLogs",
                              "enabled": "[[parameters('logsEnabled')]"
                            },
                            {
                              "category": "JobStreams",
                              "enabled": "[[parameters('logsEnabled')]"
                            },
                            {
                              "category": "DscNodeStatus",
                              "enabled": "[[parameters('logsEnabled')]"
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {
                      "policy": {
                        "type": "string",
                        "value": "[[concat(parameters('eventHubName'), 'configured for diagnostic logs for ', ': ', parameters('name'))]"
                      }
                    }
                  },
                  "parameters": {
                    "eventHubName": {
                      "value": "[[parameters('eventHubName')]"
                    },
                    "location": {
                      "value": "[[field('location')]"
                    },
                    "name": {
                      "value": "[[field('name')]"
                    },
                    "eventHubRuleId": {
                      "value": "[[parameters('eventHubRuleId')]"
                    },
                    "metricsEnabled": {
                      "value": "[[parameters('metricsEnabled')]"
                    },
                    "logsEnabled": {
                      "value": "[[parameters('logsEnabled')]"
                    },
                    "profileName": {
                      "value": "[[parameters('profileName')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "apiVersion": "2019-09-01",
      "name": "5965D075FE067794EE545CBF4136CDA8",
      "properties": {
        "displayName": "Apply Diagnostic Settings for Microsoft.EventGrid/domains to a Regional Event Hub",
        "mode": "Indexed",
        "description": "This policy automatically deploys diagnostic settings to Apply Diagnostic Settings for Microsoft.EventGrid/domains to a Regional Event Hub.",
        "metadata": {
          "category": "Monitoring"
        },
        "parameters": {
          "profileName": {
            "type": "String",
            "metadata": {
              "displayName": "Profile Name for Config",
              "description": "The profile name Azure Diagnostics"
            }
          },
          "eventHubName": {
            "type": "String",
            "metadata": {
              "displayName": "EventHub Name",
              "description": "The event hub for Azure Diagnostics",
              "strongType": "Microsoft.EventHub/Namespaces/EventHubs",
              "assignPermissions": true
            }
          },
          "eventHubRuleId": {
            "type": "String",
            "metadata": {
              "displayName": "EventHubRuleID",
              "description": "The event hub RuleID for Azure Diagnostics",
              "strongType": "Microsoft.EventHub/Namespaces/AuthorizationRules",
              "assignPermissions": true
            }
          },
          "azureRegions": {
            "type": "Array",
            "metadata": {
              "displayName": "Allowed Locations",
              "description": "The list of locations that can be specified when deploying resources",
              "strongType": "location"
            }
          },
          "metricsEnabled": {
            "type": "String",
            "metadata": {
              "displayName": "Enable Metrics",
              "description": "Enable Metrics - True or False"
            },
            "allowedValues": [
              "True",
              "False"
            ],
            "defaultValue": "False"
          },
          "logsEnabled": {
            "type": "String",
            "metadata": {
              "displayName": "Enable Logs",
              "description": "Enable Logs - True or False"
            },
            "allowedValues": [
              "True",
              "False"
            ],
            "defaultValue": "True"
          }
        },
        "policyRule": {
          "if": {
            "allOf": [
              {
                "field": "type",
                "equals": "Microsoft.EventGrid/domains"
              },
              {
                "field": "location",
                "in": "[[parameters('azureRegions')]"
              }
            ]
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "existenceCondition": {
                "allOf": [
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/logs.enabled",
                    "equals": "[[parameters('logsEnabled')]"
                  },
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/metrics.enabled",
                    "equals": "[[parameters('metricsEnabled')]"
                  },
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/eventHubName",
                    "equals": "[[last(split(parameters('eventHubName'), '/'))]"
                  }
                ]
              },
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "name": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      },
                      "eventHubName": {
                        "type": "string"
                      },
                      "eventHubRuleId": {
                        "type": "string"
                      },
                      "metricsEnabled": {
                        "type": "string"
                      },
                      "logsEnabled": {
                        "type": "string"
                      },
                      "profileName": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.EventGrid/domains/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[[concat(parameters('name'), '/', 'Microsoft.Insights/', parameters('profileName'))]",
                        "location": "[[parameters('location')]",
                        "dependsOn": [],
                        "properties": {
                          "eventHubName": "[[last(split(parameters('eventHubName'), '/'))]",
                          "eventHubAuthorizationRuleId": "[[parameters('eventHubRuleId')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": "[[parameters('metricsEnabled')]",
                              "retentionPolicy": {
                                "enabled": false,
                                "days": 0
                              }
                            }
                          ],
                          "logs": [
                            {
                              "category": "DeliveryFailures",
                              "enabled": "[[parameters('logsEnabled')]"
                            },
                            {
                              "category": "PublishFailures",
                              "enabled": "[[parameters('logsEnabled')]"
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {
                      "policy": {
                        "type": "string",
                        "value": "[[concat(parameters('eventHubName'), 'configured for diagnostic logs for ', ': ', parameters('name'))]"
                      }
                    }
                  },
                  "parameters": {
                    "eventHubName": {
                      "value": "[[parameters('eventHubName')]"
                    },
                    "location": {
                      "value": "[[field('location')]"
                    },
                    "name": {
                      "value": "[[field('name')]"
                    },
                    "eventHubRuleId": {
                      "value": "[[parameters('eventHubRuleId')]"
                    },
                    "metricsEnabled": {
                      "value": "[[parameters('metricsEnabled')]"
                    },
                    "logsEnabled": {
                      "value": "[[parameters('logsEnabled')]"
                    },
                    "profileName": {
                      "value": "[[parameters('profileName')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "apiVersion": "2019-09-01",
      "name": "F89D4C3236F9777A19780ACDB5609E63",
      "properties": {
        "displayName": "Apply Diagnostic Settings for Microsoft.Network/frontdoors to a Regional Event Hub",
        "mode": "Indexed",
        "description": "This policy automatically deploys diagnostic settings to Apply Diagnostic Settings for Microsoft.Network/frontdoors to a Regional Event Hub.",
        "metadata": {
          "category": "Monitoring"
        },
        "parameters": {
          "profileName": {
            "type": "String",
            "metadata": {
              "displayName": "Profile Name for Config",
              "description": "The profile name Azure Diagnostics"
            }
          },
          "eventHubName": {
            "type": "String",
            "metadata": {
              "displayName": "EventHub Name",
              "description": "The event hub for Azure Diagnostics",
              "strongType": "Microsoft.EventHub/Namespaces/EventHubs",
              "assignPermissions": true
            }
          },
          "eventHubRuleId": {
            "type": "String",
            "metadata": {
              "displayName": "EventHubRuleID",
              "description": "The event hub RuleID for Azure Diagnostics",
              "strongType": "Microsoft.EventHub/Namespaces/AuthorizationRules",
              "assignPermissions": true
            }
          },
          "azureRegions": {
            "type": "Array",
            "metadata": {
              "displayName": "Allowed Locations",
              "description": "The list of locations that can be specified when deploying resources",
              "strongType": "location"
            }
          },
          "metricsEnabled": {
            "type": "String",
            "metadata": {
              "displayName": "Enable Metrics",
              "description": "Enable Metrics - True or False"
            },
            "allowedValues": [
              "True",
              "False"
            ],
            "defaultValue": "False"
          },
          "logsEnabled": {
            "type": "String",
            "metadata": {
              "displayName": "Enable Logs",
              "description": "Enable Logs - True or False"
            },
            "allowedValues": [
              "True",
              "False"
            ],
            "defaultValue": "True"
          }
        },
        "policyRule": {
          "if": {
            "allOf": [
              {
                "field": "type",
                "equals": "Microsoft.Network/frontdoors"
              },
              {
                "field": "location",
                "in": "[[parameters('azureRegions')]"
              }
            ]
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "existenceCondition": {
                "allOf": [
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/logs.enabled",
                    "equals": "[[parameters('logsEnabled')]"
                  },
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/metrics.enabled",
                    "equals": "[[parameters('metricsEnabled')]"
                  },
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/eventHubName",
                    "equals": "[[last(split(parameters('eventHubName'), '/'))]"
                  }
                ]
              },
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "name": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      },
                      "eventHubName": {
                        "type": "string"
                      },
                      "eventHubRuleId": {
                        "type": "string"
                      },
                      "metricsEnabled": {
                        "type": "string"
                      },
                      "logsEnabled": {
                        "type": "string"
                      },
                      "profileName": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.Network/frontdoors/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[[concat(parameters('name'), '/', 'Microsoft.Insights/', parameters('profileName'))]",
                        "location": "[[parameters('location')]",
                        "dependsOn": [],
                        "properties": {
                          "eventHubName": "[[last(split(parameters('eventHubName'), '/'))]",
                          "eventHubAuthorizationRuleId": "[[parameters('eventHubRuleId')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": "[[parameters('metricsEnabled')]",
                              "retentionPolicy": {
                                "enabled": false,
                                "days": 0
                              }
                            }
                          ],
                          "logs": [
                            {
                              "category": "FrontdoorAccessLog",
                              "enabled": "[[parameters('logsEnabled')]"
                            },
                            {
                              "category": "FrontdoorWebApplicationFirewallLog",
                              "enabled": "[[parameters('logsEnabled')]"
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {
                      "policy": {
                        "type": "string",
                        "value": "[[concat(parameters('eventHubName'), 'configured for diagnostic logs for ', ': ', parameters('name'))]"
                      }
                    }
                  },
                  "parameters": {
                    "eventHubName": {
                      "value": "[[parameters('eventHubName')]"
                    },
                    "location": {
                      "value": "[[field('location')]"
                    },
                    "name": {
                      "value": "[[field('name')]"
                    },
                    "eventHubRuleId": {
                      "value": "[[parameters('eventHubRuleId')]"
                    },
                    "metricsEnabled": {
                      "value": "[[parameters('metricsEnabled')]"
                    },
                    "logsEnabled": {
                      "value": "[[parameters('logsEnabled')]"
                    },
                    "profileName": {
                      "value": "[[parameters('profileName')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "apiVersion": "2019-09-01",
      "name": "A3128A03900A369FFB43922CE083A611",
      "properties": {
        "displayName": "Apply Diagnostic Settings for Microsoft.DataLakeAnalytics/accounts to a Regional Event Hub",
        "mode": "Indexed",
        "description": "This policy automatically deploys diagnostic settings to Apply Diagnostic Settings for Microsoft.DataLakeAnalytics/accounts to a Regional Event Hub.",
        "metadata": {
          "category": "Monitoring"
        },
        "parameters": {
          "profileName": {
            "type": "String",
            "metadata": {
              "displayName": "Profile Name for Config",
              "description": "The profile name Azure Diagnostics"
            }
          },
          "eventHubName": {
            "type": "String",
            "metadata": {
              "displayName": "EventHub Name",
              "description": "The event hub for Azure Diagnostics",
              "strongType": "Microsoft.EventHub/Namespaces/EventHubs",
              "assignPermissions": true
            }
          },
          "eventHubRuleId": {
            "type": "String",
            "metadata": {
              "displayName": "EventHubRuleID",
              "description": "The event hub RuleID for Azure Diagnostics",
              "strongType": "Microsoft.EventHub/Namespaces/AuthorizationRules",
              "assignPermissions": true
            }
          },
          "azureRegions": {
            "type": "Array",
            "metadata": {
              "displayName": "Allowed Locations",
              "description": "The list of locations that can be specified when deploying resources",
              "strongType": "location"
            }
          },
          "metricsEnabled": {
            "type": "String",
            "metadata": {
              "displayName": "Enable Metrics",
              "description": "Enable Metrics - True or False"
            },
            "allowedValues": [
              "True",
              "False"
            ],
            "defaultValue": "False"
          },
          "logsEnabled": {
            "type": "String",
            "metadata": {
              "displayName": "Enable Logs",
              "description": "Enable Logs - True or False"
            },
            "allowedValues": [
              "True",
              "False"
            ],
            "defaultValue": "True"
          }
        },
        "policyRule": {
          "if": {
            "allOf": [
              {
                "field": "type",
                "equals": "Microsoft.DataLakeAnalytics/accounts"
              },
              {
                "field": "location",
                "in": "[[parameters('azureRegions')]"
              }
            ]
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "existenceCondition": {
                "allOf": [
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/logs.enabled",
                    "equals": "[[parameters('logsEnabled')]"
                  },
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/metrics.enabled",
                    "equals": "[[parameters('metricsEnabled')]"
                  },
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/eventHubName",
                    "equals": "[[last(split(parameters('eventHubName'), '/'))]"
                  }
                ]
              },
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "name": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      },
                      "eventHubName": {
                        "type": "string"
                      },
                      "eventHubRuleId": {
                        "type": "string"
                      },
                      "metricsEnabled": {
                        "type": "string"
                      },
                      "logsEnabled": {
                        "type": "string"
                      },
                      "profileName": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.DataLakeAnalytics/accounts/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[[concat(parameters('name'), '/', 'Microsoft.Insights/', parameters('profileName'))]",
                        "location": "[[parameters('location')]",
                        "dependsOn": [],
                        "properties": {
                          "eventHubName": "[[last(split(parameters('eventHubName'), '/'))]",
                          "eventHubAuthorizationRuleId": "[[parameters('eventHubRuleId')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": "[[parameters('metricsEnabled')]",
                              "retentionPolicy": {
                                "enabled": false,
                                "days": 0
                              }
                            }
                          ],
                          "logs": [
                            {
                              "category": "Audit",
                              "enabled": "[[parameters('logsEnabled')]"
                            },
                            {
                              "category": "Requests",
                              "enabled": "[[parameters('logsEnabled')]"
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {
                      "policy": {
                        "type": "string",
                        "value": "[[concat(parameters('eventHubName'), 'configured for diagnostic logs for ', ': ', parameters('name'))]"
                      }
                    }
                  },
                  "parameters": {
                    "eventHubName": {
                      "value": "[[parameters('eventHubName')]"
                    },
                    "location": {
                      "value": "[[field('location')]"
                    },
                    "name": {
                      "value": "[[field('name')]"
                    },
                    "eventHubRuleId": {
                      "value": "[[parameters('eventHubRuleId')]"
                    },
                    "metricsEnabled": {
                      "value": "[[parameters('metricsEnabled')]"
                    },
                    "logsEnabled": {
                      "value": "[[parameters('logsEnabled')]"
                    },
                    "profileName": {
                      "value": "[[parameters('profileName')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "apiVersion": "2019-09-01",
      "name": "EF143C90CB8B0B640E21F94087B83FE7",
      "properties": {
        "displayName": "Apply Diagnostic Settings for Microsoft.DataLakeStore/accounts to a Regional Event Hub",
        "mode": "Indexed",
        "description": "This policy automatically deploys diagnostic settings to Apply Diagnostic Settings for Microsoft.DataLakeStore/accounts to a Regional Event Hub.",
        "metadata": {
          "category": "Monitoring"
        },
        "parameters": {
          "profileName": {
            "type": "String",
            "metadata": {
              "displayName": "Profile Name for Config",
              "description": "The profile name Azure Diagnostics"
            }
          },
          "eventHubName": {
            "type": "String",
            "metadata": {
              "displayName": "EventHub Name",
              "description": "The event hub for Azure Diagnostics",
              "strongType": "Microsoft.EventHub/Namespaces/EventHubs",
              "assignPermissions": true
            }
          },
          "eventHubRuleId": {
            "type": "String",
            "metadata": {
              "displayName": "EventHubRuleID",
              "description": "The event hub RuleID for Azure Diagnostics",
              "strongType": "Microsoft.EventHub/Namespaces/AuthorizationRules",
              "assignPermissions": true
            }
          },
          "azureRegions": {
            "type": "Array",
            "metadata": {
              "displayName": "Allowed Locations",
              "description": "The list of locations that can be specified when deploying resources",
              "strongType": "location"
            }
          },
          "metricsEnabled": {
            "type": "String",
            "metadata": {
              "displayName": "Enable Metrics",
              "description": "Enable Metrics - True or False"
            },
            "allowedValues": [
              "True",
              "False"
            ],
            "defaultValue": "False"
          },
          "logsEnabled": {
            "type": "String",
            "metadata": {
              "displayName": "Enable Logs",
              "description": "Enable Logs - True or False"
            },
            "allowedValues": [
              "True",
              "False"
            ],
            "defaultValue": "True"
          }
        },
        "policyRule": {
          "if": {
            "allOf": [
              {
                "field": "type",
                "equals": "Microsoft.DataLakeStore/accounts"
              },
              {
                "field": "location",
                "in": "[[parameters('azureRegions')]"
              }
            ]
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "existenceCondition": {
                "allOf": [
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/logs.enabled",
                    "equals": "[[parameters('logsEnabled')]"
                  },
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/metrics.enabled",
                    "equals": "[[parameters('metricsEnabled')]"
                  },
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/eventHubName",
                    "equals": "[[last(split(parameters('eventHubName'), '/'))]"
                  }
                ]
              },
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "name": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      },
                      "eventHubName": {
                        "type": "string"
                      },
                      "eventHubRuleId": {
                        "type": "string"
                      },
                      "metricsEnabled": {
                        "type": "string"
                      },
                      "logsEnabled": {
                        "type": "string"
                      },
                      "profileName": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.DataLakeStore/accounts/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[[concat(parameters('name'), '/', 'Microsoft.Insights/', parameters('profileName'))]",
                        "location": "[[parameters('location')]",
                        "dependsOn": [],
                        "properties": {
                          "eventHubName": "[[last(split(parameters('eventHubName'), '/'))]",
                          "eventHubAuthorizationRuleId": "[[parameters('eventHubRuleId')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": "[[parameters('metricsEnabled')]",
                              "retentionPolicy": {
                                "enabled": false,
                                "days": 0
                              }
                            }
                          ],
                          "logs": [
                            {
                              "category": "Audit",
                              "enabled": "[[parameters('logsEnabled')]"
                            },
                            {
                              "category": "Requests",
                              "enabled": "[[parameters('logsEnabled')]"
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {
                      "policy": {
                        "type": "string",
                        "value": "[[concat(parameters('eventHubName'), 'configured for diagnostic logs for ', ': ', parameters('name'))]"
                      }
                    }
                  },
                  "parameters": {
                    "eventHubName": {
                      "value": "[[parameters('eventHubName')]"
                    },
                    "location": {
                      "value": "[[field('location')]"
                    },
                    "name": {
                      "value": "[[field('name')]"
                    },
                    "eventHubRuleId": {
                      "value": "[[parameters('eventHubRuleId')]"
                    },
                    "metricsEnabled": {
                      "value": "[[parameters('metricsEnabled')]"
                    },
                    "logsEnabled": {
                      "value": "[[parameters('logsEnabled')]"
                    },
                    "profileName": {
                      "value": "[[parameters('profileName')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "apiVersion": "2019-09-01",
      "name": "E080480106E18A3623B6726D45430AA0",
      "properties": {
        "displayName": "Apply Diagnostic Settings for Microsoft.OperationalInsights/workspaces to a Regional Event Hub",
        "mode": "Indexed",
        "description": "This policy automatically deploys diagnostic settings to Apply Diagnostic Settings for Microsoft.OperationalInsights/workspaces to a Regional Event Hub.",
        "metadata": {
          "category": "Monitoring"
        },
        "parameters": {
          "profileName": {
            "type": "String",
            "metadata": {
              "displayName": "Profile Name for Config",
              "description": "The profile name Azure Diagnostics"
            }
          },
          "eventHubName": {
            "type": "String",
            "metadata": {
              "displayName": "EventHub Name",
              "description": "The event hub for Azure Diagnostics",
              "strongType": "Microsoft.EventHub/Namespaces/EventHubs",
              "assignPermissions": true
            }
          },
          "eventHubRuleId": {
            "type": "String",
            "metadata": {
              "displayName": "EventHubRuleID",
              "description": "The event hub RuleID for Azure Diagnostics",
              "strongType": "Microsoft.EventHub/Namespaces/AuthorizationRules",
              "assignPermissions": true
            }
          },
          "azureRegions": {
            "type": "Array",
            "metadata": {
              "displayName": "Allowed Locations",
              "description": "The list of locations that can be specified when deploying resources",
              "strongType": "location"
            }
          },
          "metricsEnabled": {
            "type": "String",
            "metadata": {
              "displayName": "Enable Metrics",
              "description": "Enable Metrics - True or False"
            },
            "allowedValues": [
              "True",
              "False"
            ],
            "defaultValue": "False"
          },
          "logsEnabled": {
            "type": "String",
            "metadata": {
              "displayName": "Enable Logs",
              "description": "Enable Logs - True or False"
            },
            "allowedValues": [
              "True",
              "False"
            ],
            "defaultValue": "True"
          }
        },
        "policyRule": {
          "if": {
            "allOf": [
              {
                "field": "type",
                "equals": "Microsoft.OperationalInsights/workspaces"
              },
              {
                "field": "location",
                "in": "[[parameters('azureRegions')]"
              }
            ]
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "existenceCondition": {
                "allOf": [
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/logs.enabled",
                    "equals": "[[parameters('logsEnabled')]"
                  },
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/metrics.enabled",
                    "equals": "[[parameters('metricsEnabled')]"
                  },
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/eventHubName",
                    "equals": "[[last(split(parameters('eventHubName'), '/'))]"
                  }
                ]
              },
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "name": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      },
                      "eventHubName": {
                        "type": "string"
                      },
                      "eventHubRuleId": {
                        "type": "string"
                      },
                      "metricsEnabled": {
                        "type": "string"
                      },
                      "logsEnabled": {
                        "type": "string"
                      },
                      "profileName": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.OperationalInsights/workspaces/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[[concat(parameters('name'), '/', 'Microsoft.Insights/', parameters('profileName'))]",
                        "location": "[[parameters('location')]",
                        "dependsOn": [],
                        "properties": {
                          "eventHubName": "[[last(split(parameters('eventHubName'), '/'))]",
                          "eventHubAuthorizationRuleId": "[[parameters('eventHubRuleId')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": "[[parameters('metricsEnabled')]",
                              "retentionPolicy": {
                                "enabled": false,
                                "days": 0
                              }
                            }
                          ],
                          "logs": [
                            {
                              "category": "Audit",
                              "enabled": "[[parameters('logsEnabled')]"
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {
                      "policy": {
                        "type": "string",
                        "value": "[[concat(parameters('eventHubName'), 'configured for diagnostic logs for ', ': ', parameters('name'))]"
                      }
                    }
                  },
                  "parameters": {
                    "eventHubName": {
                      "value": "[[parameters('eventHubName')]"
                    },
                    "location": {
                      "value": "[[field('location')]"
                    },
                    "name": {
                      "value": "[[field('name')]"
                    },
                    "eventHubRuleId": {
                      "value": "[[parameters('eventHubRuleId')]"
                    },
                    "metricsEnabled": {
                      "value": "[[parameters('metricsEnabled')]"
                    },
                    "logsEnabled": {
                      "value": "[[parameters('logsEnabled')]"
                    },
                    "profileName": {
                      "value": "[[parameters('profileName')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "apiVersion": "2019-09-01",
      "name": "2D10CC0C81FF15C71FABF5E5E6744F23",
      "properties": {
        "displayName": "Apply Diagnostic Settings for Microsoft.Network/loadBalancers to a Regional Event Hub",
        "mode": "Indexed",
        "description": "This policy automatically deploys diagnostic settings to Apply Diagnostic Settings for Microsoft.Network/loadBalancers to a Regional Event Hub.",
        "metadata": {
          "category": "Monitoring"
        },
        "parameters": {
          "profileName": {
            "type": "String",
            "metadata": {
              "displayName": "Profile Name for Config",
              "description": "The profile name Azure Diagnostics"
            }
          },
          "eventHubName": {
            "type": "String",
            "metadata": {
              "displayName": "EventHub Name",
              "description": "The event hub for Azure Diagnostics",
              "strongType": "Microsoft.EventHub/Namespaces/EventHubs",
              "assignPermissions": true
            }
          },
          "eventHubRuleId": {
            "type": "String",
            "metadata": {
              "displayName": "EventHubRuleID",
              "description": "The event hub RuleID for Azure Diagnostics",
              "strongType": "Microsoft.EventHub/Namespaces/AuthorizationRules",
              "assignPermissions": true
            }
          },
          "azureRegions": {
            "type": "Array",
            "metadata": {
              "displayName": "Allowed Locations",
              "description": "The list of locations that can be specified when deploying resources",
              "strongType": "location"
            }
          },
          "metricsEnabled": {
            "type": "String",
            "metadata": {
              "displayName": "Enable Metrics",
              "description": "Enable Metrics - True or False"
            },
            "allowedValues": [
              "True",
              "False"
            ],
            "defaultValue": "False"
          },
          "logsEnabled": {
            "type": "String",
            "metadata": {
              "displayName": "Enable Logs",
              "description": "Enable Logs - True or False"
            },
            "allowedValues": [
              "True",
              "False"
            ],
            "defaultValue": "True"
          }
        },
        "policyRule": {
          "if": {
            "allOf": [
              {
                "field": "type",
                "equals": "Microsoft.Network/loadBalancers"
              },
              {
                "field": "location",
                "in": "[[parameters('azureRegions')]"
              }
            ]
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "existenceCondition": {
                "allOf": [
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/logs.enabled",
                    "equals": "[[parameters('logsEnabled')]"
                  },
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/metrics.enabled",
                    "equals": "[[parameters('metricsEnabled')]"
                  },
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/eventHubName",
                    "equals": "[[last(split(parameters('eventHubName'), '/'))]"
                  }
                ]
              },
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "name": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      },
                      "eventHubName": {
                        "type": "string"
                      },
                      "eventHubRuleId": {
                        "type": "string"
                      },
                      "metricsEnabled": {
                        "type": "string"
                      },
                      "logsEnabled": {
                        "type": "string"
                      },
                      "profileName": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.Network/loadBalancers/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[[concat(parameters('name'), '/', 'Microsoft.Insights/', parameters('profileName'))]",
                        "location": "[[parameters('location')]",
                        "dependsOn": [],
                        "properties": {
                          "eventHubName": "[[last(split(parameters('eventHubName'), '/'))]",
                          "eventHubAuthorizationRuleId": "[[parameters('eventHubRuleId')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": "[[parameters('metricsEnabled')]",
                              "retentionPolicy": {
                                "enabled": false,
                                "days": 0
                              }
                            }
                          ],
                          "logs": [
                            {
                              "category": "LoadBalancerAlertEvent",
                              "enabled": "[[parameters('logsEnabled')]"
                            },
                            {
                              "category": "LoadBalancerProbeHealthStatus",
                              "enabled": "[[parameters('logsEnabled')]"
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {
                      "policy": {
                        "type": "string",
                        "value": "[[concat(parameters('eventHubName'), 'configured for diagnostic logs for ', ': ', parameters('name'))]"
                      }
                    }
                  },
                  "parameters": {
                    "eventHubName": {
                      "value": "[[parameters('eventHubName')]"
                    },
                    "location": {
                      "value": "[[field('location')]"
                    },
                    "name": {
                      "value": "[[field('name')]"
                    },
                    "eventHubRuleId": {
                      "value": "[[parameters('eventHubRuleId')]"
                    },
                    "metricsEnabled": {
                      "value": "[[parameters('metricsEnabled')]"
                    },
                    "logsEnabled": {
                      "value": "[[parameters('logsEnabled')]"
                    },
                    "profileName": {
                      "value": "[[parameters('profileName')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "apiVersion": "2019-09-01",
      "name": "359DED89E3ABEED5E2C8D7EB9B5204E4",
      "properties": {
        "displayName": "Apply Diagnostic Settings for Microsoft.Network/trafficmanagerprofiles to a Regional Event Hub",
        "mode": "Indexed",
        "description": "This policy automatically deploys diagnostic settings to Apply Diagnostic Settings for Microsoft.Network/trafficmanagerprofiles to a Regional Event Hub.",
        "metadata": {
          "category": "Monitoring"
        },
        "parameters": {
          "profileName": {
            "type": "String",
            "metadata": {
              "displayName": "Profile Name for Config",
              "description": "The profile name Azure Diagnostics"
            }
          },
          "eventHubName": {
            "type": "String",
            "metadata": {
              "displayName": "EventHub Name",
              "description": "The event hub for Azure Diagnostics",
              "strongType": "Microsoft.EventHub/Namespaces/EventHubs",
              "assignPermissions": true
            }
          },
          "eventHubRuleId": {
            "type": "String",
            "metadata": {
              "displayName": "EventHubRuleID",
              "description": "The event hub RuleID for Azure Diagnostics",
              "strongType": "Microsoft.EventHub/Namespaces/AuthorizationRules",
              "assignPermissions": true
            }
          },
          "azureRegions": {
            "type": "Array",
            "metadata": {
              "displayName": "Allowed Locations",
              "description": "The list of locations that can be specified when deploying resources",
              "strongType": "location"
            }
          },
          "metricsEnabled": {
            "type": "String",
            "metadata": {
              "displayName": "Enable Metrics",
              "description": "Enable Metrics - True or False"
            },
            "allowedValues": [
              "True",
              "False"
            ],
            "defaultValue": "False"
          },
          "logsEnabled": {
            "type": "String",
            "metadata": {
              "displayName": "Enable Logs",
              "description": "Enable Logs - True or False"
            },
            "allowedValues": [
              "True",
              "False"
            ],
            "defaultValue": "True"
          }
        },
        "policyRule": {
          "if": {
            "allOf": [
              {
                "field": "type",
                "equals": "Microsoft.Network/trafficmanagerprofiles"
              },
              {
                "field": "location",
                "in": "[[parameters('azureRegions')]"
              }
            ]
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "existenceCondition": {
                "allOf": [
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/logs.enabled",
                    "equals": "[[parameters('logsEnabled')]"
                  },
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/metrics.enabled",
                    "equals": "[[parameters('metricsEnabled')]"
                  },
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/eventHubName",
                    "equals": "[[last(split(parameters('eventHubName'), '/'))]"
                  }
                ]
              },
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "name": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      },
                      "eventHubName": {
                        "type": "string"
                      },
                      "eventHubRuleId": {
                        "type": "string"
                      },
                      "metricsEnabled": {
                        "type": "string"
                      },
                      "logsEnabled": {
                        "type": "string"
                      },
                      "profileName": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.Network/trafficmanagerprofiles/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[[concat(parameters('name'), '/', 'Microsoft.Insights/', parameters('profileName'))]",
                        "location": "[[parameters('location')]",
                        "dependsOn": [],
                        "properties": {
                          "eventHubName": "[[last(split(parameters('eventHubName'), '/'))]",
                          "eventHubAuthorizationRuleId": "[[parameters('eventHubRuleId')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": "[[parameters('metricsEnabled')]",
                              "retentionPolicy": {
                                "enabled": false,
                                "days": 0
                              }
                            }
                          ],
                          "logs": [
                            {
                              "category": "ProbeHealthStatusEvents",
                              "enabled": "[[parameters('logsEnabled')]"
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {
                      "policy": {
                        "type": "string",
                        "value": "[[concat(parameters('eventHubName'), 'configured for diagnostic logs for ', ': ', parameters('name'))]"
                      }
                    }
                  },
                  "parameters": {
                    "eventHubName": {
                      "value": "[[parameters('eventHubName')]"
                    },
                    "location": {
                      "value": "[[field('location')]"
                    },
                    "name": {
                      "value": "[[field('name')]"
                    },
                    "eventHubRuleId": {
                      "value": "[[parameters('eventHubRuleId')]"
                    },
                    "metricsEnabled": {
                      "value": "[[parameters('metricsEnabled')]"
                    },
                    "logsEnabled": {
                      "value": "[[parameters('logsEnabled')]"
                    },
                    "profileName": {
                      "value": "[[parameters('profileName')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "apiVersion": "2019-09-01",
      "name": "F3277E2FB064E33A0135173E8D3BEEBF",
      "properties": {
        "displayName": "Apply Diagnostic Settings for Microsoft.Network/virtualNetworkGateways to a Regional Event Hub",
        "mode": "Indexed",
        "description": "This policy automatically deploys diagnostic settings to Apply Diagnostic Settings for Microsoft.Network/virtualNetworkGateways to a Regional Event Hub.",
        "metadata": {
          "category": "Monitoring"
        },
        "parameters": {
          "profileName": {
            "type": "String",
            "metadata": {
              "displayName": "Profile Name for Config",
              "description": "The profile name Azure Diagnostics"
            }
          },
          "eventHubName": {
            "type": "String",
            "metadata": {
              "displayName": "EventHub Name",
              "description": "The event hub for Azure Diagnostics",
              "strongType": "Microsoft.EventHub/Namespaces/EventHubs",
              "assignPermissions": true
            }
          },
          "eventHubRuleId": {
            "type": "String",
            "metadata": {
              "displayName": "EventHubRuleID",
              "description": "The event hub RuleID for Azure Diagnostics",
              "strongType": "Microsoft.EventHub/Namespaces/AuthorizationRules",
              "assignPermissions": true
            }
          },
          "azureRegions": {
            "type": "Array",
            "metadata": {
              "displayName": "Allowed Locations",
              "description": "The list of locations that can be specified when deploying resources",
              "strongType": "location"
            }
          },
          "metricsEnabled": {
            "type": "String",
            "metadata": {
              "displayName": "Enable Metrics",
              "description": "Enable Metrics - True or False"
            },
            "allowedValues": [
              "True",
              "False"
            ],
            "defaultValue": "False"
          },
          "logsEnabled": {
            "type": "String",
            "metadata": {
              "displayName": "Enable Logs",
              "description": "Enable Logs - True or False"
            },
            "allowedValues": [
              "True",
              "False"
            ],
            "defaultValue": "True"
          }
        },
        "policyRule": {
          "if": {
            "allOf": [
              {
                "field": "type",
                "equals": "Microsoft.Network/virtualNetworkGateways"
              },
              {
                "field": "location",
                "in": "[[parameters('azureRegions')]"
              }
            ]
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "existenceCondition": {
                "allOf": [
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/logs.enabled",
                    "equals": "[[parameters('logsEnabled')]"
                  },
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/metrics.enabled",
                    "equals": "[[parameters('metricsEnabled')]"
                  },
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/eventHubName",
                    "equals": "[[last(split(parameters('eventHubName'), '/'))]"
                  }
                ]
              },
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "name": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      },
                      "eventHubName": {
                        "type": "string"
                      },
                      "eventHubRuleId": {
                        "type": "string"
                      },
                      "metricsEnabled": {
                        "type": "string"
                      },
                      "logsEnabled": {
                        "type": "string"
                      },
                      "profileName": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.Network/virtualNetworkGateways/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[[concat(parameters('name'), '/', 'Microsoft.Insights/', parameters('profileName'))]",
                        "location": "[[parameters('location')]",
                        "dependsOn": [],
                        "properties": {
                          "eventHubName": "[[last(split(parameters('eventHubName'), '/'))]",
                          "eventHubAuthorizationRuleId": "[[parameters('eventHubRuleId')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": "[[parameters('metricsEnabled')]",
                              "retentionPolicy": {
                                "enabled": false,
                                "days": 0
                              }
                            }
                          ],
                          "logs": [
                            {
                              "category": "GatewayDiagnosticLog",
                              "enabled": "[[parameters('logsEnabled')]"
                            },
                            {
                              "category": "TunnelDiagnosticLog",
                              "enabled": "[[parameters('logsEnabled')]"
                            },
                            {
                              "category": "RouteDiagnosticLog",
                              "enabled": "[[parameters('logsEnabled')]"
                            },
                            {
                              "category": "IKEDiagnosticLog",
                              "enabled": "[[parameters('logsEnabled')]"
                            },
                            {
                              "category": "P2SDiagnosticLog",
                              "enabled": "[[parameters('logsEnabled')]"
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {
                      "policy": {
                        "type": "string",
                        "value": "[[concat(parameters('eventHubName'), 'configured for diagnostic logs for ', ': ', parameters('name'))]"
                      }
                    }
                  },
                  "parameters": {
                    "eventHubName": {
                      "value": "[[parameters('eventHubName')]"
                    },
                    "location": {
                      "value": "[[field('location')]"
                    },
                    "name": {
                      "value": "[[field('name')]"
                    },
                    "eventHubRuleId": {
                      "value": "[[parameters('eventHubRuleId')]"
                    },
                    "metricsEnabled": {
                      "value": "[[parameters('metricsEnabled')]"
                    },
                    "logsEnabled": {
                      "value": "[[parameters('logsEnabled')]"
                    },
                    "profileName": {
                      "value": "[[parameters('profileName')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "apiVersion": "2019-09-01",
      "name": "93DFDF408A9A1AB7F070C9C0DB4C9A22",
      "properties": {
        "displayName": "Apply Diagnostic Settings for Microsoft.ServiceBus/namespaces to a Regional Event Hub",
        "mode": "Indexed",
        "description": "This policy automatically deploys diagnostic settings to Apply Diagnostic Settings for Microsoft.ServiceBus/namespaces to a Regional Event Hub.",
        "metadata": {
          "category": "Monitoring"
        },
        "parameters": {
          "profileName": {
            "type": "String",
            "metadata": {
              "displayName": "Profile Name for Config",
              "description": "The profile name Azure Diagnostics"
            }
          },
          "eventHubName": {
            "type": "String",
            "metadata": {
              "displayName": "EventHub Name",
              "description": "The event hub for Azure Diagnostics",
              "strongType": "Microsoft.EventHub/Namespaces/EventHubs",
              "assignPermissions": true
            }
          },
          "eventHubRuleId": {
            "type": "String",
            "metadata": {
              "displayName": "EventHubRuleID",
              "description": "The event hub RuleID for Azure Diagnostics",
              "strongType": "Microsoft.EventHub/Namespaces/AuthorizationRules",
              "assignPermissions": true
            }
          },
          "azureRegions": {
            "type": "Array",
            "metadata": {
              "displayName": "Allowed Locations",
              "description": "The list of locations that can be specified when deploying resources",
              "strongType": "location"
            }
          },
          "metricsEnabled": {
            "type": "String",
            "metadata": {
              "displayName": "Enable Metrics",
              "description": "Enable Metrics - True or False"
            },
            "allowedValues": [
              "True",
              "False"
            ],
            "defaultValue": "False"
          },
          "logsEnabled": {
            "type": "String",
            "metadata": {
              "displayName": "Enable Logs",
              "description": "Enable Logs - True or False"
            },
            "allowedValues": [
              "True",
              "False"
            ],
            "defaultValue": "True"
          }
        },
        "policyRule": {
          "if": {
            "allOf": [
              {
                "field": "type",
                "equals": "Microsoft.ServiceBus/namespaces"
              },
              {
                "field": "location",
                "in": "[[parameters('azureRegions')]"
              }
            ]
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "existenceCondition": {
                "allOf": [
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/logs.enabled",
                    "equals": "[[parameters('logsEnabled')]"
                  },
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/metrics.enabled",
                    "equals": "[[parameters('metricsEnabled')]"
                  },
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/eventHubName",
                    "equals": "[[last(split(parameters('eventHubName'), '/'))]"
                  }
                ]
              },
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "name": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      },
                      "eventHubName": {
                        "type": "string"
                      },
                      "eventHubRuleId": {
                        "type": "string"
                      },
                      "metricsEnabled": {
                        "type": "string"
                      },
                      "logsEnabled": {
                        "type": "string"
                      },
                      "profileName": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.ServiceBus/namespaces/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[[concat(parameters('name'), '/', 'Microsoft.Insights/', parameters('profileName'))]",
                        "location": "[[parameters('location')]",
                        "dependsOn": [],
                        "properties": {
                          "eventHubName": "[[last(split(parameters('eventHubName'), '/'))]",
                          "eventHubAuthorizationRuleId": "[[parameters('eventHubRuleId')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": "[[parameters('metricsEnabled')]",
                              "retentionPolicy": {
                                "enabled": false,
                                "days": 0
                              }
                            }
                          ],
                          "logs": [
                            {
                              "category": "OperationalLogs",
                              "enabled": "[[parameters('logsEnabled')]"
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {
                      "policy": {
                        "type": "string",
                        "value": "[[concat(parameters('eventHubName'), 'configured for diagnostic logs for ', ': ', parameters('name'))]"
                      }
                    }
                  },
                  "parameters": {
                    "eventHubName": {
                      "value": "[[parameters('eventHubName')]"
                    },
                    "location": {
                      "value": "[[field('location')]"
                    },
                    "name": {
                      "value": "[[field('name')]"
                    },
                    "eventHubRuleId": {
                      "value": "[[parameters('eventHubRuleId')]"
                    },
                    "metricsEnabled": {
                      "value": "[[parameters('metricsEnabled')]"
                    },
                    "logsEnabled": {
                      "value": "[[parameters('logsEnabled')]"
                    },
                    "profileName": {
                      "value": "[[parameters('profileName')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "apiVersion": "2019-09-01",
      "name": "7FFAF04894D0815AE0923A5ABC1EF27C",
      "properties": {
        "displayName": "Apply Diagnostic Settings for Microsoft.Sql/servers/databases (v12.0,user,vcore,serverless) to a Regional Event Hub",
        "mode": "Indexed",
        "description": "This policy automatically deploys diagnostic settings to Apply Diagnostic Settings for Microsoft.Sql/servers/databases (v12.0,user,vcore,serverless) to a Regional Event Hub.",
        "metadata": {
          "category": "Monitoring"
        },
        "parameters": {
          "profileName": {
            "type": "String",
            "metadata": {
              "displayName": "Profile Name for Config",
              "description": "The profile name Azure Diagnostics"
            }
          },
          "eventHubName": {
            "type": "String",
            "metadata": {
              "displayName": "EventHub Name",
              "description": "The event hub for Azure Diagnostics",
              "strongType": "Microsoft.EventHub/Namespaces/EventHubs",
              "assignPermissions": true
            }
          },
          "eventHubRuleId": {
            "type": "String",
            "metadata": {
              "displayName": "EventHubRuleID",
              "description": "The event hub RuleID for Azure Diagnostics",
              "strongType": "Microsoft.EventHub/Namespaces/AuthorizationRules",
              "assignPermissions": true
            }
          },
          "azureRegions": {
            "type": "Array",
            "metadata": {
              "displayName": "Allowed Locations",
              "description": "The list of locations that can be specified when deploying resources",
              "strongType": "location"
            }
          },
          "metricsEnabled": {
            "type": "String",
            "metadata": {
              "displayName": "Enable Metrics",
              "description": "Enable Metrics - True or False"
            },
            "allowedValues": [
              "True",
              "False"
            ],
            "defaultValue": "False"
          },
          "logsEnabled": {
            "type": "String",
            "metadata": {
              "displayName": "Enable Logs",
              "description": "Enable Logs - True or False"
            },
            "allowedValues": [
              "True",
              "False"
            ],
            "defaultValue": "True"
          }
        },
        "policyRule": {
          "if": {
            "allOf": [
              {
                "field": "type",
                "equals": "Microsoft.Sql/servers/databases"
              },
              {
                "field": "location",
                "in": "[[parameters('azureRegions')]"
              },
              {
                "field": "kind",
                "equals": "v12.0,user,vcore,serverless"
              }
            ]
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "existenceCondition": {
                "allOf": [
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/logs.enabled",
                    "equals": "[[parameters('logsEnabled')]"
                  },
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/metrics.enabled",
                    "equals": "[[parameters('metricsEnabled')]"
                  },
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/eventHubName",
                    "equals": "[[last(split(parameters('eventHubName'), '/'))]"
                  }
                ]
              },
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "name": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      },
                      "eventHubName": {
                        "type": "string"
                      },
                      "eventHubRuleId": {
                        "type": "string"
                      },
                      "metricsEnabled": {
                        "type": "string"
                      },
                      "logsEnabled": {
                        "type": "string"
                      },
                      "profileName": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.Sql/servers/databases/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[[concat(parameters('name'), '/', 'Microsoft.Insights/', parameters('profileName'))]",
                        "location": "[[parameters('location')]",
                        "dependsOn": [],
                        "properties": {
                          "eventHubName": "[[last(split(parameters('eventHubName'), '/'))]",
                          "eventHubAuthorizationRuleId": "[[parameters('eventHubRuleId')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": "[[parameters('metricsEnabled')]",
                              "retentionPolicy": {
                                "enabled": false,
                                "days": 0
                              }
                            }
                          ],
                          "logs": [
                            {
                              "category": "SQLInsights",
                              "enabled": "[[parameters('logsEnabled')]"
                            },
                            {
                              "category": "AutomaticTuning",
                              "enabled": "[[parameters('logsEnabled')]"
                            },
                            {
                              "category": "QueryStoreRuntimeStatistics",
                              "enabled": "[[parameters('logsEnabled')]"
                            },
                            {
                              "category": "QueryStoreWaitStatistics",
                              "enabled": "[[parameters('logsEnabled')]"
                            },
                            {
                              "category": "Errors",
                              "enabled": "[[parameters('logsEnabled')]"
                            },
                            {
                              "category": "DatabaseWaitStatistics",
                              "enabled": "[[parameters('logsEnabled')]"
                            },
                            {
                              "category": "Timeouts",
                              "enabled": "[[parameters('logsEnabled')]"
                            },
                            {
                              "category": "Blocks",
                              "enabled": "[[parameters('logsEnabled')]"
                            },
                            {
                              "category": "Deadlocks",
                              "enabled": "[[parameters('logsEnabled')]"
                            },
                            {
                              "category": "DevOpsOperationsAudit",
                              "enabled": "[[parameters('logsEnabled')]"
                            },
                            {
                              "category": "SQLSecurityAuditEvents",
                              "enabled": "[[parameters('logsEnabled')]"
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {
                      "policy": {
                        "type": "string",
                        "value": "[[concat(parameters('eventHubName'), 'configured for diagnostic logs for ', ': ', parameters('name'))]"
                      }
                    }
                  },
                  "parameters": {
                    "eventHubName": {
                      "value": "[[parameters('eventHubName')]"
                    },
                    "location": {
                      "value": "[[field('location')]"
                    },
                    "name": {
                      "value": "[[field('fullName')]"
                    },
                    "eventHubRuleId": {
                      "value": "[[parameters('eventHubRuleId')]"
                    },
                    "metricsEnabled": {
                      "value": "[[parameters('metricsEnabled')]"
                    },
                    "logsEnabled": {
                      "value": "[[parameters('logsEnabled')]"
                    },
                    "profileName": {
                      "value": "[[parameters('profileName')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "apiVersion": "2019-09-01",
      "name": "893A4561A0AB741FCBAE5B13C5FF66DD",
      "properties": {
        "displayName": "Apply Diagnostic Settings for Microsoft.Web/sites (app) to a Regional Event Hub",
        "mode": "Indexed",
        "description": "This policy automatically deploys diagnostic settings to Apply Diagnostic Settings for Microsoft.Web/sites (app) to a Regional Event Hub.",
        "metadata": {
          "category": "Monitoring"
        },
        "parameters": {
          "profileName": {
            "type": "String",
            "metadata": {
              "displayName": "Profile Name for Config",
              "description": "The profile name Azure Diagnostics"
            }
          },
          "eventHubName": {
            "type": "String",
            "metadata": {
              "displayName": "EventHub Name",
              "description": "The event hub for Azure Diagnostics",
              "strongType": "Microsoft.EventHub/Namespaces/EventHubs",
              "assignPermissions": true
            }
          },
          "eventHubRuleId": {
            "type": "String",
            "metadata": {
              "displayName": "EventHubRuleID",
              "description": "The event hub RuleID for Azure Diagnostics",
              "strongType": "Microsoft.EventHub/Namespaces/AuthorizationRules",
              "assignPermissions": true
            }
          },
          "azureRegions": {
            "type": "Array",
            "metadata": {
              "displayName": "Allowed Locations",
              "description": "The list of locations that can be specified when deploying resources",
              "strongType": "location"
            }
          },
          "metricsEnabled": {
            "type": "String",
            "metadata": {
              "displayName": "Enable Metrics",
              "description": "Enable Metrics - True or False"
            },
            "allowedValues": [
              "True",
              "False"
            ],
            "defaultValue": "False"
          },
          "logsEnabled": {
            "type": "String",
            "metadata": {
              "displayName": "Enable Logs",
              "description": "Enable Logs - True or False"
            },
            "allowedValues": [
              "True",
              "False"
            ],
            "defaultValue": "True"
          }
        },
        "policyRule": {
          "if": {
            "allOf": [
              {
                "field": "type",
                "equals": "Microsoft.Web/sites"
              },
              {
                "field": "location",
                "in": "[[parameters('azureRegions')]"
              }
            ]
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "existenceCondition": {
                "allOf": [
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/logs.enabled",
                    "equals": "[[parameters('logsEnabled')]"
                  },
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/metrics.enabled",
                    "equals": "[[parameters('metricsEnabled')]"
                  },
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/eventHubName",
                    "equals": "[[last(split(parameters('eventHubName'), '/'))]"
                  }
                ]
              },
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "name": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      },
                      "eventHubName": {
                        "type": "string"
                      },
                      "eventHubRuleId": {
                        "type": "string"
                      },
                      "metricsEnabled": {
                        "type": "string"
                      },
                      "logsEnabled": {
                        "type": "string"
                      },
                      "profileName": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.Web/sites/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[[concat(parameters('name'), '/', 'Microsoft.Insights/', parameters('profileName'))]",
                        "location": "[[parameters('location')]",
                        "dependsOn": [],
                        "properties": {
                          "eventHubName": "[[last(split(parameters('eventHubName'), '/'))]",
                          "eventHubAuthorizationRuleId": "[[parameters('eventHubRuleId')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": "[[parameters('metricsEnabled')]",
                              "retentionPolicy": {
                                "enabled": false,
                                "days": 0
                              }
                            }
                          ],
                          "logs": [
                            {
                              "category": "AppServiceAntivirusScanAuditLogs",
                              "enabled": "[[parameters('logsEnabled')]"
                            },
                            {
                              "category": "AppServiceHTTPLogs",
                              "enabled": "[[parameters('logsEnabled')]"
                            },
                            {
                              "category": "AppServiceConsoleLogs",
                              "enabled": "[[parameters('logsEnabled')]"
                            },
                            {
                              "category": "AppServiceAppLogs",
                              "enabled": "[[parameters('logsEnabled')]"
                            },
                            {
                              "category": "AppServiceFileAuditLogs",
                              "enabled": "[[parameters('logsEnabled')]"
                            },
                            {
                              "category": "AppServiceAuditLogs",
                              "enabled": "[[parameters('logsEnabled')]"
                            },
                            {
                              "category": "AppServiceIPSecAuditLogs",
                              "enabled": "[[parameters('logsEnabled')]"
                            },
                            {
                              "category": "AppServicePlatformLogs",
                              "enabled": "[[parameters('logsEnabled')]"
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {
                      "policy": {
                        "type": "string",
                        "value": "[[concat(parameters('eventHubName'), 'configured for diagnostic logs for ', ': ', parameters('name'))]"
                      }
                    }
                  },
                  "parameters": {
                    "eventHubName": {
                      "value": "[[parameters('eventHubName')]"
                    },
                    "location": {
                      "value": "[[field('location')]"
                    },
                    "name": {
                      "value": "[[field('name')]"
                    },
                    "eventHubRuleId": {
                      "value": "[[parameters('eventHubRuleId')]"
                    },
                    "metricsEnabled": {
                      "value": "[[parameters('metricsEnabled')]"
                    },
                    "logsEnabled": {
                      "value": "[[parameters('logsEnabled')]"
                    },
                    "profileName": {
                      "value": "[[parameters('profileName')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "apiVersion": "2019-09-01",
      "name": "B10BBE9EE398B5E5B597C31A01D5EEC0",
      "properties": {
        "displayName": "Apply Diagnostic Settings for Microsoft.DBforMySQL/servers to a Regional Event Hub",
        "mode": "Indexed",
        "description": "This policy automatically deploys diagnostic settings to Apply Diagnostic Settings for Microsoft.DBforMySQL/servers to a Regional Event Hub.",
        "metadata": {
          "category": "Monitoring"
        },
        "parameters": {
          "profileName": {
            "type": "String",
            "metadata": {
              "displayName": "Profile Name for Config",
              "description": "The profile name Azure Diagnostics"
            }
          },
          "eventHubName": {
            "type": "String",
            "metadata": {
              "displayName": "EventHub Name",
              "description": "The event hub for Azure Diagnostics",
              "strongType": "Microsoft.EventHub/Namespaces/EventHubs",
              "assignPermissions": true
            }
          },
          "eventHubRuleId": {
            "type": "String",
            "metadata": {
              "displayName": "EventHubRuleID",
              "description": "The event hub RuleID for Azure Diagnostics",
              "strongType": "Microsoft.EventHub/Namespaces/AuthorizationRules",
              "assignPermissions": true
            }
          },
          "azureRegions": {
            "type": "Array",
            "metadata": {
              "displayName": "Allowed Locations",
              "description": "The list of locations that can be specified when deploying resources",
              "strongType": "location"
            }
          },
          "metricsEnabled": {
            "type": "String",
            "metadata": {
              "displayName": "Enable Metrics",
              "description": "Enable Metrics - True or False"
            },
            "allowedValues": [
              "True",
              "False"
            ],
            "defaultValue": "False"
          },
          "logsEnabled": {
            "type": "String",
            "metadata": {
              "displayName": "Enable Logs",
              "description": "Enable Logs - True or False"
            },
            "allowedValues": [
              "True",
              "False"
            ],
            "defaultValue": "True"
          }
        },
        "policyRule": {
          "if": {
            "allOf": [
              {
                "field": "type",
                "equals": "Microsoft.DBforMySQL/servers"
              },
              {
                "field": "location",
                "in": "[[parameters('azureRegions')]"
              }
            ]
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "existenceCondition": {
                "allOf": [
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/logs.enabled",
                    "equals": "[[parameters('logsEnabled')]"
                  },
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/metrics.enabled",
                    "equals": "[[parameters('metricsEnabled')]"
                  },
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/eventHubName",
                    "equals": "[[last(split(parameters('eventHubName'), '/'))]"
                  }
                ]
              },
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "name": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      },
                      "eventHubName": {
                        "type": "string"
                      },
                      "eventHubRuleId": {
                        "type": "string"
                      },
                      "metricsEnabled": {
                        "type": "string"
                      },
                      "logsEnabled": {
                        "type": "string"
                      },
                      "profileName": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.DBforMySQL/servers/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[[concat(parameters('name'), '/', 'Microsoft.Insights/', parameters('profileName'))]",
                        "location": "[[parameters('location')]",
                        "dependsOn": [],
                        "properties": {
                          "eventHubName": "[[last(split(parameters('eventHubName'), '/'))]",
                          "eventHubAuthorizationRuleId": "[[parameters('eventHubRuleId')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": "[[parameters('metricsEnabled')]",
                              "retentionPolicy": {
                                "enabled": false,
                                "days": 0
                              }
                            }
                          ],
                          "logs": [
                            {
                              "category": "MySqlSlowLogs",
                              "enabled": "[[parameters('logsEnabled')]"
                            },
                            {
                              "category": "MySqlAuditLogs",
                              "enabled": "[[parameters('logsEnabled')]"
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {
                      "policy": {
                        "type": "string",
                        "value": "[[concat(parameters('eventHubName'), 'configured for diagnostic logs for ', ': ', parameters('name'))]"
                      }
                    }
                  },
                  "parameters": {
                    "eventHubName": {
                      "value": "[[parameters('eventHubName')]"
                    },
                    "location": {
                      "value": "[[field('location')]"
                    },
                    "name": {
                      "value": "[[field('name')]"
                    },
                    "eventHubRuleId": {
                      "value": "[[parameters('eventHubRuleId')]"
                    },
                    "metricsEnabled": {
                      "value": "[[parameters('metricsEnabled')]"
                    },
                    "logsEnabled": {
                      "value": "[[parameters('logsEnabled')]"
                    },
                    "profileName": {
                      "value": "[[parameters('profileName')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "apiVersion": "2019-09-01",
      "name": "A510638DE8DA10CCE40FA86A9653337B",
      "properties": {
        "displayName": "Apply Diagnostic Settings for microsoft.insights/autoscalesettings to a Regional Event Hub",
        "mode": "Indexed",
        "description": "This policy automatically deploys diagnostic settings to Apply Diagnostic Settings for microsoft.insights/autoscalesettings to a Regional Event Hub.",
        "metadata": {
          "category": "Monitoring"
        },
        "parameters": {
          "profileName": {
            "type": "String",
            "metadata": {
              "displayName": "Profile Name for Config",
              "description": "The profile name Azure Diagnostics"
            }
          },
          "eventHubName": {
            "type": "String",
            "metadata": {
              "displayName": "EventHub Name",
              "description": "The event hub for Azure Diagnostics",
              "strongType": "Microsoft.EventHub/Namespaces/EventHubs",
              "assignPermissions": true
            }
          },
          "eventHubRuleId": {
            "type": "String",
            "metadata": {
              "displayName": "EventHubRuleID",
              "description": "The event hub RuleID for Azure Diagnostics",
              "strongType": "Microsoft.EventHub/Namespaces/AuthorizationRules",
              "assignPermissions": true
            }
          },
          "azureRegions": {
            "type": "Array",
            "metadata": {
              "displayName": "Allowed Locations",
              "description": "The list of locations that can be specified when deploying resources",
              "strongType": "location"
            }
          },
          "metricsEnabled": {
            "type": "String",
            "metadata": {
              "displayName": "Enable Metrics",
              "description": "Enable Metrics - True or False"
            },
            "allowedValues": [
              "True",
              "False"
            ],
            "defaultValue": "False"
          },
          "logsEnabled": {
            "type": "String",
            "metadata": {
              "displayName": "Enable Logs",
              "description": "Enable Logs - True or False"
            },
            "allowedValues": [
              "True",
              "False"
            ],
            "defaultValue": "True"
          }
        },
        "policyRule": {
          "if": {
            "allOf": [
              {
                "field": "type",
                "equals": "microsoft.insights/autoscalesettings"
              },
              {
                "field": "location",
                "in": "[[parameters('azureRegions')]"
              }
            ]
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "existenceCondition": {
                "allOf": [
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/logs.enabled",
                    "equals": "[[parameters('logsEnabled')]"
                  },
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/metrics.enabled",
                    "equals": "[[parameters('metricsEnabled')]"
                  },
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/eventHubName",
                    "equals": "[[last(split(parameters('eventHubName'), '/'))]"
                  }
                ]
              },
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "name": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      },
                      "eventHubName": {
                        "type": "string"
                      },
                      "eventHubRuleId": {
                        "type": "string"
                      },
                      "metricsEnabled": {
                        "type": "string"
                      },
                      "logsEnabled": {
                        "type": "string"
                      },
                      "profileName": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "microsoft.insights/autoscalesettings/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[[concat(parameters('name'), '/', 'Microsoft.Insights/', parameters('profileName'))]",
                        "location": "[[parameters('location')]",
                        "dependsOn": [],
                        "properties": {
                          "eventHubName": "[[last(split(parameters('eventHubName'), '/'))]",
                          "eventHubAuthorizationRuleId": "[[parameters('eventHubRuleId')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": "[[parameters('metricsEnabled')]",
                              "retentionPolicy": {
                                "enabled": false,
                                "days": 0
                              }
                            }
                          ],
                          "logs": [
                            {
                              "category": "AutoscaleEvaluations",
                              "enabled": "[[parameters('logsEnabled')]"
                            },
                            {
                              "category": "AutoscaleScaleActions",
                              "enabled": "[[parameters('logsEnabled')]"
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {
                      "policy": {
                        "type": "string",
                        "value": "[[concat(parameters('eventHubName'), 'configured for diagnostic logs for ', ': ', parameters('name'))]"
                      }
                    }
                  },
                  "parameters": {
                    "eventHubName": {
                      "value": "[[parameters('eventHubName')]"
                    },
                    "location": {
                      "value": "[[field('location')]"
                    },
                    "name": {
                      "value": "[[field('name')]"
                    },
                    "eventHubRuleId": {
                      "value": "[[parameters('eventHubRuleId')]"
                    },
                    "metricsEnabled": {
                      "value": "[[parameters('metricsEnabled')]"
                    },
                    "logsEnabled": {
                      "value": "[[parameters('logsEnabled')]"
                    },
                    "profileName": {
                      "value": "[[parameters('profileName')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "apiVersion": "2019-09-01",
      "name": "C8586D4AF28A1CEC8539D9FCE8F59B71",
      "properties": {
        "displayName": "Apply Diagnostic Settings for Microsoft.ContainerService/managedClusters to a Regional Event Hub",
        "mode": "Indexed",
        "description": "This policy automatically deploys diagnostic settings to Apply Diagnostic Settings for Microsoft.ContainerService/managedClusters to a Regional Event Hub.",
        "metadata": {
          "category": "Monitoring"
        },
        "parameters": {
          "profileName": {
            "type": "String",
            "metadata": {
              "displayName": "Profile Name for Config",
              "description": "The profile name Azure Diagnostics"
            }
          },
          "eventHubName": {
            "type": "String",
            "metadata": {
              "displayName": "EventHub Name",
              "description": "The event hub for Azure Diagnostics",
              "strongType": "Microsoft.EventHub/Namespaces/EventHubs",
              "assignPermissions": true
            }
          },
          "eventHubRuleId": {
            "type": "String",
            "metadata": {
              "displayName": "EventHubRuleID",
              "description": "The event hub RuleID for Azure Diagnostics",
              "strongType": "Microsoft.EventHub/Namespaces/AuthorizationRules",
              "assignPermissions": true
            }
          },
          "azureRegions": {
            "type": "Array",
            "metadata": {
              "displayName": "Allowed Locations",
              "description": "The list of locations that can be specified when deploying resources",
              "strongType": "location"
            }
          },
          "metricsEnabled": {
            "type": "String",
            "metadata": {
              "displayName": "Enable Metrics",
              "description": "Enable Metrics - True or False"
            },
            "allowedValues": [
              "True",
              "False"
            ],
            "defaultValue": "False"
          },
          "logsEnabled": {
            "type": "String",
            "metadata": {
              "displayName": "Enable Logs",
              "description": "Enable Logs - True or False"
            },
            "allowedValues": [
              "True",
              "False"
            ],
            "defaultValue": "True"
          }
        },
        "policyRule": {
          "if": {
            "allOf": [
              {
                "field": "type",
                "equals": "Microsoft.ContainerService/managedClusters"
              },
              {
                "field": "location",
                "in": "[[parameters('azureRegions')]"
              }
            ]
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "existenceCondition": {
                "allOf": [
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/logs.enabled",
                    "equals": "[[parameters('logsEnabled')]"
                  },
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/metrics.enabled",
                    "equals": "[[parameters('metricsEnabled')]"
                  },
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/eventHubName",
                    "equals": "[[last(split(parameters('eventHubName'), '/'))]"
                  }
                ]
              },
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "name": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      },
                      "eventHubName": {
                        "type": "string"
                      },
                      "eventHubRuleId": {
                        "type": "string"
                      },
                      "metricsEnabled": {
                        "type": "string"
                      },
                      "logsEnabled": {
                        "type": "string"
                      },
                      "profileName": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.ContainerService/managedClusters/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[[concat(parameters('name'), '/', 'Microsoft.Insights/', parameters('profileName'))]",
                        "location": "[[parameters('location')]",
                        "dependsOn": [],
                        "properties": {
                          "eventHubName": "[[last(split(parameters('eventHubName'), '/'))]",
                          "eventHubAuthorizationRuleId": "[[parameters('eventHubRuleId')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": "[[parameters('metricsEnabled')]",
                              "retentionPolicy": {
                                "enabled": false,
                                "days": 0
                              }
                            }
                          ],
                          "logs": [
                            {
                              "category": "kube-apiserver",
                              "enabled": "[[parameters('logsEnabled')]"
                            },
                            {
                              "category": "kube-audit",
                              "enabled": "[[parameters('logsEnabled')]"
                            },
                            {
                              "category": "kube-audit-admin",
                              "enabled": "[[parameters('logsEnabled')]"
                            },
                            {
                              "category": "kube-controller-manager",
                              "enabled": "[[parameters('logsEnabled')]"
                            },
                            {
                              "category": "kube-scheduler",
                              "enabled": "[[parameters('logsEnabled')]"
                            },
                            {
                              "category": "cluster-autoscaler",
                              "enabled": "[[parameters('logsEnabled')]"
                            },
                            {
                              "category": "guard",
                              "enabled": "[[parameters('logsEnabled')]"
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {
                      "policy": {
                        "type": "string",
                        "value": "[[concat(parameters('eventHubName'), 'configured for diagnostic logs for ', ': ', parameters('name'))]"
                      }
                    }
                  },
                  "parameters": {
                    "eventHubName": {
                      "value": "[[parameters('eventHubName')]"
                    },
                    "location": {
                      "value": "[[field('location')]"
                    },
                    "name": {
                      "value": "[[field('name')]"
                    },
                    "eventHubRuleId": {
                      "value": "[[parameters('eventHubRuleId')]"
                    },
                    "metricsEnabled": {
                      "value": "[[parameters('metricsEnabled')]"
                    },
                    "logsEnabled": {
                      "value": "[[parameters('logsEnabled')]"
                    },
                    "profileName": {
                      "value": "[[parameters('profileName')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "apiVersion": "2019-09-01",
      "name": "8CC85643DA23187569B18BADF5F25355",
      "properties": {
        "displayName": "Apply Diagnostic Settings for Microsoft.EventHub/namespaces to a Regional Event Hub",
        "mode": "Indexed",
        "description": "This policy automatically deploys diagnostic settings to Apply Diagnostic Settings for Microsoft.EventHub/namespaces to a Regional Event Hub.",
        "metadata": {
          "category": "Monitoring"
        },
        "parameters": {
          "profileName": {
            "type": "String",
            "metadata": {
              "displayName": "Profile Name for Config",
              "description": "The profile name Azure Diagnostics"
            }
          },
          "eventHubName": {
            "type": "String",
            "metadata": {
              "displayName": "EventHub Name",
              "description": "The event hub for Azure Diagnostics",
              "strongType": "Microsoft.EventHub/Namespaces/EventHubs",
              "assignPermissions": true
            }
          },
          "eventHubRuleId": {
            "type": "String",
            "metadata": {
              "displayName": "EventHubRuleID",
              "description": "The event hub RuleID for Azure Diagnostics",
              "strongType": "Microsoft.EventHub/Namespaces/AuthorizationRules",
              "assignPermissions": true
            }
          },
          "azureRegions": {
            "type": "Array",
            "metadata": {
              "displayName": "Allowed Locations",
              "description": "The list of locations that can be specified when deploying resources",
              "strongType": "location"
            }
          },
          "metricsEnabled": {
            "type": "String",
            "metadata": {
              "displayName": "Enable Metrics",
              "description": "Enable Metrics - True or False"
            },
            "allowedValues": [
              "True",
              "False"
            ],
            "defaultValue": "False"
          },
          "logsEnabled": {
            "type": "String",
            "metadata": {
              "displayName": "Enable Logs",
              "description": "Enable Logs - True or False"
            },
            "allowedValues": [
              "True",
              "False"
            ],
            "defaultValue": "True"
          }
        },
        "policyRule": {
          "if": {
            "allOf": [
              {
                "field": "type",
                "equals": "Microsoft.EventHub/namespaces"
              },
              {
                "field": "location",
                "in": "[[parameters('azureRegions')]"
              }
            ]
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "existenceCondition": {
                "allOf": [
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/logs.enabled",
                    "equals": "[[parameters('logsEnabled')]"
                  },
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/metrics.enabled",
                    "equals": "[[parameters('metricsEnabled')]"
                  },
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/eventHubName",
                    "equals": "[[last(split(parameters('eventHubName'), '/'))]"
                  }
                ]
              },
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "name": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      },
                      "eventHubName": {
                        "type": "string"
                      },
                      "eventHubRuleId": {
                        "type": "string"
                      },
                      "metricsEnabled": {
                        "type": "string"
                      },
                      "logsEnabled": {
                        "type": "string"
                      },
                      "profileName": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.EventHub/namespaces/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[[concat(parameters('name'), '/', 'Microsoft.Insights/', parameters('profileName'))]",
                        "location": "[[parameters('location')]",
                        "dependsOn": [],
                        "properties": {
                          "eventHubName": "[[last(split(parameters('eventHubName'), '/'))]",
                          "eventHubAuthorizationRuleId": "[[parameters('eventHubRuleId')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": "[[parameters('metricsEnabled')]",
                              "retentionPolicy": {
                                "enabled": false,
                                "days": 0
                              }
                            }
                          ],
                          "logs": [
                            {
                              "category": "ArchiveLogs",
                              "enabled": "[[parameters('logsEnabled')]"
                            },
                            {
                              "category": "OperationalLogs",
                              "enabled": "[[parameters('logsEnabled')]"
                            },
                            {
                              "category": "AutoScaleLogs",
                              "enabled": "[[parameters('logsEnabled')]"
                            },
                            {
                              "category": "KafkaCoordinatorLogs",
                              "enabled": "[[parameters('logsEnabled')]"
                            },
                            {
                              "category": "KafkaUserErrorLogs",
                              "enabled": "[[parameters('logsEnabled')]"
                            },
                            {
                              "category": "EventHubVNetConnectionEvent",
                              "enabled": "[[parameters('logsEnabled')]"
                            },
                            {
                              "category": "CustomerManagedKeyUserLogs",
                              "enabled": "[[parameters('logsEnabled')]"
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {
                      "policy": {
                        "type": "string",
                        "value": "[[concat(parameters('eventHubName'), 'configured for diagnostic logs for ', ': ', parameters('name'))]"
                      }
                    }
                  },
                  "parameters": {
                    "eventHubName": {
                      "value": "[[parameters('eventHubName')]"
                    },
                    "location": {
                      "value": "[[field('location')]"
                    },
                    "name": {
                      "value": "[[field('name')]"
                    },
                    "eventHubRuleId": {
                      "value": "[[parameters('eventHubRuleId')]"
                    },
                    "metricsEnabled": {
                      "value": "[[parameters('metricsEnabled')]"
                    },
                    "logsEnabled": {
                      "value": "[[parameters('logsEnabled')]"
                    },
                    "profileName": {
                      "value": "[[parameters('profileName')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "apiVersion": "2019-09-01",
      "name": "B0EB8FFBCA7D8ACB48DE43A3A1CCF869",
      "properties": {
        "displayName": "Apply Diagnostic Settings for Microsoft.Web/sites (functionapp,linux) to a Regional Event Hub",
        "mode": "Indexed",
        "description": "This policy automatically deploys diagnostic settings to Apply Diagnostic Settings for Microsoft.Web/sites (functionapp,linux) to a Regional Event Hub.",
        "metadata": {
          "category": "Monitoring"
        },
        "parameters": {
          "profileName": {
            "type": "String",
            "metadata": {
              "displayName": "Profile Name for Config",
              "description": "The profile name Azure Diagnostics"
            }
          },
          "eventHubName": {
            "type": "String",
            "metadata": {
              "displayName": "EventHub Name",
              "description": "The event hub for Azure Diagnostics",
              "strongType": "Microsoft.EventHub/Namespaces/EventHubs",
              "assignPermissions": true
            }
          },
          "eventHubRuleId": {
            "type": "String",
            "metadata": {
              "displayName": "EventHubRuleID",
              "description": "The event hub RuleID for Azure Diagnostics",
              "strongType": "Microsoft.EventHub/Namespaces/AuthorizationRules",
              "assignPermissions": true
            }
          },
          "azureRegions": {
            "type": "Array",
            "metadata": {
              "displayName": "Allowed Locations",
              "description": "The list of locations that can be specified when deploying resources",
              "strongType": "location"
            }
          },
          "metricsEnabled": {
            "type": "String",
            "metadata": {
              "displayName": "Enable Metrics",
              "description": "Enable Metrics - True or False"
            },
            "allowedValues": [
              "True",
              "False"
            ],
            "defaultValue": "False"
          },
          "logsEnabled": {
            "type": "String",
            "metadata": {
              "displayName": "Enable Logs",
              "description": "Enable Logs - True or False"
            },
            "allowedValues": [
              "True",
              "False"
            ],
            "defaultValue": "True"
          }
        },
        "policyRule": {
          "if": {
            "allOf": [
              {
                "field": "type",
                "equals": "Microsoft.Web/sites"
              },
              {
                "field": "location",
                "in": "[[parameters('azureRegions')]"
              },
              {
                "field": "kind",
                "equals": "functionapp,linux"
              }
            ]
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "existenceCondition": {
                "allOf": [
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/logs.enabled",
                    "equals": "[[parameters('logsEnabled')]"
                  },
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/metrics.enabled",
                    "equals": "[[parameters('metricsEnabled')]"
                  },
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/eventHubName",
                    "equals": "[[last(split(parameters('eventHubName'), '/'))]"
                  }
                ]
              },
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "name": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      },
                      "eventHubName": {
                        "type": "string"
                      },
                      "eventHubRuleId": {
                        "type": "string"
                      },
                      "metricsEnabled": {
                        "type": "string"
                      },
                      "logsEnabled": {
                        "type": "string"
                      },
                      "profileName": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.Web/sites/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[[concat(parameters('name'), '/', 'Microsoft.Insights/', parameters('profileName'))]",
                        "location": "[[parameters('location')]",
                        "dependsOn": [],
                        "properties": {
                          "eventHubName": "[[last(split(parameters('eventHubName'), '/'))]",
                          "eventHubAuthorizationRuleId": "[[parameters('eventHubRuleId')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": "[[parameters('metricsEnabled')]",
                              "retentionPolicy": {
                                "enabled": false,
                                "days": 0
                              }
                            }
                          ],
                          "logs": [
                            {
                              "category": "FunctionAppLogs",
                              "enabled": "[[parameters('logsEnabled')]"
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {
                      "policy": {
                        "type": "string",
                        "value": "[[concat(parameters('eventHubName'), 'configured for diagnostic logs for ', ': ', parameters('name'))]"
                      }
                    }
                  },
                  "parameters": {
                    "eventHubName": {
                      "value": "[[parameters('eventHubName')]"
                    },
                    "location": {
                      "value": "[[field('location')]"
                    },
                    "name": {
                      "value": "[[field('name')]"
                    },
                    "eventHubRuleId": {
                      "value": "[[parameters('eventHubRuleId')]"
                    },
                    "metricsEnabled": {
                      "value": "[[parameters('metricsEnabled')]"
                    },
                    "logsEnabled": {
                      "value": "[[parameters('logsEnabled')]"
                    },
                    "profileName": {
                      "value": "[[parameters('profileName')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "apiVersion": "2019-09-01",
      "name": "BD222F4EDF08BB1E2DC94C3444B8DD70",
      "properties": {
        "displayName": "Apply Diagnostic Settings for Microsoft.ContainerRegistry/registries to a Regional Event Hub",
        "mode": "Indexed",
        "description": "This policy automatically deploys diagnostic settings to Apply Diagnostic Settings for Microsoft.ContainerRegistry/registries to a Regional Event Hub.",
        "metadata": {
          "category": "Monitoring"
        },
        "parameters": {
          "profileName": {
            "type": "String",
            "metadata": {
              "displayName": "Profile Name for Config",
              "description": "The profile name Azure Diagnostics"
            }
          },
          "eventHubName": {
            "type": "String",
            "metadata": {
              "displayName": "EventHub Name",
              "description": "The event hub for Azure Diagnostics",
              "strongType": "Microsoft.EventHub/Namespaces/EventHubs",
              "assignPermissions": true
            }
          },
          "eventHubRuleId": {
            "type": "String",
            "metadata": {
              "displayName": "EventHubRuleID",
              "description": "The event hub RuleID for Azure Diagnostics",
              "strongType": "Microsoft.EventHub/Namespaces/AuthorizationRules",
              "assignPermissions": true
            }
          },
          "azureRegions": {
            "type": "Array",
            "metadata": {
              "displayName": "Allowed Locations",
              "description": "The list of locations that can be specified when deploying resources",
              "strongType": "location"
            }
          },
          "metricsEnabled": {
            "type": "String",
            "metadata": {
              "displayName": "Enable Metrics",
              "description": "Enable Metrics - True or False"
            },
            "allowedValues": [
              "True",
              "False"
            ],
            "defaultValue": "False"
          },
          "logsEnabled": {
            "type": "String",
            "metadata": {
              "displayName": "Enable Logs",
              "description": "Enable Logs - True or False"
            },
            "allowedValues": [
              "True",
              "False"
            ],
            "defaultValue": "True"
          }
        },
        "policyRule": {
          "if": {
            "allOf": [
              {
                "field": "type",
                "equals": "Microsoft.ContainerRegistry/registries"
              },
              {
                "field": "location",
                "in": "[[parameters('azureRegions')]"
              }
            ]
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "existenceCondition": {
                "allOf": [
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/logs.enabled",
                    "equals": "[[parameters('logsEnabled')]"
                  },
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/metrics.enabled",
                    "equals": "[[parameters('metricsEnabled')]"
                  },
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/eventHubName",
                    "equals": "[[last(split(parameters('eventHubName'), '/'))]"
                  }
                ]
              },
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "name": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      },
                      "eventHubName": {
                        "type": "string"
                      },
                      "eventHubRuleId": {
                        "type": "string"
                      },
                      "metricsEnabled": {
                        "type": "string"
                      },
                      "logsEnabled": {
                        "type": "string"
                      },
                      "profileName": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.ContainerRegistry/registries/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[[concat(parameters('name'), '/', 'Microsoft.Insights/', parameters('profileName'))]",
                        "location": "[[parameters('location')]",
                        "dependsOn": [],
                        "properties": {
                          "eventHubName": "[[last(split(parameters('eventHubName'), '/'))]",
                          "eventHubAuthorizationRuleId": "[[parameters('eventHubRuleId')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": "[[parameters('metricsEnabled')]",
                              "retentionPolicy": {
                                "enabled": false,
                                "days": 0
                              }
                            }
                          ],
                          "logs": [
                            {
                              "category": "ContainerRegistryRepositoryEvents",
                              "enabled": "[[parameters('logsEnabled')]"
                            },
                            {
                              "category": "ContainerRegistryLoginEvents",
                              "enabled": "[[parameters('logsEnabled')]"
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {
                      "policy": {
                        "type": "string",
                        "value": "[[concat(parameters('eventHubName'), 'configured for diagnostic logs for ', ': ', parameters('name'))]"
                      }
                    }
                  },
                  "parameters": {
                    "eventHubName": {
                      "value": "[[parameters('eventHubName')]"
                    },
                    "location": {
                      "value": "[[field('location')]"
                    },
                    "name": {
                      "value": "[[field('name')]"
                    },
                    "eventHubRuleId": {
                      "value": "[[parameters('eventHubRuleId')]"
                    },
                    "metricsEnabled": {
                      "value": "[[parameters('metricsEnabled')]"
                    },
                    "logsEnabled": {
                      "value": "[[parameters('logsEnabled')]"
                    },
                    "profileName": {
                      "value": "[[parameters('profileName')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "apiVersion": "2019-09-01",
      "name": "28621B0FCB1C1ED27A2C19F3124B146D",
      "properties": {
        "displayName": "Apply Diagnostic Settings for Microsoft.Compute/virtualMachineScaleSets to a Regional Event Hub",
        "mode": "Indexed",
        "description": "This policy automatically deploys diagnostic settings to Apply Diagnostic Settings for Microsoft.Compute/virtualMachineScaleSets to a Regional Event Hub.",
        "metadata": {
          "category": "Monitoring"
        },
        "parameters": {
          "profileName": {
            "type": "String",
            "metadata": {
              "displayName": "Profile Name for Config",
              "description": "The profile name Azure Diagnostics"
            }
          },
          "eventHubName": {
            "type": "String",
            "metadata": {
              "displayName": "EventHub Name",
              "description": "The event hub for Azure Diagnostics",
              "strongType": "Microsoft.EventHub/Namespaces/EventHubs",
              "assignPermissions": true
            }
          },
          "eventHubRuleId": {
            "type": "String",
            "metadata": {
              "displayName": "EventHubRuleID",
              "description": "The event hub RuleID for Azure Diagnostics",
              "strongType": "Microsoft.EventHub/Namespaces/AuthorizationRules",
              "assignPermissions": true
            }
          },
          "azureRegions": {
            "type": "Array",
            "metadata": {
              "displayName": "Allowed Locations",
              "description": "The list of locations that can be specified when deploying resources",
              "strongType": "location"
            }
          },
          "metricsEnabled": {
            "type": "String",
            "metadata": {
              "displayName": "Enable Metrics",
              "description": "Enable Metrics - True or False"
            },
            "allowedValues": [
              "True",
              "False"
            ],
            "defaultValue": "False"
          },
          "logsEnabled": {
            "type": "String",
            "metadata": {
              "displayName": "Enable Logs",
              "description": "Enable Logs - True or False"
            },
            "allowedValues": [
              "True",
              "False"
            ],
            "defaultValue": "True"
          }
        },
        "policyRule": {
          "if": {
            "allOf": [
              {
                "field": "type",
                "equals": "Microsoft.Compute/virtualMachineScaleSets"
              },
              {
                "field": "location",
                "in": "[[parameters('azureRegions')]"
              }
            ]
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "existenceCondition": {
                "allOf": [
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/logs.enabled",
                    "equals": "[[parameters('logsEnabled')]"
                  },
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/metrics.enabled",
                    "equals": "[[parameters('metricsEnabled')]"
                  },
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/eventHubName",
                    "equals": "[[last(split(parameters('eventHubName'), '/'))]"
                  }
                ]
              },
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "name": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      },
                      "eventHubName": {
                        "type": "string"
                      },
                      "eventHubRuleId": {
                        "type": "string"
                      },
                      "metricsEnabled": {
                        "type": "string"
                      },
                      "logsEnabled": {
                        "type": "string"
                      },
                      "profileName": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.Compute/virtualMachineScaleSets/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[[concat(parameters('name'), '/', 'Microsoft.Insights/', parameters('profileName'))]",
                        "location": "[[parameters('location')]",
                        "dependsOn": [],
                        "properties": {
                          "eventHubName": "[[last(split(parameters('eventHubName'), '/'))]",
                          "eventHubAuthorizationRuleId": "[[parameters('eventHubRuleId')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": "[[parameters('metricsEnabled')]",
                              "retentionPolicy": {
                                "enabled": false,
                                "days": 0
                              }
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {
                      "policy": {
                        "type": "string",
                        "value": "[[concat(parameters('eventHubName'), 'configured for diagnostic logs for ', ': ', parameters('name'))]"
                      }
                    }
                  },
                  "parameters": {
                    "eventHubName": {
                      "value": "[[parameters('eventHubName')]"
                    },
                    "location": {
                      "value": "[[field('location')]"
                    },
                    "name": {
                      "value": "[[field('name')]"
                    },
                    "eventHubRuleId": {
                      "value": "[[parameters('eventHubRuleId')]"
                    },
                    "metricsEnabled": {
                      "value": "[[parameters('metricsEnabled')]"
                    },
                    "logsEnabled": {
                      "value": "[[parameters('logsEnabled')]"
                    },
                    "profileName": {
                      "value": "[[parameters('profileName')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "apiVersion": "2019-09-01",
      "name": "EF0EA062ABF5A44EA8E656974074224B",
      "properties": {
        "displayName": "Apply Diagnostic Settings for Microsoft.Web/sites (functionapp) to a Regional Event Hub",
        "mode": "Indexed",
        "description": "This policy automatically deploys diagnostic settings to Apply Diagnostic Settings for Microsoft.Web/sites (functionapp) to a Regional Event Hub.",
        "metadata": {
          "category": "Monitoring"
        },
        "parameters": {
          "profileName": {
            "type": "String",
            "metadata": {
              "displayName": "Profile Name for Config",
              "description": "The profile name Azure Diagnostics"
            }
          },
          "eventHubName": {
            "type": "String",
            "metadata": {
              "displayName": "EventHub Name",
              "description": "The event hub for Azure Diagnostics",
              "strongType": "Microsoft.EventHub/Namespaces/EventHubs",
              "assignPermissions": true
            }
          },
          "eventHubRuleId": {
            "type": "String",
            "metadata": {
              "displayName": "EventHubRuleID",
              "description": "The event hub RuleID for Azure Diagnostics",
              "strongType": "Microsoft.EventHub/Namespaces/AuthorizationRules",
              "assignPermissions": true
            }
          },
          "azureRegions": {
            "type": "Array",
            "metadata": {
              "displayName": "Allowed Locations",
              "description": "The list of locations that can be specified when deploying resources",
              "strongType": "location"
            }
          },
          "metricsEnabled": {
            "type": "String",
            "metadata": {
              "displayName": "Enable Metrics",
              "description": "Enable Metrics - True or False"
            },
            "allowedValues": [
              "True",
              "False"
            ],
            "defaultValue": "False"
          },
          "logsEnabled": {
            "type": "String",
            "metadata": {
              "displayName": "Enable Logs",
              "description": "Enable Logs - True or False"
            },
            "allowedValues": [
              "True",
              "False"
            ],
            "defaultValue": "True"
          }
        },
        "policyRule": {
          "if": {
            "allOf": [
              {
                "field": "type",
                "equals": "Microsoft.Web/sites"
              },
              {
                "field": "location",
                "in": "[[parameters('azureRegions')]"
              },
              {
                "field": "kind",
                "equals": "functionapp"
              }
            ]
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "existenceCondition": {
                "allOf": [
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/logs.enabled",
                    "equals": "[[parameters('logsEnabled')]"
                  },
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/metrics.enabled",
                    "equals": "[[parameters('metricsEnabled')]"
                  },
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/eventHubName",
                    "equals": "[[last(split(parameters('eventHubName'), '/'))]"
                  }
                ]
              },
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "name": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      },
                      "eventHubName": {
                        "type": "string"
                      },
                      "eventHubRuleId": {
                        "type": "string"
                      },
                      "metricsEnabled": {
                        "type": "string"
                      },
                      "logsEnabled": {
                        "type": "string"
                      },
                      "profileName": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.Web/sites/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[[concat(parameters('name'), '/', 'Microsoft.Insights/', parameters('profileName'))]",
                        "location": "[[parameters('location')]",
                        "dependsOn": [],
                        "properties": {
                          "eventHubName": "[[last(split(parameters('eventHubName'), '/'))]",
                          "eventHubAuthorizationRuleId": "[[parameters('eventHubRuleId')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": "[[parameters('metricsEnabled')]",
                              "retentionPolicy": {
                                "enabled": false,
                                "days": 0
                              }
                            }
                          ],
                          "logs": [
                            {
                              "category": "FunctionAppLogs",
                              "enabled": "[[parameters('logsEnabled')]"
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {
                      "policy": {
                        "type": "string",
                        "value": "[[concat(parameters('eventHubName'), 'configured for diagnostic logs for ', ': ', parameters('name'))]"
                      }
                    }
                  },
                  "parameters": {
                    "eventHubName": {
                      "value": "[[parameters('eventHubName')]"
                    },
                    "location": {
                      "value": "[[field('location')]"
                    },
                    "name": {
                      "value": "[[field('name')]"
                    },
                    "eventHubRuleId": {
                      "value": "[[parameters('eventHubRuleId')]"
                    },
                    "metricsEnabled": {
                      "value": "[[parameters('metricsEnabled')]"
                    },
                    "logsEnabled": {
                      "value": "[[parameters('logsEnabled')]"
                    },
                    "profileName": {
                      "value": "[[parameters('profileName')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "apiVersion": "2019-09-01",
      "name": "2033C71E5C2F08B42EC2753CC375B4DF",
      "properties": {
        "displayName": "Apply Diagnostic Settings for Microsoft.Search/searchServices to a Regional Event Hub",
        "mode": "Indexed",
        "description": "This policy automatically deploys diagnostic settings to Apply Diagnostic Settings for Microsoft.Search/searchServices to a Regional Event Hub.",
        "metadata": {
          "category": "Monitoring"
        },
        "parameters": {
          "profileName": {
            "type": "String",
            "metadata": {
              "displayName": "Profile Name for Config",
              "description": "The profile name Azure Diagnostics"
            }
          },
          "eventHubName": {
            "type": "String",
            "metadata": {
              "displayName": "EventHub Name",
              "description": "The event hub for Azure Diagnostics",
              "strongType": "Microsoft.EventHub/Namespaces/EventHubs",
              "assignPermissions": true
            }
          },
          "eventHubRuleId": {
            "type": "String",
            "metadata": {
              "displayName": "EventHubRuleID",
              "description": "The event hub RuleID for Azure Diagnostics",
              "strongType": "Microsoft.EventHub/Namespaces/AuthorizationRules",
              "assignPermissions": true
            }
          },
          "azureRegions": {
            "type": "Array",
            "metadata": {
              "displayName": "Allowed Locations",
              "description": "The list of locations that can be specified when deploying resources",
              "strongType": "location"
            }
          },
          "metricsEnabled": {
            "type": "String",
            "metadata": {
              "displayName": "Enable Metrics",
              "description": "Enable Metrics - True or False"
            },
            "allowedValues": [
              "True",
              "False"
            ],
            "defaultValue": "False"
          },
          "logsEnabled": {
            "type": "String",
            "metadata": {
              "displayName": "Enable Logs",
              "description": "Enable Logs - True or False"
            },
            "allowedValues": [
              "True",
              "False"
            ],
            "defaultValue": "True"
          }
        },
        "policyRule": {
          "if": {
            "allOf": [
              {
                "field": "type",
                "equals": "Microsoft.Search/searchServices"
              },
              {
                "field": "location",
                "in": "[[parameters('azureRegions')]"
              }
            ]
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "existenceCondition": {
                "allOf": [
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/logs.enabled",
                    "equals": "[[parameters('logsEnabled')]"
                  },
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/metrics.enabled",
                    "equals": "[[parameters('metricsEnabled')]"
                  },
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/eventHubName",
                    "equals": "[[last(split(parameters('eventHubName'), '/'))]"
                  }
                ]
              },
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "name": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      },
                      "eventHubName": {
                        "type": "string"
                      },
                      "eventHubRuleId": {
                        "type": "string"
                      },
                      "metricsEnabled": {
                        "type": "string"
                      },
                      "logsEnabled": {
                        "type": "string"
                      },
                      "profileName": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.Search/searchServices/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[[concat(parameters('name'), '/', 'Microsoft.Insights/', parameters('profileName'))]",
                        "location": "[[parameters('location')]",
                        "dependsOn": [],
                        "properties": {
                          "eventHubName": "[[last(split(parameters('eventHubName'), '/'))]",
                          "eventHubAuthorizationRuleId": "[[parameters('eventHubRuleId')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": "[[parameters('metricsEnabled')]",
                              "retentionPolicy": {
                                "enabled": false,
                                "days": 0
                              }
                            }
                          ],
                          "logs": [
                            {
                              "category": "OperationLogs",
                              "enabled": "[[parameters('logsEnabled')]"
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {
                      "policy": {
                        "type": "string",
                        "value": "[[concat(parameters('eventHubName'), 'configured for diagnostic logs for ', ': ', parameters('name'))]"
                      }
                    }
                  },
                  "parameters": {
                    "eventHubName": {
                      "value": "[[parameters('eventHubName')]"
                    },
                    "location": {
                      "value": "[[field('location')]"
                    },
                    "name": {
                      "value": "[[field('name')]"
                    },
                    "eventHubRuleId": {
                      "value": "[[parameters('eventHubRuleId')]"
                    },
                    "metricsEnabled": {
                      "value": "[[parameters('metricsEnabled')]"
                    },
                    "logsEnabled": {
                      "value": "[[parameters('logsEnabled')]"
                    },
                    "profileName": {
                      "value": "[[parameters('profileName')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "apiVersion": "2019-09-01",
      "name": "1B2DBFB97AAC45EBC9C188DAAA0C7917",
      "properties": {
        "displayName": "Apply Diagnostic Settings for Microsoft.Batch/batchAccounts to a Regional Event Hub",
        "mode": "Indexed",
        "description": "This policy automatically deploys diagnostic settings to Apply Diagnostic Settings for Microsoft.Batch/batchAccounts to a Regional Event Hub.",
        "metadata": {
          "category": "Monitoring"
        },
        "parameters": {
          "profileName": {
            "type": "String",
            "metadata": {
              "displayName": "Profile Name for Config",
              "description": "The profile name Azure Diagnostics"
            }
          },
          "eventHubName": {
            "type": "String",
            "metadata": {
              "displayName": "EventHub Name",
              "description": "The event hub for Azure Diagnostics",
              "strongType": "Microsoft.EventHub/Namespaces/EventHubs",
              "assignPermissions": true
            }
          },
          "eventHubRuleId": {
            "type": "String",
            "metadata": {
              "displayName": "EventHubRuleID",
              "description": "The event hub RuleID for Azure Diagnostics",
              "strongType": "Microsoft.EventHub/Namespaces/AuthorizationRules",
              "assignPermissions": true
            }
          },
          "azureRegions": {
            "type": "Array",
            "metadata": {
              "displayName": "Allowed Locations",
              "description": "The list of locations that can be specified when deploying resources",
              "strongType": "location"
            }
          },
          "metricsEnabled": {
            "type": "String",
            "metadata": {
              "displayName": "Enable Metrics",
              "description": "Enable Metrics - True or False"
            },
            "allowedValues": [
              "True",
              "False"
            ],
            "defaultValue": "False"
          },
          "logsEnabled": {
            "type": "String",
            "metadata": {
              "displayName": "Enable Logs",
              "description": "Enable Logs - True or False"
            },
            "allowedValues": [
              "True",
              "False"
            ],
            "defaultValue": "True"
          }
        },
        "policyRule": {
          "if": {
            "allOf": [
              {
                "field": "type",
                "equals": "Microsoft.Batch/batchAccounts"
              },
              {
                "field": "location",
                "in": "[[parameters('azureRegions')]"
              }
            ]
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "existenceCondition": {
                "allOf": [
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/logs.enabled",
                    "equals": "[[parameters('logsEnabled')]"
                  },
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/metrics.enabled",
                    "equals": "[[parameters('metricsEnabled')]"
                  },
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/eventHubName",
                    "equals": "[[last(split(parameters('eventHubName'), '/'))]"
                  }
                ]
              },
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "name": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      },
                      "eventHubName": {
                        "type": "string"
                      },
                      "eventHubRuleId": {
                        "type": "string"
                      },
                      "metricsEnabled": {
                        "type": "string"
                      },
                      "logsEnabled": {
                        "type": "string"
                      },
                      "profileName": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.Batch/batchAccounts/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[[concat(parameters('name'), '/', 'Microsoft.Insights/', parameters('profileName'))]",
                        "location": "[[parameters('location')]",
                        "dependsOn": [],
                        "properties": {
                          "eventHubName": "[[last(split(parameters('eventHubName'), '/'))]",
                          "eventHubAuthorizationRuleId": "[[parameters('eventHubRuleId')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": "[[parameters('metricsEnabled')]",
                              "retentionPolicy": {
                                "enabled": false,
                                "days": 0
                              }
                            }
                          ],
                          "logs": [
                            {
                              "category": "ServiceLog",
                              "enabled": "[[parameters('logsEnabled')]"
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {
                      "policy": {
                        "type": "string",
                        "value": "[[concat(parameters('eventHubName'), 'configured for diagnostic logs for ', ': ', parameters('name'))]"
                      }
                    }
                  },
                  "parameters": {
                    "eventHubName": {
                      "value": "[[parameters('eventHubName')]"
                    },
                    "location": {
                      "value": "[[field('location')]"
                    },
                    "name": {
                      "value": "[[field('name')]"
                    },
                    "eventHubRuleId": {
                      "value": "[[parameters('eventHubRuleId')]"
                    },
                    "metricsEnabled": {
                      "value": "[[parameters('metricsEnabled')]"
                    },
                    "logsEnabled": {
                      "value": "[[parameters('logsEnabled')]"
                    },
                    "profileName": {
                      "value": "[[parameters('profileName')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "apiVersion": "2019-09-01",
      "name": "2B20F5754CE54A67C45B000601B79FF5",
      "properties": {
        "displayName": "Apply Diagnostic Settings for Microsoft.Sql/servers/databases (v12.0,user) to a Regional Event Hub",
        "mode": "Indexed",
        "description": "This policy automatically deploys diagnostic settings to Apply Diagnostic Settings for Microsoft.Sql/servers/databases (v12.0,user) to a Regional Event Hub.",
        "metadata": {
          "category": "Monitoring"
        },
        "parameters": {
          "profileName": {
            "type": "String",
            "metadata": {
              "displayName": "Profile Name for Config",
              "description": "The profile name Azure Diagnostics"
            }
          },
          "eventHubName": {
            "type": "String",
            "metadata": {
              "displayName": "EventHub Name",
              "description": "The event hub for Azure Diagnostics",
              "strongType": "Microsoft.EventHub/Namespaces/EventHubs",
              "assignPermissions": true
            }
          },
          "eventHubRuleId": {
            "type": "String",
            "metadata": {
              "displayName": "EventHubRuleID",
              "description": "The event hub RuleID for Azure Diagnostics",
              "strongType": "Microsoft.EventHub/Namespaces/AuthorizationRules",
              "assignPermissions": true
            }
          },
          "azureRegions": {
            "type": "Array",
            "metadata": {
              "displayName": "Allowed Locations",
              "description": "The list of locations that can be specified when deploying resources",
              "strongType": "location"
            }
          },
          "metricsEnabled": {
            "type": "String",
            "metadata": {
              "displayName": "Enable Metrics",
              "description": "Enable Metrics - True or False"
            },
            "allowedValues": [
              "True",
              "False"
            ],
            "defaultValue": "False"
          },
          "logsEnabled": {
            "type": "String",
            "metadata": {
              "displayName": "Enable Logs",
              "description": "Enable Logs - True or False"
            },
            "allowedValues": [
              "True",
              "False"
            ],
            "defaultValue": "True"
          }
        },
        "policyRule": {
          "if": {
            "allOf": [
              {
                "field": "type",
                "equals": "Microsoft.Sql/servers/databases"
              },
              {
                "field": "location",
                "in": "[[parameters('azureRegions')]"
              },
              {
                "field": "kind",
                "equals": "v12.0,user"
              }
            ]
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "existenceCondition": {
                "allOf": [
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/logs.enabled",
                    "equals": "[[parameters('logsEnabled')]"
                  },
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/metrics.enabled",
                    "equals": "[[parameters('metricsEnabled')]"
                  },
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/eventHubName",
                    "equals": "[[last(split(parameters('eventHubName'), '/'))]"
                  }
                ]
              },
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "name": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      },
                      "eventHubName": {
                        "type": "string"
                      },
                      "eventHubRuleId": {
                        "type": "string"
                      },
                      "metricsEnabled": {
                        "type": "string"
                      },
                      "logsEnabled": {
                        "type": "string"
                      },
                      "profileName": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.Sql/servers/databases/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[[concat(parameters('name'), '/', 'Microsoft.Insights/', parameters('profileName'))]",
                        "location": "[[parameters('location')]",
                        "dependsOn": [],
                        "properties": {
                          "eventHubName": "[[last(split(parameters('eventHubName'), '/'))]",
                          "eventHubAuthorizationRuleId": "[[parameters('eventHubRuleId')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": "[[parameters('metricsEnabled')]",
                              "retentionPolicy": {
                                "enabled": false,
                                "days": 0
                              }
                            }
                          ],
                          "logs": [
                            {
                              "category": "SQLInsights",
                              "enabled": "[[parameters('logsEnabled')]"
                            },
                            {
                              "category": "AutomaticTuning",
                              "enabled": "[[parameters('logsEnabled')]"
                            },
                            {
                              "category": "QueryStoreRuntimeStatistics",
                              "enabled": "[[parameters('logsEnabled')]"
                            },
                            {
                              "category": "QueryStoreWaitStatistics",
                              "enabled": "[[parameters('logsEnabled')]"
                            },
                            {
                              "category": "Errors",
                              "enabled": "[[parameters('logsEnabled')]"
                            },
                            {
                              "category": "DatabaseWaitStatistics",
                              "enabled": "[[parameters('logsEnabled')]"
                            },
                            {
                              "category": "Timeouts",
                              "enabled": "[[parameters('logsEnabled')]"
                            },
                            {
                              "category": "Blocks",
                              "enabled": "[[parameters('logsEnabled')]"
                            },
                            {
                              "category": "Deadlocks",
                              "enabled": "[[parameters('logsEnabled')]"
                            },
                            {
                              "category": "DevOpsOperationsAudit",
                              "enabled": "[[parameters('logsEnabled')]"
                            },
                            {
                              "category": "SQLSecurityAuditEvents",
                              "enabled": "[[parameters('logsEnabled')]"
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {
                      "policy": {
                        "type": "string",
                        "value": "[[concat(parameters('eventHubName'), 'configured for diagnostic logs for ', ': ', parameters('name'))]"
                      }
                    }
                  },
                  "parameters": {
                    "eventHubName": {
                      "value": "[[parameters('eventHubName')]"
                    },
                    "location": {
                      "value": "[[field('location')]"
                    },
                    "name": {
                      "value": "[[field('fullName')]"
                    },
                    "eventHubRuleId": {
                      "value": "[[parameters('eventHubRuleId')]"
                    },
                    "metricsEnabled": {
                      "value": "[[parameters('metricsEnabled')]"
                    },
                    "logsEnabled": {
                      "value": "[[parameters('logsEnabled')]"
                    },
                    "profileName": {
                      "value": "[[parameters('profileName')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "apiVersion": "2019-09-01",
      "name": "DBFE912FCEDF63817A74AACEEC8470E9",
      "properties": {
        "displayName": "Apply Diagnostic Settings for Microsoft.ClassicStorage/storageAccounts to a Regional Event Hub",
        "mode": "Indexed",
        "description": "This policy automatically deploys diagnostic settings to Apply Diagnostic Settings for Microsoft.ClassicStorage/storageAccounts to a Regional Event Hub.",
        "metadata": {
          "category": "Monitoring"
        },
        "parameters": {
          "profileName": {
            "type": "String",
            "metadata": {
              "displayName": "Profile Name for Config",
              "description": "The profile name Azure Diagnostics"
            }
          },
          "eventHubName": {
            "type": "String",
            "metadata": {
              "displayName": "EventHub Name",
              "description": "The event hub for Azure Diagnostics",
              "strongType": "Microsoft.EventHub/Namespaces/EventHubs",
              "assignPermissions": true
            }
          },
          "eventHubRuleId": {
            "type": "String",
            "metadata": {
              "displayName": "EventHubRuleID",
              "description": "The event hub RuleID for Azure Diagnostics",
              "strongType": "Microsoft.EventHub/Namespaces/AuthorizationRules",
              "assignPermissions": true
            }
          },
          "azureRegions": {
            "type": "Array",
            "metadata": {
              "displayName": "Allowed Locations",
              "description": "The list of locations that can be specified when deploying resources",
              "strongType": "location"
            }
          },
          "metricsEnabled": {
            "type": "String",
            "metadata": {
              "displayName": "Enable Metrics",
              "description": "Enable Metrics - True or False"
            },
            "allowedValues": [
              "True",
              "False"
            ],
            "defaultValue": "False"
          },
          "logsEnabled": {
            "type": "String",
            "metadata": {
              "displayName": "Enable Logs",
              "description": "Enable Logs - True or False"
            },
            "allowedValues": [
              "True",
              "False"
            ],
            "defaultValue": "True"
          }
        },
        "policyRule": {
          "if": {
            "allOf": [
              {
                "field": "type",
                "equals": "Microsoft.ClassicStorage/storageAccounts"
              },
              {
                "field": "location",
                "in": "[[parameters('azureRegions')]"
              }
            ]
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "existenceCondition": {
                "allOf": [
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/logs.enabled",
                    "equals": "[[parameters('logsEnabled')]"
                  },
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/metrics.enabled",
                    "equals": "[[parameters('metricsEnabled')]"
                  },
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/eventHubName",
                    "equals": "[[last(split(parameters('eventHubName'), '/'))]"
                  }
                ]
              },
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "name": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      },
                      "eventHubName": {
                        "type": "string"
                      },
                      "eventHubRuleId": {
                        "type": "string"
                      },
                      "metricsEnabled": {
                        "type": "string"
                      },
                      "logsEnabled": {
                        "type": "string"
                      },
                      "profileName": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.ClassicStorage/storageAccounts/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[[concat(parameters('name'), '/', 'Microsoft.Insights/', parameters('profileName'))]",
                        "location": "[[parameters('location')]",
                        "dependsOn": [],
                        "properties": {
                          "eventHubName": "[[last(split(parameters('eventHubName'), '/'))]",
                          "eventHubAuthorizationRuleId": "[[parameters('eventHubRuleId')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": "[[parameters('metricsEnabled')]",
                              "retentionPolicy": {
                                "enabled": false,
                                "days": 0
                              }
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {
                      "policy": {
                        "type": "string",
                        "value": "[[concat(parameters('eventHubName'), 'configured for diagnostic logs for ', ': ', parameters('name'))]"
                      }
                    }
                  },
                  "parameters": {
                    "eventHubName": {
                      "value": "[[parameters('eventHubName')]"
                    },
                    "location": {
                      "value": "[[field('location')]"
                    },
                    "name": {
                      "value": "[[field('name')]"
                    },
                    "eventHubRuleId": {
                      "value": "[[parameters('eventHubRuleId')]"
                    },
                    "metricsEnabled": {
                      "value": "[[parameters('metricsEnabled')]"
                    },
                    "logsEnabled": {
                      "value": "[[parameters('logsEnabled')]"
                    },
                    "profileName": {
                      "value": "[[parameters('profileName')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policyDefinitions",
      "apiVersion": "2019-09-01",
      "name": "584687C59B443BB2864F400DAC30FA3E",
      "properties": {
        "displayName": "Apply Diagnostic Settings for Microsoft.ContainerInstance/containerGroups to a Regional Event Hub",
        "mode": "Indexed",
        "description": "This policy automatically deploys diagnostic settings to Apply Diagnostic Settings for Microsoft.ContainerInstance/containerGroups to a Regional Event Hub.",
        "metadata": {
          "category": "Monitoring"
        },
        "parameters": {
          "profileName": {
            "type": "String",
            "metadata": {
              "displayName": "Profile Name for Config",
              "description": "The profile name Azure Diagnostics"
            }
          },
          "eventHubName": {
            "type": "String",
            "metadata": {
              "displayName": "EventHub Name",
              "description": "The event hub for Azure Diagnostics",
              "strongType": "Microsoft.EventHub/Namespaces/EventHubs",
              "assignPermissions": true
            }
          },
          "eventHubRuleId": {
            "type": "String",
            "metadata": {
              "displayName": "EventHubRuleID",
              "description": "The event hub RuleID for Azure Diagnostics",
              "strongType": "Microsoft.EventHub/Namespaces/AuthorizationRules",
              "assignPermissions": true
            }
          },
          "azureRegions": {
            "type": "Array",
            "metadata": {
              "displayName": "Allowed Locations",
              "description": "The list of locations that can be specified when deploying resources",
              "strongType": "location"
            }
          },
          "metricsEnabled": {
            "type": "String",
            "metadata": {
              "displayName": "Enable Metrics",
              "description": "Enable Metrics - True or False"
            },
            "allowedValues": [
              "True",
              "False"
            ],
            "defaultValue": "False"
          },
          "logsEnabled": {
            "type": "String",
            "metadata": {
              "displayName": "Enable Logs",
              "description": "Enable Logs - True or False"
            },
            "allowedValues": [
              "True",
              "False"
            ],
            "defaultValue": "True"
          }
        },
        "policyRule": {
          "if": {
            "allOf": [
              {
                "field": "type",
                "equals": "Microsoft.ContainerInstance/containerGroups"
              },
              {
                "field": "location",
                "in": "[[parameters('azureRegions')]"
              }
            ]
          },
          "then": {
            "effect": "deployIfNotExists",
            "details": {
              "type": "Microsoft.Insights/diagnosticSettings",
              "existenceCondition": {
                "allOf": [
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/logs.enabled",
                    "equals": "[[parameters('logsEnabled')]"
                  },
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/metrics.enabled",
                    "equals": "[[parameters('metricsEnabled')]"
                  },
                  {
                    "field": "Microsoft.Insights/diagnosticSettings/eventHubName",
                    "equals": "[[last(split(parameters('eventHubName'), '/'))]"
                  }
                ]
              },
              "roleDefinitionIds": [
                "/providers/Microsoft.Authorization/roleDefinitions/b24988ac-6180-42a0-ab88-20f7382dd24c"
              ],
              "deployment": {
                "properties": {
                  "mode": "incremental",
                  "template": {
                    "$schema": "http://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                      "name": {
                        "type": "string"
                      },
                      "location": {
                        "type": "string"
                      },
                      "eventHubName": {
                        "type": "string"
                      },
                      "eventHubRuleId": {
                        "type": "string"
                      },
                      "metricsEnabled": {
                        "type": "string"
                      },
                      "logsEnabled": {
                        "type": "string"
                      },
                      "profileName": {
                        "type": "string"
                      }
                    },
                    "variables": {},
                    "resources": [
                      {
                        "type": "Microsoft.ContainerInstance/containerGroups/providers/diagnosticSettings",
                        "apiVersion": "2017-05-01-preview",
                        "name": "[[concat(parameters('name'), '/', 'Microsoft.Insights/', parameters('profileName'))]",
                        "location": "[[parameters('location')]",
                        "dependsOn": [],
                        "properties": {
                          "eventHubName": "[[last(split(parameters('eventHubName'), '/'))]",
                          "eventHubAuthorizationRuleId": "[[parameters('eventHubRuleId')]",
                          "metrics": [
                            {
                              "category": "AllMetrics",
                              "enabled": "[[parameters('metricsEnabled')]",
                              "retentionPolicy": {
                                "enabled": false,
                                "days": 0
                              }
                            }
                          ]
                        }
                      }
                    ],
                    "outputs": {
                      "policy": {
                        "type": "string",
                        "value": "[[concat(parameters('eventHubName'), 'configured for diagnostic logs for ', ': ', parameters('name'))]"
                      }
                    }
                  },
                  "parameters": {
                    "eventHubName": {
                      "value": "[[parameters('eventHubName')]"
                    },
                    "location": {
                      "value": "[[field('location')]"
                    },
                    "name": {
                      "value": "[[field('name')]"
                    },
                    "eventHubRuleId": {
                      "value": "[[parameters('eventHubRuleId')]"
                    },
                    "metricsEnabled": {
                      "value": "[[parameters('metricsEnabled')]"
                    },
                    "logsEnabled": {
                      "value": "[[parameters('logsEnabled')]"
                    },
                    "profileName": {
                      "value": "[[parameters('profileName')]"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    {
      "type": "Microsoft.Authorization/policySetDefinitions",
      "apiVersion": "2019-09-01",
      "name": "2DDA3956360D28394FF86ABD8C832D8C",
      "dependsOn": [
        "[resourceId('Microsoft.Authorization/policyDefinitions/', '82B283F1C22CE03E0ED3BF024A2CE947')]",
        "[resourceId('Microsoft.Authorization/policyDefinitions/', 'A08C4E65AC3520BF59E8CEC50B5021ED')]",
        "[resourceId('Microsoft.Authorization/policyDefinitions/', 'DD13AD31C7D6A8416312B40E06EBEA3B')]",
        "[resourceId('Microsoft.Authorization/policyDefinitions/', '9E299A3D6BE683D5871FCDAC9139A26B')]",
        "[resourceId('Microsoft.Authorization/policyDefinitions/', '99C792FE1BF4398643D4F8E0B05FB134')]",
        "[resourceId('Microsoft.Authorization/policyDefinitions/', '59895B4EE7386CEF5C3CD1CBF94C03BC')]",
        "[resourceId('Microsoft.Authorization/policyDefinitions/', '33357A14C3F088DF4D70155B6ABC27F3')]",
        "[resourceId('Microsoft.Authorization/policyDefinitions/', 'DE8BF220042039E3F2D6C37711DFA076')]",
        "[resourceId('Microsoft.Authorization/policyDefinitions/', '05A72FA2831F9B660C2C9EAA421CC083')]",
        "[resourceId('Microsoft.Authorization/policyDefinitions/', 'DCF778F39F2F9F201095B20EDF4A8095')]",
        "[resourceId('Microsoft.Authorization/policyDefinitions/', 'CB76F6D874BFEA0FBC59F76E13AABC2E')]",
        "[resourceId('Microsoft.Authorization/policyDefinitions/', '855EF5B024C4E3C75E81D4850CBB181E')]",
        "[resourceId('Microsoft.Authorization/policyDefinitions/', 'A7F84303540A7D5588A3C13AEE85C324')]",
        "[resourceId('Microsoft.Authorization/policyDefinitions/', 'E0CC0DB1153DA5E2CCE75FC2900A0439')]",
        "[resourceId('Microsoft.Authorization/policyDefinitions/', '7BA6741429811894D30B7F69560AE62D')]",
        "[resourceId('Microsoft.Authorization/policyDefinitions/', '4A4326E787B2301C880908962F6BE4A2')]",
        "[resourceId('Microsoft.Authorization/policyDefinitions/', '646F62950D2FC86CB224C9DE9C22B3E8')]",
        "[resourceId('Microsoft.Authorization/policyDefinitions/', 'EAF8CE5F106CB4EC81537E76A11B3C31')]",
        "[resourceId('Microsoft.Authorization/policyDefinitions/', '5965D075FE067794EE545CBF4136CDA8')]",
        "[resourceId('Microsoft.Authorization/policyDefinitions/', 'F89D4C3236F9777A19780ACDB5609E63')]",
        "[resourceId('Microsoft.Authorization/policyDefinitions/', 'A3128A03900A369FFB43922CE083A611')]",
        "[resourceId('Microsoft.Authorization/policyDefinitions/', 'EF143C90CB8B0B640E21F94087B83FE7')]",
        "[resourceId('Microsoft.Authorization/policyDefinitions/', 'E080480106E18A3623B6726D45430AA0')]",
        "[resourceId('Microsoft.Authorization/policyDefinitions/', '2D10CC0C81FF15C71FABF5E5E6744F23')]",
        "[resourceId('Microsoft.Authorization/policyDefinitions/', '359DED89E3ABEED5E2C8D7EB9B5204E4')]",
        "[resourceId('Microsoft.Authorization/policyDefinitions/', 'F3277E2FB064E33A0135173E8D3BEEBF')]",
        "[resourceId('Microsoft.Authorization/policyDefinitions/', '93DFDF408A9A1AB7F070C9C0DB4C9A22')]",
        "[resourceId('Microsoft.Authorization/policyDefinitions/', '7FFAF04894D0815AE0923A5ABC1EF27C')]",
        "[resourceId('Microsoft.Authorization/policyDefinitions/', '893A4561A0AB741FCBAE5B13C5FF66DD')]",
        "[resourceId('Microsoft.Authorization/policyDefinitions/', 'B10BBE9EE398B5E5B597C31A01D5EEC0')]",
        "[resourceId('Microsoft.Authorization/policyDefinitions/', 'A510638DE8DA10CCE40FA86A9653337B')]",
        "[resourceId('Microsoft.Authorization/policyDefinitions/', 'C8586D4AF28A1CEC8539D9FCE8F59B71')]",
        "[resourceId('Microsoft.Authorization/policyDefinitions/', '8CC85643DA23187569B18BADF5F25355')]",
        "[resourceId('Microsoft.Authorization/policyDefinitions/', 'B0EB8FFBCA7D8ACB48DE43A3A1CCF869')]",
        "[resourceId('Microsoft.Authorization/policyDefinitions/', 'BD222F4EDF08BB1E2DC94C3444B8DD70')]",
        "[resourceId('Microsoft.Authorization/policyDefinitions/', '28621B0FCB1C1ED27A2C19F3124B146D')]",
        "[resourceId('Microsoft.Authorization/policyDefinitions/', 'EF0EA062ABF5A44EA8E656974074224B')]",
        "[resourceId('Microsoft.Authorization/policyDefinitions/', '2033C71E5C2F08B42EC2753CC375B4DF')]",
        "[resourceId('Microsoft.Authorization/policyDefinitions/', '1B2DBFB97AAC45EBC9C188DAAA0C7917')]",
        "[resourceId('Microsoft.Authorization/policyDefinitions/', '2B20F5754CE54A67C45B000601B79FF5')]",
        "[resourceId('Microsoft.Authorization/policyDefinitions/', 'DBFE912FCEDF63817A74AACEEC8470E9')]",
        "[resourceId('Microsoft.Authorization/policyDefinitions/', '584687C59B443BB2864F400DAC30FA3E')]"
      ],
      "properties": {
        "displayName": "Azure Diagnostics Policy Initiative to LM",
        "description": "This initiative configures application Azure resources to forward diagnostic logs and metrics to an Azure Diagnostics Event Hub.",
        "metadata": {
          "category": "Monitoring"
        },
        "parameters": {
          "profileName": {
            "type": "String",
            "metadata": {
              "displayName": "Profile Name for Config",
              "description": "The profile name Azure Diagnostics"
            }
          },
          "eventHubName": {
            "type": "String",
            "metadata": {
              "displayName": "EventHub Name",
              "description": "The event hub for Azure Diagnostics",
              "strongType": "Microsoft.EventHub/Namespaces/EventHubs",
              "assignPermissions": true
            }
          },
          "eventHubRuleId": {
            "type": "String",
            "metadata": {
              "displayName": "EventHubRuleID",
              "description": "The event hub RuleID for Azure Diagnostics",
              "strongType": "Microsoft.EventHub/Namespaces/AuthorizationRules",
              "assignPermissions": true
            }
          },
          "azureRegions": {
            "type": "Array",
            "metadata": {
              "displayName": "Allowed Locations",
              "description": "The list of locations that can be specified when deploying resources",
              "strongType": "location"
            }
          },
          "metricsEnabled": {
            "type": "String",
            "metadata": {
              "displayName": "Enable Metrics",
              "description": "Enable Metrics - True or False"
            },
            "allowedValues": [
              "True",
              "False"
            ],
            "defaultValue": "True"
          },
          "logsEnabled": {
            "type": "String",
            "metadata": {
              "displayName": "Enable Logs",
              "description": "Enable Logs - True or False"
            },
            "allowedValues": [
              "True",
              "False"
            ],
            "defaultValue": "True"
          }
        },
        "policyDefinitions": [
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', '82B283F1C22CE03E0ED3BF024A2CE947')]",
            "parameters": {
              "eventHubName": {
                "value": "[[parameters('eventHubName')]"
              },
              "eventHubRuleId": {
                "value": "[[parameters('eventHubRuleId')]"
              },
              "azureRegions": {
                "value": "[[parameters('azureRegions')]"
              },
              "metricsEnabled": {
                "value": "[[parameters('metricsEnabled')]"
              },
              "logsEnabled": {
                "value": "[[parameters('logsEnabled')]"
              },
              "profileName": {
                "value": "[[parameters('profileName')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', 'A08C4E65AC3520BF59E8CEC50B5021ED')]",
            "parameters": {
              "eventHubName": {
                "value": "[[parameters('eventHubName')]"
              },
              "eventHubRuleId": {
                "value": "[[parameters('eventHubRuleId')]"
              },
              "azureRegions": {
                "value": "[[parameters('azureRegions')]"
              },
              "metricsEnabled": {
                "value": "[[parameters('metricsEnabled')]"
              },
              "logsEnabled": {
                "value": "[[parameters('logsEnabled')]"
              },
              "profileName": {
                "value": "[[parameters('profileName')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', 'DD13AD31C7D6A8416312B40E06EBEA3B')]",
            "parameters": {
              "eventHubName": {
                "value": "[[parameters('eventHubName')]"
              },
              "eventHubRuleId": {
                "value": "[[parameters('eventHubRuleId')]"
              },
              "azureRegions": {
                "value": "[[parameters('azureRegions')]"
              },
              "metricsEnabled": {
                "value": "[[parameters('metricsEnabled')]"
              },
              "logsEnabled": {
                "value": "[[parameters('logsEnabled')]"
              },
              "profileName": {
                "value": "[[parameters('profileName')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', '9E299A3D6BE683D5871FCDAC9139A26B')]",
            "parameters": {
              "eventHubName": {
                "value": "[[parameters('eventHubName')]"
              },
              "eventHubRuleId": {
                "value": "[[parameters('eventHubRuleId')]"
              },
              "azureRegions": {
                "value": "[[parameters('azureRegions')]"
              },
              "metricsEnabled": {
                "value": "[[parameters('metricsEnabled')]"
              },
              "logsEnabled": {
                "value": "[[parameters('logsEnabled')]"
              },
              "profileName": {
                "value": "[[parameters('profileName')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', '99C792FE1BF4398643D4F8E0B05FB134')]",
            "parameters": {
              "eventHubName": {
                "value": "[[parameters('eventHubName')]"
              },
              "eventHubRuleId": {
                "value": "[[parameters('eventHubRuleId')]"
              },
              "azureRegions": {
                "value": "[[parameters('azureRegions')]"
              },
              "metricsEnabled": {
                "value": "[[parameters('metricsEnabled')]"
              },
              "logsEnabled": {
                "value": "[[parameters('logsEnabled')]"
              },
              "profileName": {
                "value": "[[parameters('profileName')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', '59895B4EE7386CEF5C3CD1CBF94C03BC')]",
            "parameters": {
              "eventHubName": {
                "value": "[[parameters('eventHubName')]"
              },
              "eventHubRuleId": {
                "value": "[[parameters('eventHubRuleId')]"
              },
              "azureRegions": {
                "value": "[[parameters('azureRegions')]"
              },
              "metricsEnabled": {
                "value": "[[parameters('metricsEnabled')]"
              },
              "logsEnabled": {
                "value": "[[parameters('logsEnabled')]"
              },
              "profileName": {
                "value": "[[parameters('profileName')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', '33357A14C3F088DF4D70155B6ABC27F3')]",
            "parameters": {
              "eventHubName": {
                "value": "[[parameters('eventHubName')]"
              },
              "eventHubRuleId": {
                "value": "[[parameters('eventHubRuleId')]"
              },
              "azureRegions": {
                "value": "[[parameters('azureRegions')]"
              },
              "metricsEnabled": {
                "value": "[[parameters('metricsEnabled')]"
              },
              "logsEnabled": {
                "value": "[[parameters('logsEnabled')]"
              },
              "profileName": {
                "value": "[[parameters('profileName')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', 'DE8BF220042039E3F2D6C37711DFA076')]",
            "parameters": {
              "eventHubName": {
                "value": "[[parameters('eventHubName')]"
              },
              "eventHubRuleId": {
                "value": "[[parameters('eventHubRuleId')]"
              },
              "azureRegions": {
                "value": "[[parameters('azureRegions')]"
              },
              "metricsEnabled": {
                "value": "[[parameters('metricsEnabled')]"
              },
              "logsEnabled": {
                "value": "[[parameters('logsEnabled')]"
              },
              "profileName": {
                "value": "[[parameters('profileName')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', '05A72FA2831F9B660C2C9EAA421CC083')]",
            "parameters": {
              "eventHubName": {
                "value": "[[parameters('eventHubName')]"
              },
              "eventHubRuleId": {
                "value": "[[parameters('eventHubRuleId')]"
              },
              "azureRegions": {
                "value": "[[parameters('azureRegions')]"
              },
              "metricsEnabled": {
                "value": "[[parameters('metricsEnabled')]"
              },
              "logsEnabled": {
                "value": "[[parameters('logsEnabled')]"
              },
              "profileName": {
                "value": "[[parameters('profileName')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', 'DCF778F39F2F9F201095B20EDF4A8095')]",
            "parameters": {
              "eventHubName": {
                "value": "[[parameters('eventHubName')]"
              },
              "eventHubRuleId": {
                "value": "[[parameters('eventHubRuleId')]"
              },
              "azureRegions": {
                "value": "[[parameters('azureRegions')]"
              },
              "metricsEnabled": {
                "value": "[[parameters('metricsEnabled')]"
              },
              "logsEnabled": {
                "value": "[[parameters('logsEnabled')]"
              },
              "profileName": {
                "value": "[[parameters('profileName')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', 'CB76F6D874BFEA0FBC59F76E13AABC2E')]",
            "parameters": {
              "eventHubName": {
                "value": "[[parameters('eventHubName')]"
              },
              "eventHubRuleId": {
                "value": "[[parameters('eventHubRuleId')]"
              },
              "azureRegions": {
                "value": "[[parameters('azureRegions')]"
              },
              "metricsEnabled": {
                "value": "[[parameters('metricsEnabled')]"
              },
              "logsEnabled": {
                "value": "[[parameters('logsEnabled')]"
              },
              "profileName": {
                "value": "[[parameters('profileName')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', '855EF5B024C4E3C75E81D4850CBB181E')]",
            "parameters": {
              "eventHubName": {
                "value": "[[parameters('eventHubName')]"
              },
              "eventHubRuleId": {
                "value": "[[parameters('eventHubRuleId')]"
              },
              "azureRegions": {
                "value": "[[parameters('azureRegions')]"
              },
              "metricsEnabled": {
                "value": "[[parameters('metricsEnabled')]"
              },
              "logsEnabled": {
                "value": "[[parameters('logsEnabled')]"
              },
              "profileName": {
                "value": "[[parameters('profileName')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', 'A7F84303540A7D5588A3C13AEE85C324')]",
            "parameters": {
              "eventHubName": {
                "value": "[[parameters('eventHubName')]"
              },
              "eventHubRuleId": {
                "value": "[[parameters('eventHubRuleId')]"
              },
              "azureRegions": {
                "value": "[[parameters('azureRegions')]"
              },
              "metricsEnabled": {
                "value": "[[parameters('metricsEnabled')]"
              },
              "logsEnabled": {
                "value": "[[parameters('logsEnabled')]"
              },
              "profileName": {
                "value": "[[parameters('profileName')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', 'E0CC0DB1153DA5E2CCE75FC2900A0439')]",
            "parameters": {
              "eventHubName": {
                "value": "[[parameters('eventHubName')]"
              },
              "eventHubRuleId": {
                "value": "[[parameters('eventHubRuleId')]"
              },
              "azureRegions": {
                "value": "[[parameters('azureRegions')]"
              },
              "metricsEnabled": {
                "value": "[[parameters('metricsEnabled')]"
              },
              "logsEnabled": {
                "value": "[[parameters('logsEnabled')]"
              },
              "profileName": {
                "value": "[[parameters('profileName')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', '7BA6741429811894D30B7F69560AE62D')]",
            "parameters": {
              "eventHubName": {
                "value": "[[parameters('eventHubName')]"
              },
              "eventHubRuleId": {
                "value": "[[parameters('eventHubRuleId')]"
              },
              "azureRegions": {
                "value": "[[parameters('azureRegions')]"
              },
              "metricsEnabled": {
                "value": "[[parameters('metricsEnabled')]"
              },
              "logsEnabled": {
                "value": "[[parameters('logsEnabled')]"
              },
              "profileName": {
                "value": "[[parameters('profileName')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', '4A4326E787B2301C880908962F6BE4A2')]",
            "parameters": {
              "eventHubName": {
                "value": "[[parameters('eventHubName')]"
              },
              "eventHubRuleId": {
                "value": "[[parameters('eventHubRuleId')]"
              },
              "azureRegions": {
                "value": "[[parameters('azureRegions')]"
              },
              "metricsEnabled": {
                "value": "[[parameters('metricsEnabled')]"
              },
              "logsEnabled": {
                "value": "[[parameters('logsEnabled')]"
              },
              "profileName": {
                "value": "[[parameters('profileName')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', '646F62950D2FC86CB224C9DE9C22B3E8')]",
            "parameters": {
              "eventHubName": {
                "value": "[[parameters('eventHubName')]"
              },
              "eventHubRuleId": {
                "value": "[[parameters('eventHubRuleId')]"
              },
              "azureRegions": {
                "value": "[[parameters('azureRegions')]"
              },
              "metricsEnabled": {
                "value": "[[parameters('metricsEnabled')]"
              },
              "logsEnabled": {
                "value": "[[parameters('logsEnabled')]"
              },
              "profileName": {
                "value": "[[parameters('profileName')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', 'EAF8CE5F106CB4EC81537E76A11B3C31')]",
            "parameters": {
              "eventHubName": {
                "value": "[[parameters('eventHubName')]"
              },
              "eventHubRuleId": {
                "value": "[[parameters('eventHubRuleId')]"
              },
              "azureRegions": {
                "value": "[[parameters('azureRegions')]"
              },
              "metricsEnabled": {
                "value": "[[parameters('metricsEnabled')]"
              },
              "logsEnabled": {
                "value": "[[parameters('logsEnabled')]"
              },
              "profileName": {
                "value": "[[parameters('profileName')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', '5965D075FE067794EE545CBF4136CDA8')]",
            "parameters": {
              "eventHubName": {
                "value": "[[parameters('eventHubName')]"
              },
              "eventHubRuleId": {
                "value": "[[parameters('eventHubRuleId')]"
              },
              "azureRegions": {
                "value": "[[parameters('azureRegions')]"
              },
              "metricsEnabled": {
                "value": "[[parameters('metricsEnabled')]"
              },
              "logsEnabled": {
                "value": "[[parameters('logsEnabled')]"
              },
              "profileName": {
                "value": "[[parameters('profileName')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', 'F89D4C3236F9777A19780ACDB5609E63')]",
            "parameters": {
              "eventHubName": {
                "value": "[[parameters('eventHubName')]"
              },
              "eventHubRuleId": {
                "value": "[[parameters('eventHubRuleId')]"
              },
              "azureRegions": {
                "value": "[[parameters('azureRegions')]"
              },
              "metricsEnabled": {
                "value": "[[parameters('metricsEnabled')]"
              },
              "logsEnabled": {
                "value": "[[parameters('logsEnabled')]"
              },
              "profileName": {
                "value": "[[parameters('profileName')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', 'A3128A03900A369FFB43922CE083A611')]",
            "parameters": {
              "eventHubName": {
                "value": "[[parameters('eventHubName')]"
              },
              "eventHubRuleId": {
                "value": "[[parameters('eventHubRuleId')]"
              },
              "azureRegions": {
                "value": "[[parameters('azureRegions')]"
              },
              "metricsEnabled": {
                "value": "[[parameters('metricsEnabled')]"
              },
              "logsEnabled": {
                "value": "[[parameters('logsEnabled')]"
              },
              "profileName": {
                "value": "[[parameters('profileName')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', 'EF143C90CB8B0B640E21F94087B83FE7')]",
            "parameters": {
              "eventHubName": {
                "value": "[[parameters('eventHubName')]"
              },
              "eventHubRuleId": {
                "value": "[[parameters('eventHubRuleId')]"
              },
              "azureRegions": {
                "value": "[[parameters('azureRegions')]"
              },
              "metricsEnabled": {
                "value": "[[parameters('metricsEnabled')]"
              },
              "logsEnabled": {
                "value": "[[parameters('logsEnabled')]"
              },
              "profileName": {
                "value": "[[parameters('profileName')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', 'E080480106E18A3623B6726D45430AA0')]",
            "parameters": {
              "eventHubName": {
                "value": "[[parameters('eventHubName')]"
              },
              "eventHubRuleId": {
                "value": "[[parameters('eventHubRuleId')]"
              },
              "azureRegions": {
                "value": "[[parameters('azureRegions')]"
              },
              "metricsEnabled": {
                "value": "[[parameters('metricsEnabled')]"
              },
              "logsEnabled": {
                "value": "[[parameters('logsEnabled')]"
              },
              "profileName": {
                "value": "[[parameters('profileName')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', '2D10CC0C81FF15C71FABF5E5E6744F23')]",
            "parameters": {
              "eventHubName": {
                "value": "[[parameters('eventHubName')]"
              },
              "eventHubRuleId": {
                "value": "[[parameters('eventHubRuleId')]"
              },
              "azureRegions": {
                "value": "[[parameters('azureRegions')]"
              },
              "metricsEnabled": {
                "value": "[[parameters('metricsEnabled')]"
              },
              "logsEnabled": {
                "value": "[[parameters('logsEnabled')]"
              },
              "profileName": {
                "value": "[[parameters('profileName')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', '359DED89E3ABEED5E2C8D7EB9B5204E4')]",
            "parameters": {
              "eventHubName": {
                "value": "[[parameters('eventHubName')]"
              },
              "eventHubRuleId": {
                "value": "[[parameters('eventHubRuleId')]"
              },
              "azureRegions": {
                "value": "[[parameters('azureRegions')]"
              },
              "metricsEnabled": {
                "value": "[[parameters('metricsEnabled')]"
              },
              "logsEnabled": {
                "value": "[[parameters('logsEnabled')]"
              },
              "profileName": {
                "value": "[[parameters('profileName')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', 'F3277E2FB064E33A0135173E8D3BEEBF')]",
            "parameters": {
              "eventHubName": {
                "value": "[[parameters('eventHubName')]"
              },
              "eventHubRuleId": {
                "value": "[[parameters('eventHubRuleId')]"
              },
              "azureRegions": {
                "value": "[[parameters('azureRegions')]"
              },
              "metricsEnabled": {
                "value": "[[parameters('metricsEnabled')]"
              },
              "logsEnabled": {
                "value": "[[parameters('logsEnabled')]"
              },
              "profileName": {
                "value": "[[parameters('profileName')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', '93DFDF408A9A1AB7F070C9C0DB4C9A22')]",
            "parameters": {
              "eventHubName": {
                "value": "[[parameters('eventHubName')]"
              },
              "eventHubRuleId": {
                "value": "[[parameters('eventHubRuleId')]"
              },
              "azureRegions": {
                "value": "[[parameters('azureRegions')]"
              },
              "metricsEnabled": {
                "value": "[[parameters('metricsEnabled')]"
              },
              "logsEnabled": {
                "value": "[[parameters('logsEnabled')]"
              },
              "profileName": {
                "value": "[[parameters('profileName')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', '7FFAF04894D0815AE0923A5ABC1EF27C')]",
            "parameters": {
              "eventHubName": {
                "value": "[[parameters('eventHubName')]"
              },
              "eventHubRuleId": {
                "value": "[[parameters('eventHubRuleId')]"
              },
              "azureRegions": {
                "value": "[[parameters('azureRegions')]"
              },
              "metricsEnabled": {
                "value": "[[parameters('metricsEnabled')]"
              },
              "logsEnabled": {
                "value": "[[parameters('logsEnabled')]"
              },
              "profileName": {
                "value": "[[parameters('profileName')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', '893A4561A0AB741FCBAE5B13C5FF66DD')]",
            "parameters": {
              "eventHubName": {
                "value": "[[parameters('eventHubName')]"
              },
              "eventHubRuleId": {
                "value": "[[parameters('eventHubRuleId')]"
              },
              "azureRegions": {
                "value": "[[parameters('azureRegions')]"
              },
              "metricsEnabled": {
                "value": "[[parameters('metricsEnabled')]"
              },
              "logsEnabled": {
                "value": "[[parameters('logsEnabled')]"
              },
              "profileName": {
                "value": "[[parameters('profileName')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', 'B10BBE9EE398B5E5B597C31A01D5EEC0')]",
            "parameters": {
              "eventHubName": {
                "value": "[[parameters('eventHubName')]"
              },
              "eventHubRuleId": {
                "value": "[[parameters('eventHubRuleId')]"
              },
              "azureRegions": {
                "value": "[[parameters('azureRegions')]"
              },
              "metricsEnabled": {
                "value": "[[parameters('metricsEnabled')]"
              },
              "logsEnabled": {
                "value": "[[parameters('logsEnabled')]"
              },
              "profileName": {
                "value": "[[parameters('profileName')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', 'A510638DE8DA10CCE40FA86A9653337B')]",
            "parameters": {
              "eventHubName": {
                "value": "[[parameters('eventHubName')]"
              },
              "eventHubRuleId": {
                "value": "[[parameters('eventHubRuleId')]"
              },
              "azureRegions": {
                "value": "[[parameters('azureRegions')]"
              },
              "metricsEnabled": {
                "value": "[[parameters('metricsEnabled')]"
              },
              "logsEnabled": {
                "value": "[[parameters('logsEnabled')]"
              },
              "profileName": {
                "value": "[[parameters('profileName')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', 'C8586D4AF28A1CEC8539D9FCE8F59B71')]",
            "parameters": {
              "eventHubName": {
                "value": "[[parameters('eventHubName')]"
              },
              "eventHubRuleId": {
                "value": "[[parameters('eventHubRuleId')]"
              },
              "azureRegions": {
                "value": "[[parameters('azureRegions')]"
              },
              "metricsEnabled": {
                "value": "[[parameters('metricsEnabled')]"
              },
              "logsEnabled": {
                "value": "[[parameters('logsEnabled')]"
              },
              "profileName": {
                "value": "[[parameters('profileName')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', '8CC85643DA23187569B18BADF5F25355')]",
            "parameters": {
              "eventHubName": {
                "value": "[[parameters('eventHubName')]"
              },
              "eventHubRuleId": {
                "value": "[[parameters('eventHubRuleId')]"
              },
              "azureRegions": {
                "value": "[[parameters('azureRegions')]"
              },
              "metricsEnabled": {
                "value": "[[parameters('metricsEnabled')]"
              },
              "logsEnabled": {
                "value": "[[parameters('logsEnabled')]"
              },
              "profileName": {
                "value": "[[parameters('profileName')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', 'B0EB8FFBCA7D8ACB48DE43A3A1CCF869')]",
            "parameters": {
              "eventHubName": {
                "value": "[[parameters('eventHubName')]"
              },
              "eventHubRuleId": {
                "value": "[[parameters('eventHubRuleId')]"
              },
              "azureRegions": {
                "value": "[[parameters('azureRegions')]"
              },
              "metricsEnabled": {
                "value": "[[parameters('metricsEnabled')]"
              },
              "logsEnabled": {
                "value": "[[parameters('logsEnabled')]"
              },
              "profileName": {
                "value": "[[parameters('profileName')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', 'BD222F4EDF08BB1E2DC94C3444B8DD70')]",
            "parameters": {
              "eventHubName": {
                "value": "[[parameters('eventHubName')]"
              },
              "eventHubRuleId": {
                "value": "[[parameters('eventHubRuleId')]"
              },
              "azureRegions": {
                "value": "[[parameters('azureRegions')]"
              },
              "metricsEnabled": {
                "value": "[[parameters('metricsEnabled')]"
              },
              "logsEnabled": {
                "value": "[[parameters('logsEnabled')]"
              },
              "profileName": {
                "value": "[[parameters('profileName')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', '28621B0FCB1C1ED27A2C19F3124B146D')]",
            "parameters": {
              "eventHubName": {
                "value": "[[parameters('eventHubName')]"
              },
              "eventHubRuleId": {
                "value": "[[parameters('eventHubRuleId')]"
              },
              "azureRegions": {
                "value": "[[parameters('azureRegions')]"
              },
              "metricsEnabled": {
                "value": "[[parameters('metricsEnabled')]"
              },
              "logsEnabled": {
                "value": "[[parameters('logsEnabled')]"
              },
              "profileName": {
                "value": "[[parameters('profileName')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', 'EF0EA062ABF5A44EA8E656974074224B')]",
            "parameters": {
              "eventHubName": {
                "value": "[[parameters('eventHubName')]"
              },
              "eventHubRuleId": {
                "value": "[[parameters('eventHubRuleId')]"
              },
              "azureRegions": {
                "value": "[[parameters('azureRegions')]"
              },
              "metricsEnabled": {
                "value": "[[parameters('metricsEnabled')]"
              },
              "logsEnabled": {
                "value": "[[parameters('logsEnabled')]"
              },
              "profileName": {
                "value": "[[parameters('profileName')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', '2033C71E5C2F08B42EC2753CC375B4DF')]",
            "parameters": {
              "eventHubName": {
                "value": "[[parameters('eventHubName')]"
              },
              "eventHubRuleId": {
                "value": "[[parameters('eventHubRuleId')]"
              },
              "azureRegions": {
                "value": "[[parameters('azureRegions')]"
              },
              "metricsEnabled": {
                "value": "[[parameters('metricsEnabled')]"
              },
              "logsEnabled": {
                "value": "[[parameters('logsEnabled')]"
              },
              "profileName": {
                "value": "[[parameters('profileName')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', '1B2DBFB97AAC45EBC9C188DAAA0C7917')]",
            "parameters": {
              "eventHubName": {
                "value": "[[parameters('eventHubName')]"
              },
              "eventHubRuleId": {
                "value": "[[parameters('eventHubRuleId')]"
              },
              "azureRegions": {
                "value": "[[parameters('azureRegions')]"
              },
              "metricsEnabled": {
                "value": "[[parameters('metricsEnabled')]"
              },
              "logsEnabled": {
                "value": "[[parameters('logsEnabled')]"
              },
              "profileName": {
                "value": "[[parameters('profileName')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', '2B20F5754CE54A67C45B000601B79FF5')]",
            "parameters": {
              "eventHubName": {
                "value": "[[parameters('eventHubName')]"
              },
              "eventHubRuleId": {
                "value": "[[parameters('eventHubRuleId')]"
              },
              "azureRegions": {
                "value": "[[parameters('azureRegions')]"
              },
              "metricsEnabled": {
                "value": "[[parameters('metricsEnabled')]"
              },
              "logsEnabled": {
                "value": "[[parameters('logsEnabled')]"
              },
              "profileName": {
                "value": "[[parameters('profileName')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', 'DBFE912FCEDF63817A74AACEEC8470E9')]",
            "parameters": {
              "eventHubName": {
                "value": "[[parameters('eventHubName')]"
              },
              "eventHubRuleId": {
                "value": "[[parameters('eventHubRuleId')]"
              },
              "azureRegions": {
                "value": "[[parameters('azureRegions')]"
              },
              "metricsEnabled": {
                "value": "[[parameters('metricsEnabled')]"
              },
              "logsEnabled": {
                "value": "[[parameters('logsEnabled')]"
              },
              "profileName": {
                "value": "[[parameters('profileName')]"
              }
            }
          },
          {
            "policyDefinitionId": "[resourceId('Microsoft.Authorization/policyDefinitions/', '584687C59B443BB2864F400DAC30FA3E')]",
            "parameters": {
              "eventHubName": {
                "value": "[[parameters('eventHubName')]"
              },
              "eventHubRuleId": {
                "value": "[[parameters('eventHubRuleId')]"
              },
              "azureRegions": {
                "value": "[[parameters('azureRegions')]"
              },
              "metricsEnabled": {
                "value": "[[parameters('metricsEnabled')]"
              },
              "logsEnabled": {
                "value": "[[parameters('logsEnabled')]"
              },
              "profileName": {
                "value": "[[parameters('profileName')]"
              }
            }
          }
        ]
      }
    }
  ]
}
